{"version":3,"file":"result.js","sources":["../result.ts"],"sourcesContent":["import _wrap from \"./wrap.ts\";\nexport const Result = function Result(init) {\n    if (!new.target) {\n        throw new TypeError(\"Class constructor Result cannot be invoked without 'new'\");\n    }\n    const ins = this;\n    if (init.ok) {\n        Object.defineProperties(ins, {\n            ok: { value: true, enumerable: true },\n            value: { value: init.value, enumerable: true },\n        });\n    }\n    else {\n        Object.defineProperties(ins, {\n            ok: { value: false, enumerable: true },\n            error: { value: init.error, enumerable: true },\n        });\n    }\n};\nResult.prototype.unwrap = function unwrap(onError = undefined) {\n    if (this.ok) {\n        return this.value;\n    }\n    else if (onError) {\n        return onError(this.error);\n    }\n    else {\n        throw this.error;\n    }\n};\nResult.prototype.optional = function optional() {\n    return this.ok ? this.value : undefined;\n};\nResult.try = function try_(fn, ...args) {\n    if (typeof fn === \"function\") {\n        try {\n            const res = fn.call(void 0, ...args);\n            if (typeof (res === null || res === void 0 ? void 0 : res.then) === \"function\") {\n                return Result.try(res);\n            }\n            else {\n                return res instanceof Result ? res : Ok(res);\n            }\n        }\n        catch (error) {\n            return Err(error);\n        }\n    }\n    else {\n        return Promise.resolve(fn)\n            .then(value => value instanceof Result ? value : Ok(value))\n            .catch(error => Err(error));\n    }\n};\nResult.wrap = function wrap(fn = undefined) {\n    if (typeof fn === \"function\") {\n        return _wrap(fn, function (fn, ...args) {\n            try {\n                const res = fn.call(this, ...args);\n                if (typeof (res === null || res === void 0 ? void 0 : res.then) === \"function\") {\n                    return Promise.resolve(res)\n                        .then(value => value instanceof Result ? value : Ok(value))\n                        .catch(error => Err(error));\n                }\n                else {\n                    return res instanceof Result ? res : Ok(res);\n                }\n            }\n            catch (error) {\n                return Err(error);\n            }\n        });\n    }\n    else { // as a decorator\n        return (...args) => {\n            if (typeof args[1] === \"object\") { // new ES decorator since TypeScript 5.0\n                const [fn] = args;\n                return Result.wrap(fn);\n            }\n            else {\n                const [_ins, _prop, desc] = args;\n                desc.value = Result.wrap(desc.value);\n                return;\n            }\n        };\n    }\n};\n/**\n * Constructs a successful result with the given value.\n */\nexport const Ok = (value) => new Result({ ok: true, value });\n/**\n * Constructs a failed result with the given error.\n */\nexport const Err = (error) => new Result({ ok: false, error });\n/**\n * A alias for {@link Result.try}.\n *\n * @example\n * ```ts\n * import { try_ } from \"@ayonli/jsext/result\";\n *\n * function divide(a: number, b: number): number {\n *     if (b === 0) {\n *         throw new RangeError(\"division by zero\");\n *     }\n *\n *     return a / b;\n * }\n *\n * const result = try_<number, RangeError>(() => divide(10, 0));\n * if (result.ok) {\n *     console.log(\"Result:\", result.value);\n * } else {\n *     console.error(\"Error:\", result.error.message);\n * }\n * ```\n */\nexport const try_ = Result.try;\n//# sourceMappingURL=result.js.map"],"names":["wrap","_wrap"],"mappings":"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"}