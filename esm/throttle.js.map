{"version":3,"file":"throttle.js","sources":["../throttle.ts"],"sourcesContent":["const throttleCaches = new Map();\nexport default function throttle(handler, options) {\n    const key = typeof options === \"number\" ? null : options.for;\n    const duration = typeof options === \"number\" ? options : options.duration;\n    const handleCall = function (cache, ...args) {\n        var _a;\n        if (cache.result && Date.now() < ((_a = cache.expires) !== null && _a !== void 0 ? _a : 0)) {\n            if (cache.result.error) {\n                throw cache.result.error;\n            }\n            else {\n                return cache.result.value;\n            }\n        }\n        try {\n            const returns = handler.call(this, ...args);\n            cache.result = { value: returns };\n            cache.expires = Date.now() + duration;\n            return returns;\n        }\n        catch (error) {\n            cache.result = { error };\n            cache.expires = Date.now() + duration;\n            throw error;\n        }\n    };\n    if (!key) {\n        const cache = { for: null };\n        return function (...args) {\n            return handleCall.call(this, cache, ...args);\n        };\n    }\n    else {\n        let cache = throttleCaches.get(key);\n        if (!cache) {\n            cache = { for: key };\n            throttleCaches.set(key, cache);\n        }\n        return function (...args) {\n            return handleCall.call(this, cache, ...args);\n        };\n    }\n}\n//# sourceMappingURL=throttle.js.map"],"names":[],"mappings":"AAAA,MAAM,cAAc,GAAG,IAAI,GAAG,EAAE,CAAC;AAClB,SAAS,QAAQ,CAAC,OAAO,EAAE,OAAO,EAAE;AACnD,IAAI,MAAM,GAAG,GAAG,OAAO,OAAO,KAAK,QAAQ,GAAG,IAAI,GAAG,OAAO,CAAC,GAAG,CAAC;AACjE,IAAI,MAAM,QAAQ,GAAG,OAAO,OAAO,KAAK,QAAQ,GAAG,OAAO,GAAG,OAAO,CAAC,QAAQ,CAAC;AAC9E,IAAI,MAAM,UAAU,GAAG,UAAU,KAAK,EAAE,GAAG,IAAI,EAAE;AACjD,QAAQ,IAAI,EAAE,CAAC;AACf,QAAQ,IAAI,KAAK,CAAC,MAAM,IAAI,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,EAAE,GAAG,KAAK,CAAC,OAAO,MAAM,IAAI,IAAI,EAAE,KAAK,KAAK,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,EAAE;AACpG,YAAY,IAAI,KAAK,CAAC,MAAM,CAAC,KAAK,EAAE;AACpC,gBAAgB,MAAM,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC;AACzC,aAAa;AACb,iBAAiB;AACjB,gBAAgB,OAAO,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC;AAC1C,aAAa;AACb,SAAS;AACT,QAAQ,IAAI;AACZ,YAAY,MAAM,OAAO,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,IAAI,CAAC,CAAC;AACxD,YAAY,KAAK,CAAC,MAAM,GAAG,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC;AAC9C,YAAY,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,QAAQ,CAAC;AAClD,YAAY,OAAO,OAAO,CAAC;AAC3B,SAAS;AACT,QAAQ,OAAO,KAAK,EAAE;AACtB,YAAY,KAAK,CAAC,MAAM,GAAG,EAAE,KAAK,EAAE,CAAC;AACrC,YAAY,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,QAAQ,CAAC;AAClD,YAAY,MAAM,KAAK,CAAC;AACxB,SAAS;AACT,KAAK,CAAC;AACN,IAAI,IAAI,CAAC,GAAG,EAAE;AACd,QAAQ,MAAM,KAAK,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC;AACpC,QAAQ,OAAO,UAAU,GAAG,IAAI,EAAE;AAClC,YAAY,OAAO,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,GAAG,IAAI,CAAC,CAAC;AACzD,SAAS,CAAC;AACV,KAAK;AACL,SAAS;AACT,QAAQ,IAAI,KAAK,GAAG,cAAc,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AAC5C,QAAQ,IAAI,CAAC,KAAK,EAAE;AACpB,YAAY,KAAK,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;AACjC,YAAY,cAAc,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;AAC3C,SAAS;AACT,QAAQ,OAAO,UAAU,GAAG,IAAI,EAAE;AAClC,YAAY,OAAO,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,GAAG,IAAI,CAAC,CAAC;AACzD,SAAS,CAAC;AACV,KAAK;AACL;;;;"}