{"version":3,"file":"net.js","sources":["../../workerd/net.ts"],"sourcesContent":["import { connect as _connect } from \"cloudflare:sockets\";\nimport { throwUnsupportedRuntimeError } from \"../error.ts\";\nimport { TcpSocketStream, } from \"../net/types.ts\";\nimport { getInternetIp } from \"../net/util.ts\";\nexport { getInternetIp };\nexport async function getMyIp() {\n    try {\n        return await getInternetIp();\n    }\n    catch (_a) {\n        throwUnsupportedRuntimeError();\n    }\n}\nexport async function randomPort(prefer = undefined, hostname = undefined) {\n    void prefer, hostname;\n    throwUnsupportedRuntimeError();\n}\nexport async function connect(options) {\n    if (\"path\" in options) {\n        throw new NotSupportedError(\"Unix domain socket is not supported in this runtime.\");\n    }\n    else if (options.transport === \"udp\") {\n        throw new NotSupportedError(\"UDP socket is not supported in this runtime.\");\n    }\n    const { tls = false, ..._options } = options;\n    const impl = _connect(_options, {\n        secureTransport: tls ? \"on\" : \"off\",\n        allowHalfOpen: false,\n    });\n    const info = await impl.opened;\n    const localAddr = info.localAddress\n        ? new URL(\"http://\" + info.localAddress)\n        : null;\n    const remoteAddr = info.remoteAddress\n        ? new URL(\"http://\" + info.remoteAddress)\n        : null;\n    return new TcpSocketStream({\n        localAddress: localAddr ? {\n            hostname: localAddr.hostname,\n            port: localAddr.port ? Number(localAddr.port) : 0,\n        } : {\n            hostname: options.hostname,\n            port: options.port,\n        },\n        remoteAddress: remoteAddr ? {\n            hostname: remoteAddr.hostname,\n            port: remoteAddr.port ? Number(remoteAddr.port) : 0,\n        } : {\n            hostname: options.hostname,\n            port: options.port,\n        },\n        readable: impl.readable,\n        writable: impl.writable,\n        closed: impl.closed,\n        close: () => void impl.close().catch(() => void 0),\n        ref: () => void 0,\n        unref: () => void 0,\n        setKeepAlive: (keepAlive = undefined) => void keepAlive,\n        setNoDelay: (noDelay = undefined) => void noDelay,\n    });\n}\nexport async function udpSocket(options) {\n    void options;\n    throwUnsupportedRuntimeError();\n}\n//# sourceMappingURL=net.js.map"],"names":["_connect"],"mappings":";;;;;AAKO,eAAe,OAAO,GAAG;AAChC,IAAI,IAAI;AACR,QAAQ,OAAO,MAAM,aAAa,EAAE,CAAC;AACrC,KAAK;AACL,IAAI,OAAO,EAAE,EAAE;AACf,QAAQ,4BAA4B,EAAE,CAAC;AACvC,KAAK;AACL,CAAC;AACM,eAAe,UAAU,CAAC,MAAM,GAAG,SAAS,EAAE,QAAQ,GAAG,SAAS,EAAE;AAE3E,IAAI,4BAA4B,EAAE,CAAC;AACnC,CAAC;AACM,eAAe,OAAO,CAAC,OAAO,EAAE;AACvC,IAAI,IAAI,MAAM,IAAI,OAAO,EAAE;AAC3B,QAAQ,MAAM,IAAI,iBAAiB,CAAC,sDAAsD,CAAC,CAAC;AAC5F,KAAK;AACL,SAAS,IAAI,OAAO,CAAC,SAAS,KAAK,KAAK,EAAE;AAC1C,QAAQ,MAAM,IAAI,iBAAiB,CAAC,8CAA8C,CAAC,CAAC;AACpF,KAAK;AACL,IAAI,MAAM,EAAE,GAAG,GAAG,KAAK,EAAE,GAAG,QAAQ,EAAE,GAAG,OAAO,CAAC;AACjD,IAAI,MAAM,IAAI,GAAGA,SAAQ,CAAC,QAAQ,EAAE;AACpC,QAAQ,eAAe,EAAE,GAAG,GAAG,IAAI,GAAG,KAAK;AAC3C,QAAQ,aAAa,EAAE,KAAK;AAC5B,KAAK,CAAC,CAAC;AACP,IAAI,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC;AACnC,IAAI,MAAM,SAAS,GAAG,IAAI,CAAC,YAAY;AACvC,UAAU,IAAI,GAAG,CAAC,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC;AAChD,UAAU,IAAI,CAAC;AACf,IAAI,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa;AACzC,UAAU,IAAI,GAAG,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC;AACjD,UAAU,IAAI,CAAC;AACf,IAAI,OAAO,IAAI,eAAe,CAAC;AAC/B,QAAQ,YAAY,EAAE,SAAS,GAAG;AAClC,YAAY,QAAQ,EAAE,SAAS,CAAC,QAAQ;AACxC,YAAY,IAAI,EAAE,SAAS,CAAC,IAAI,GAAG,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC;AAC7D,SAAS,GAAG;AACZ,YAAY,QAAQ,EAAE,OAAO,CAAC,QAAQ;AACtC,YAAY,IAAI,EAAE,OAAO,CAAC,IAAI;AAC9B,SAAS;AACT,QAAQ,aAAa,EAAE,UAAU,GAAG;AACpC,YAAY,QAAQ,EAAE,UAAU,CAAC,QAAQ;AACzC,YAAY,IAAI,EAAE,UAAU,CAAC,IAAI,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC;AAC/D,SAAS,GAAG;AACZ,YAAY,QAAQ,EAAE,OAAO,CAAC,QAAQ;AACtC,YAAY,IAAI,EAAE,OAAO,CAAC,IAAI;AAC9B,SAAS;AACT,QAAQ,QAAQ,EAAE,IAAI,CAAC,QAAQ;AAC/B,QAAQ,QAAQ,EAAE,IAAI,CAAC,QAAQ;AAC/B,QAAQ,MAAM,EAAE,IAAI,CAAC,MAAM;AAC3B,QAAQ,KAAK,EAAE,MAAM,KAAK,IAAI,CAAC,KAAK,EAAE,CAAC,KAAK,CAAC,MAAM,KAAK,CAAC,CAAC;AAC1D,QAAQ,GAAG,EAAE,MAAM,KAAK,CAAC;AACzB,QAAQ,KAAK,EAAE,MAAM,KAAK,CAAC;AAC3B,QAAQ,YAAY,EAAE,CAAC,SAAS,GAAG,SAAS,KAAK,KAAK,SAAS;AAC/D,QAAQ,UAAU,EAAE,CAAC,OAAO,GAAG,SAAS,KAAK,KAAK,OAAO;AACzD,KAAK,CAAC,CAAC;AACP,CAAC;AACM,eAAe,SAAS,CAAC,OAAO,EAAE;AAEzC,IAAI,4BAA4B,EAAE,CAAC;AACnC;;;;"}