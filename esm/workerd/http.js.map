{"version":3,"file":"http.js","sources":["../../workerd/http.ts"],"sourcesContent":["import bytes from \"../bytes.ts\";\nimport { sha256 } from \"./hash.ts\";\nimport { Server } from \"../http/server.ts\";\nimport { WebSocketServer } from \"../ws.ts\";\nexport * from \"../http/util.ts\";\nexport async function etag(data) {\n    var _a;\n    if (typeof data === \"string\" || data instanceof Uint8Array) {\n        if (!data.length) {\n            // a short circuit for zero length entities\n            return `0-47DEQpj8HBSa+/TImW+5JCeuQeR`;\n        }\n        if (typeof data === \"string\") {\n            data = bytes(data);\n        }\n        const hash = await sha256(data, \"base64\");\n        return `${data.length.toString(16)}-${hash.slice(0, 27)}`;\n    }\n    const mtime = (_a = data.mtime) !== null && _a !== void 0 ? _a : new Date();\n    const hash = await sha256(mtime.toISOString(), \"base64\");\n    return `${data.size.toString(16)}-${hash.slice(0, 27)}`;\n}\nexport async function randomPort(prefer = undefined) {\n    void prefer;\n    throw new Error(\"Unsupported runtime\");\n}\nexport function withWeb(listener) {\n    void listener;\n    throw new Error(\"Unsupported runtime\");\n}\nexport function serve(options) {\n    return new Server(async () => {\n        const ws = new WebSocketServer(options.ws);\n        return {\n            http: null,\n            ws,\n            hostname: \"\",\n            port: 0,\n            fetch: options.fetch,\n        };\n    });\n}\nexport async function serveStatic(req, options = {}) {\n    void req, options;\n    throw new Error(\"Unsupported runtime\");\n}\n//# sourceMappingURL=http.js.map"],"names":[],"mappings":";;;;;;AAKO,eAAe,IAAI,CAAC,IAAI,EAAE;AACjC,IAAI,IAAI,EAAE,CAAC;AACX,IAAI,IAAI,OAAO,IAAI,KAAK,QAAQ,IAAI,IAAI,YAAY,UAAU,EAAE;AAChE,QAAQ,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;AAC1B;AACA,YAAY,OAAO,CAAC,6BAA6B,CAAC,CAAC;AACnD,SAAS;AACT,QAAQ,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;AACtC,YAAY,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,CAAC;AAC/B,SAAS;AACT,QAAQ,MAAM,IAAI,GAAG,MAAM,MAAM,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;AAClD,QAAQ,OAAO,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;AAClE,KAAK;AACL,IAAI,MAAM,KAAK,GAAG,CAAC,EAAE,GAAG,IAAI,CAAC,KAAK,MAAM,IAAI,IAAI,EAAE,KAAK,KAAK,CAAC,GAAG,EAAE,GAAG,IAAI,IAAI,EAAE,CAAC;AAChF,IAAI,MAAM,IAAI,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC,WAAW,EAAE,EAAE,QAAQ,CAAC,CAAC;AAC7D,IAAI,OAAO,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;AAC5D,CAAC;AACM,eAAe,UAAU,CAAC,MAAM,GAAG,SAAS,EAAE;AAErD,IAAI,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAC;AAC3C,CAAC;AACM,SAAS,OAAO,CAAC,QAAQ,EAAE;AAElC,IAAI,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAC;AAC3C,CAAC;AACM,SAAS,KAAK,CAAC,OAAO,EAAE;AAC/B,IAAI,OAAO,IAAI,MAAM,CAAC,YAAY;AAClC,QAAQ,MAAM,EAAE,GAAG,IAAI,eAAe,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;AACnD,QAAQ,OAAO;AACf,YAAY,IAAI,EAAE,IAAI;AACtB,YAAY,EAAE;AACd,YAAY,QAAQ,EAAE,EAAE;AACxB,YAAY,IAAI,EAAE,CAAC;AACnB,YAAY,KAAK,EAAE,OAAO,CAAC,KAAK;AAChC,SAAS,CAAC;AACV,KAAK,CAAC,CAAC;AACP,CAAC;AACM,eAAe,WAAW,CAAC,GAAG,EAAE,OAAO,GAAG,EAAE,EAAE;AAErD,IAAI,MAAM,IAAI,KAAK,CAAC,qBAAqB,CAAC,CAAC;AAC3C;;;;"}