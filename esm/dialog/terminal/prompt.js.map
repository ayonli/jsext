{"version":3,"file":"prompt.js","sources":["../../../dialog/terminal/prompt.ts"],"sourcesContent":["import { questionInDeno, questionInNode } from \"./index.ts\";\nimport { escape, platform, run } from \"./util.ts\";\nfunction createAppleScript(message, defaultValue = \"\", password = false) {\n    return \"tell application (path to frontmost application as text)\\n\" +\n        `  set response to display dialog \"${escape(message)}\" with title \"Prompt\"`\n        + ` default answer \"${escape(defaultValue)}\"`\n        + `${password ? \" hidden answer true\" : \"\"}\\n` +\n        \"  return text returned of response\\n\" +\n        \"end\";\n}\nfunction createPowerShellScript(message, defaultValue = \"\", password = false) {\n    void password; // password is not supported in PowerShell\n    return \"Add-Type -AssemblyName Microsoft.VisualBasic;\"\n        + `[Microsoft.VisualBasic.Interaction]::InputBox(\"${escape(message)}\", \"Prompt\", \"${escape(defaultValue)}\");`;\n}\nexport default async function promptInTerminal(message, options = {}) {\n    var _a;\n    if ((options === null || options === void 0 ? void 0 : options.gui) && platform() === \"darwin\") {\n        const { code, stdout, stderr } = await run(\"osascript\", [\n            \"-e\",\n            createAppleScript(message, options.defaultValue, options.type === \"password\")\n        ]);\n        if (code) {\n            if (stderr.includes(\"User canceled\")) {\n                return null;\n            }\n            else {\n                throw new Error(stderr);\n            }\n        }\n        else {\n            return stdout.trim();\n        }\n    }\n    else if ((options === null || options === void 0 ? void 0 : options.gui) && platform() === \"linux\") {\n        const args = [\n            \"--entry\",\n            \"--title\", \"Prompt\",\n            \"--width\", \"450\",\n            \"--text\", message,\n            \"--entry-text\",\n            (_a = options.defaultValue) !== null && _a !== void 0 ? _a : \"\",\n        ];\n        if (options.type === \"password\") {\n            args.push(\"--hide-text\");\n        }\n        const { code, stdout, stderr } = await run(\"zenity\", args);\n        if (!code) {\n            return stdout.trim();\n        }\n        else if (code === 1) {\n            return null;\n        }\n        else {\n            throw new Error(stderr);\n        }\n    }\n    else if ((options === null || options === void 0 ? void 0 : options.gui) && platform() === \"windows\") {\n        const { code, stdout, stderr } = await run(\"powershell\", [\n            \"-Command\",\n            createPowerShellScript(message, options.defaultValue, options.type === \"password\")\n        ]);\n        if (code) {\n            throw new Error(stderr);\n        }\n        else {\n            return stdout.trim();\n        }\n    }\n    else if (typeof Deno === \"object\") {\n        return await questionInDeno(message + \" \", options);\n    }\n    else {\n        return await questionInNode(message + \" \", options);\n    }\n}\n//# sourceMappingURL=prompt.js.map"],"names":[],"mappings":"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"}