{"version":3,"file":"linux.js","sources":["../../../../dialog/terminal/file/linux.ts"],"sourcesContent":["import { lines } from \"../../../string.ts\";\nimport { run } from \"../util.ts\";\nimport { UTIMap } from \"../constants.ts\";\nimport { extname } from \"../../../path.ts\";\nfunction htmlAcceptToFileFilter(accept) {\n    const list = Object.values(UTIMap);\n    return accept.split(/\\s*,\\s*/).map(type => {\n        const _type = type.toLowerCase();\n        for (const types of list) {\n            if (types.includes(_type)) {\n                return types.filter(t => t.startsWith(\".\")).map(t => `*${t}`).join(\" \");\n            }\n        }\n        return type;\n    }).join(\" \");\n}\nexport async function linuxPickFile(title = \"\", options = {}) {\n    const { type, save, defaultName } = options;\n    const args = [\n        \"--file-selection\",\n        \"--title\", title,\n    ];\n    if (type) {\n        args.push(\"--file-filter\", htmlAcceptToFileFilter(type));\n    }\n    if (save) {\n        args.push(\"--save\", \"--confirm-overwrite\");\n        if (defaultName) {\n            args.push(\"--filename\", defaultName);\n            if (!type) {\n                const ext = extname(defaultName);\n                ext && args.push(\"--file-filter\", htmlAcceptToFileFilter(ext));\n            }\n        }\n    }\n    const { code, stdout, stderr } = await run(\"zenity\", args);\n    if (!code) {\n        const path = stdout.trim();\n        return path || null;\n    }\n    else if (code === 1) {\n        return null;\n    }\n    else {\n        throw new Error(stderr.trim());\n    }\n}\nexport async function linuxPickFiles(title = \"\", type = \"\") {\n    const args = [\n        \"--file-selection\",\n        \"--title\", title,\n        \"--multiple\",\n        \"--separator\", \"\\n\",\n    ];\n    if (type) {\n        args.push(\"--file-filter\", htmlAcceptToFileFilter(type));\n    }\n    const { code, stdout, stderr } = await run(\"zenity\", args);\n    if (!code) {\n        const output = stdout.trim();\n        return output ? lines(stdout.trim()) : [];\n    }\n    else if (code === 1) {\n        return [];\n    }\n    else {\n        throw new Error(stderr.trim());\n    }\n}\nexport async function linuxPickFolder(title = \"\") {\n    const { code, stdout, stderr } = await run(\"zenity\", [\n        \"--file-selection\",\n        \"--title\", title,\n        \"--directory\",\n    ]);\n    if (!code) {\n        const dir = stdout.trim();\n        return dir || null;\n    }\n    else if (code === 1) {\n        return null;\n    }\n    else {\n        throw new Error(stderr.trim());\n    }\n}\n//# sourceMappingURL=linux.js.map"],"names":[],"mappings":"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"}