{"version":3,"file":"index.js","sources":["../../dialog/index.ts"],"sourcesContent":["/**\n * Asynchronous dialog functions for both browsers and Node.js.\n *\n * This includes `alert`, `confirm`, `prompt` and other non-standard dialogs.\n *\n * **NOTE:** Currently, this module doesn't work well in Deno since it doesn't\n * provide enough features for the `process.stdin` object.\n *\n * **NOTE:** This module is experimental and breaks the process in Node.js REPL\n * environment.\n * @experimental\n *\n * @module\n */\nimport Dialog from \"./components/Dialog.ts\";\nimport Text from \"./components/Text.ts\";\nimport Footer from \"./components/Footer.ts\";\nimport OkButton from \"./components/OkButton.ts\";\nimport CancelButton from \"./components/CancelButton.ts\";\nimport Input from \"./components/Input.ts\";\nimport progress from \"./progress.ts\";\nimport { listenForCancel, isNodeRepl, questionInRepl } from \"./util.ts\";\nexport { progress };\n/**\n * Displays a dialog with a message, and to wait until the user dismisses the\n * dialog.\n */\nexport async function alert(message) {\n    if (typeof Deno === \"object\") {\n        return Promise.resolve(globalThis.alert(message));\n    }\n    else if (typeof document === \"object\") {\n        return new Promise(resolve => {\n            document.body.appendChild(Dialog({\n                onCancel: () => resolve(),\n                onOk: () => resolve(),\n            }, Text(message), Footer(OkButton())));\n        });\n    }\n    else if (await isNodeRepl()) {\n        await questionInRepl(message + \" [Enter] \");\n        return;\n    }\n    else {\n        const { createInterface } = await import(\"readline/promises\");\n        const rl = createInterface({ input: process.stdin, output: process.stdout });\n        const { signal, promise, cleanup } = listenForCancel();\n        await Promise.race([\n            rl.question(message + \" [Enter] \", { signal }),\n            promise\n        ]);\n        cleanup();\n        rl.close();\n    }\n}\n/**\n * Displays a dialog with a message, and to wait until the user either confirms\n * or cancels the dialog.\n */\nexport async function confirm(message) {\n    if (typeof Deno === \"object\") {\n        return Promise.resolve(globalThis.confirm(message));\n    }\n    else if (typeof document === \"object\") {\n        return new Promise(resolve => {\n            document.body.appendChild(Dialog({\n                onCancel: () => resolve(false),\n                onOk: () => resolve(true),\n            }, Text(message), Footer(CancelButton(), OkButton())));\n        });\n    }\n    else if (await isNodeRepl()) {\n        const answer = await questionInRepl(message + \" [y/N] \");\n        const ok = answer === null || answer === void 0 ? void 0 : answer.toLowerCase().trim();\n        return ok === \"y\" || ok === \"yes\";\n    }\n    else {\n        const { createInterface } = await import(\"readline/promises\");\n        const rl = createInterface({ input: process.stdin, output: process.stdout });\n        const { signal, promise, cleanup } = listenForCancel();\n        const answer = await Promise.race([\n            rl.question(message + \" [y/N] \", { signal }),\n            promise,\n        ]);\n        const ok = answer === null || answer === void 0 ? void 0 : answer.toLowerCase().trim();\n        cleanup();\n        rl.close();\n        return ok === \"y\" || ok === \"yes\";\n    }\n}\n/**\n * Displays a dialog with a message prompting the user to input some text, and to\n * wait until the user either submits the text or cancels the dialog.\n */\nexport async function prompt(message, defaultValue = \"\") {\n    if (typeof Deno === \"object\") {\n        return Promise.resolve(globalThis.prompt(message, defaultValue));\n    }\n    else if (typeof document === \"object\") {\n        return new Promise(resolve => {\n            document.body.appendChild(Dialog({\n                onCancel: () => resolve(null),\n                onOk: (dialog) => {\n                    const input = dialog.querySelector(\"input\");\n                    resolve(input.value);\n                },\n            }, Text(message), Input(defaultValue), Footer(CancelButton(), OkButton())));\n        });\n    }\n    else if (await isNodeRepl()) {\n        return await questionInRepl(message + \" \", defaultValue);\n    }\n    else {\n        const { createInterface } = await import(\"readline/promises\");\n        const rl = createInterface({ input: process.stdin, output: process.stdout });\n        const { signal, promise, cleanup } = listenForCancel();\n        const job = rl.question(message + \" \", { signal });\n        if (defaultValue) {\n            rl.write(defaultValue);\n        }\n        const answer = await Promise.race([job, promise]);\n        cleanup();\n        rl.close();\n        return answer;\n    }\n}\n//# sourceMappingURL=index.js.map"],"names":[],"mappings":"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"}