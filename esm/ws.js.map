{"version":3,"file":"ws.js","sources":["../ws.ts"],"sourcesContent":["/**\n * This module provides a universal WebSocket server that works in Node.js, Deno,\n * Bun and Cloudflare Workers.\n * @example\n */\nvar _a;\nimport runtime from \"./runtime.ts\";\nconst _source = Symbol.for(\"source\");\nconst _url = Symbol.for(\"url\");\nconst _context = Symbol.for(\"context\");\nconst _listeners = Symbol.for(\"listeners\");\nconst _clients = Symbol.for(\"clients\");\n/**\n * The state of a WebSocket connection.\n */\nexport var ConnectionState;\n(function (ConnectionState) {\n    ConnectionState[ConnectionState[\"CONNECTING\"] = 0] = \"CONNECTING\";\n    ConnectionState[ConnectionState[\"OPEN\"] = 1] = \"OPEN\";\n    ConnectionState[ConnectionState[\"CLOSING\"] = 2] = \"CLOSING\";\n    ConnectionState[ConnectionState[\"CLOSED\"] = 3] = \"CLOSED\";\n})(ConnectionState || (ConnectionState = {}));\n/**\n * Represents a WebSocket connection on the server side.\n */\nexport class WebSocketConnection {\n    constructor(socket, options) {\n        this[_source] = socket;\n        this[_url] = options.url;\n        this[_context] = options.context;\n    }\n    /**\n     * The current state of the WebSocket connection.\n     */\n    get readyState() {\n        var _b;\n        return (_b = this[_source].readyState) !== null && _b !== void 0 ? _b : ConnectionState.OPEN;\n    }\n    /**\n     * The URL of the WebSocket connection.\n     */\n    get url() {\n        return this[_url];\n    }\n    /**\n     * The context data attached to the connection.\n     */\n    get context() {\n        return this[_context];\n    }\n    /**\n     * Sends data to the WebSocket client.\n     */\n    send(data) {\n        this[_source].send(data);\n    }\n    /**\n     * Closes the WebSocket connection.\n     */\n    close(code, reason) {\n        this[_source].close(code, reason);\n    }\n}\n/**\n * A universal WebSocket server that works in Node.js, Deno, Bun and Cloudflare\n * Workers.\n *\n * @example\n * ```ts\n * const wsServer = new WebSocketServer({\n *     message(ws, event) {\n *         ws.send(\"received: \" + event.data);\n *     },\n *     open(ws, event) {\n *         console.log(`WebSocket connection established.`);\n *     },\n *     close(ws, event) {\n *         console.log(\"WebSocket connection closed, reason: ${event.reason}, code: ${event.code}\");\n *     },\n *     error(ws, event) {\n *         console.error(\"WebSocket connection error:\", event);\n *     },\n * });\n *\n * // Node.js\n * const httpServer = http.createServer((req, res) => {});\n * httpServer.on(\"upgrade\", (req, socket, head) => {\n *     wsServer.upgrade(req, socket, head);\n * });\n * httpServer.listen(3000);\n *\n * // Deno\n * Deno.serve(req => {\n *     const { response } = wsServer.upgrade(req);\n *     return response;\n * });\n *\n * // Bun\n * Bun.serve({\n *     fetch(req, server) {\n *         const { ok, response } = wsServer.upgrade(req, server);\n *         if (ok) {\n *             return undefined;\n *         } else {\n *             return response;\n *         }\n *     },\n *     websocket: wsServer.bunListener,\n * });\n *\n * // Cloudflare Workers\n * export default {\n *     fetch(req) {\n *         const { response } = wsServer.upgrade(req);\n *         return response;\n *     },\n * };\n * ```\n */\nexport class WebSocketServer {\n    constructor(listeners, options) {\n        var _b;\n        this[_a] = new Map();\n        this[_listeners] = listeners;\n        this.idleTimeout = (options === null || options === void 0 ? void 0 : options.idleTimeout) || 30;\n        this.perMessageDeflate = (_b = options === null || options === void 0 ? void 0 : options.perMessageDeflate) !== null && _b !== void 0 ? _b : false;\n    }\n    upgrade(request, ...args) {\n        var _b;\n        if (\"httpVersion\" in request) {\n            throw new TypeError(\"Node.js support is not implemented\");\n        }\n        const upgradeHeader = request.headers.get(\"Upgrade\");\n        if (!upgradeHeader || upgradeHeader !== \"websocket\") {\n            return {\n                ok: false,\n                response: new Response(\"Expected Upgrade: websocket\", {\n                    status: 426,\n                }),\n            };\n        }\n        const listeners = this[_listeners];\n        const clients = this[_clients];\n        const { identity } = runtime();\n        if (identity === \"deno\") {\n            try {\n                const context = args[0];\n                const { socket, response } = Deno.upgradeWebSocket(request, {\n                    idleTimeout: this.idleTimeout,\n                });\n                const ws = new WebSocketConnection(socket, { url: socket.url, context });\n                clients.set(socket, ws);\n                socket.binaryType = \"arraybuffer\";\n                socket.onmessage = (_event) => {\n                    let event;\n                    if (typeof _event.data === \"string\") {\n                        event = new MessageEvent(\"message\", {\n                            data: _event.data,\n                            origin: _event.origin,\n                        });\n                    }\n                    else {\n                        event = new MessageEvent(\"message\", {\n                            data: new Uint8Array(_event.data),\n                            origin: _event.origin,\n                        });\n                    }\n                    listeners.message(ws, event);\n                };\n                socket.onopen = (event) => { var _b; return (_b = listeners.open) === null || _b === void 0 ? void 0 : _b.call(listeners, ws, event); };\n                socket.onerror = (event) => { var _b; return (_b = listeners.error) === null || _b === void 0 ? void 0 : _b.call(listeners, ws, event); };\n                socket.onclose = (event) => {\n                    var _b;\n                    (_b = listeners.close) === null || _b === void 0 ? void 0 : _b.call(listeners, ws, event);\n                    clients.delete(socket);\n                };\n                return { ok: true, response };\n            }\n            catch (err) {\n                const msg = err instanceof Error ? err.message : String(err);\n                return { ok: false, response: new Response(msg, { status: 426 }) };\n            }\n        }\n        else if (identity === \"cloudflare-worker\") {\n            const context = args[0];\n            // @ts-ignore\n            const [client, server] = Object.values(new WebSocketPair());\n            const ws = new WebSocketConnection(client, { url: request.url, context });\n            clients.set(client, ws);\n            server.accept();\n            server.addEventListener(\"message\", _event => {\n                let event;\n                if (typeof _event.data === \"string\") {\n                    event = new MessageEvent(\"message\", {\n                        data: _event.data,\n                        origin: _event.origin,\n                    });\n                    listeners.message(ws, event);\n                }\n                else if (_event.data instanceof ArrayBuffer) {\n                    event = new MessageEvent(\"message\", {\n                        data: new Uint8Array(_event.data),\n                        origin: _event.origin,\n                    });\n                    listeners.message(ws, event);\n                }\n                else {\n                    _event.data.arrayBuffer().then(buffer => {\n                        event = new MessageEvent(\"message\", {\n                            data: new Uint8Array(buffer),\n                            origin: _event.origin,\n                        });\n                        listeners.message(ws, event);\n                    }).catch(() => { });\n                }\n            });\n            server.addEventListener(\"error\", event => { var _b; return (_b = listeners.error) === null || _b === void 0 ? void 0 : _b.call(listeners, ws, event); });\n            server.addEventListener(\"close\", event => {\n                var _b;\n                (_b = listeners.close) === null || _b === void 0 ? void 0 : _b.call(listeners, ws, event);\n                clients.delete(client);\n            });\n            // Cloudflare Workers does not support the open event, we call it\n            // manually here.\n            (_b = listeners.open) === null || _b === void 0 ? void 0 : _b.call(listeners, ws, new Event(\"open\"));\n            return {\n                ok: true,\n                response: new Response(null, {\n                    status: 101,\n                    // @ts-ignore\n                    webSocket: client,\n                }),\n            };\n        }\n        else if (identity === \"bun\") {\n            const server = args[0];\n            const context = args[1];\n            const ok = server.upgrade(request, {\n                data: {\n                    url: request.url,\n                    context,\n                },\n            });\n            const response = new Response(ok ? null : \"Upgrade to WebSocket failed\", {\n                status: ok ? 101 : 426,\n            });\n            return { ok, response };\n        }\n        else {\n            throw new TypeError(\"Unsupported runtime\");\n        }\n    }\n    /**\n     * A WebSocket listener for `Bun.serve()`.\n     */\n    get bunListener() {\n        const listeners = this[_listeners];\n        const clients = this[_clients];\n        return {\n            idleTimeout: this.idleTimeout,\n            perMessageDeflate: this.perMessageDeflate,\n            message(_ws, message) {\n                const ws = clients.get(_ws);\n                ws && listeners.message(ws, message);\n            },\n            open(_ws) {\n                var _b;\n                const ws = new WebSocketConnection(_ws, _ws.data);\n                clients.set(_ws, ws);\n                (_b = listeners.open) === null || _b === void 0 ? void 0 : _b.call(listeners, ws, new Event(\"open\"));\n            },\n            error(_ws) {\n                var _b;\n                const ws = clients.get(_ws);\n                ws && ((_b = listeners.error) === null || _b === void 0 ? void 0 : _b.call(listeners, ws, new Event(\"error\")));\n            },\n            close(_ws, code, reason) {\n                var _b;\n                const ws = clients.get(_ws);\n                ws && ((_b = listeners.close) === null || _b === void 0 ? void 0 : _b.call(listeners, ws, new CloseEvent(\"close\", { code, reason })));\n                clients.delete(_ws);\n            },\n        };\n    }\n    get clients() {\n        return this[_clients].values();\n    }\n}\n_a = _clients;\n//# sourceMappingURL=ws.js.map"],"names":[],"mappings":"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"}