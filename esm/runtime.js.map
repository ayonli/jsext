{"version":3,"file":"runtime.js","sources":["../runtime.ts"],"sourcesContent":["/**\n * Utility functions to retrieve runtime information of the current program.\n * @module\n */\nimport { isBrowser, isBun, isDeno, isNode } from \"./env.ts\";\nexport const CommonRuntimes = [\n    \"node\",\n    \"deno\",\n    \"bun\",\n    \"chromium\",\n    \"firefox\",\n    \"safari\",\n    \"edge\",\n];\n/**\n * Returns the information of the runtime environment in which the program is\n * running.\n */\nexport default function runtime() {\n    var _a;\n    if (isDeno) {\n        return {\n            identity: \"deno\",\n            version: Deno.version.deno,\n            engine: \"V8\",\n            tsSupport: true,\n        };\n    }\n    else if (isBun) {\n        return {\n            identity: \"bun\",\n            version: Bun.version,\n            engine: \"JavaScriptCore\",\n            tsSupport: true,\n        };\n    }\n    else if (isNode) {\n        return {\n            identity: \"node\",\n            version: process.version.slice(1),\n            engine: \"V8\",\n            tsSupport: process.execArgv.some(arg => /\\b(tsx|ts-node|vite|swc-node|tsimp)\\b/.test(arg))\n                || /\\.tsx?$|\\bvite\\b/.test((_a = process.argv[1]) !== null && _a !== void 0 ? _a : \"\")\n        };\n    }\n    else if (isBrowser) {\n        const ua = navigator.userAgent.match(/(Firefox|Edg?e|Safari|Chrom(e|ium))\\/(\\d+(\\.\\d+)+)/g);\n        if (ua) {\n            const list = ua.map(part => {\n                const [name, version] = part.split(\"/\");\n                return { name, version };\n            });\n            const safari = list.find(({ name }) => name === \"Safari\");\n            const firefox = list.find(({ name }) => name === \"Firefox\");\n            const edge = list.find(({ name }) => name === \"Edge\" || name === \"Edg\");\n            const chrome = list.find(({ name }) => name === \"Chrome\" || name === \"Chromium\");\n            if (safari && !chrome && !firefox && !edge) {\n                return {\n                    identity: \"safari\",\n                    version: safari.version,\n                    engine: \"JavaScriptCore\",\n                    tsSupport: false,\n                };\n            }\n            else if (firefox && !chrome && !safari && !edge) {\n                return {\n                    identity: \"firefox\",\n                    version: firefox.version,\n                    engine: \"SpiderMonkey\",\n                    tsSupport: false,\n                };\n            }\n            else if (edge && !chrome && !safari && !firefox) {\n                return {\n                    identity: \"edge\",\n                    version: edge.version,\n                    engine: \"Chakra\",\n                    tsSupport: false,\n                };\n            }\n            else if (chrome) {\n                return {\n                    identity: \"chromium\",\n                    version: chrome.version,\n                    engine: \"V8\",\n                    tsSupport: false,\n                };\n            }\n        }\n    }\n    return { identity: \"others\", version: undefined, engine: \"others\", tsSupport: false };\n}\nexport const CommonPlatforms = [\n    \"android\",\n    \"darwin\",\n    \"freebsd\",\n    \"linux\",\n    \"windows\",\n];\n/**\n * Returns a string identifying the operating system platform in which the\n * program is running.\n */\nexport function platform() {\n    if (typeof Deno === \"object\") {\n        if (CommonPlatforms.includes(Deno.build.os)) {\n            return Deno.build.os;\n        }\n        else {\n            return \"others\";\n        }\n    }\n    else if (typeof process === \"object\" && typeof process.platform === \"string\") {\n        if (process.platform === \"win32\") {\n            return \"windows\";\n        }\n        else if (CommonPlatforms.includes(process.platform)) {\n            return process.platform;\n        }\n        else {\n            return \"others\";\n        }\n    }\n    else if (typeof navigator === \"object\" && typeof navigator.userAgent === \"string\") {\n        if (navigator.userAgent.includes(\"Android\")) {\n            return \"android\";\n        }\n        else if (navigator.userAgent.includes(\"Macintosh\")) {\n            return \"darwin\";\n        }\n        else if (navigator.userAgent.includes(\"Windows\")) {\n            return \"windows\";\n        }\n        else if (navigator.userAgent.includes(\"Linux\")) {\n            return \"linux\";\n        }\n        else {\n            return \"others\";\n        }\n    }\n    else {\n        return \"others\";\n    }\n}\n//# sourceMappingURL=runtime.js.map"],"names":[],"mappings":"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"}