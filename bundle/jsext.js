!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).jsext=t()}(this,(function(){"use strict";var e,t="undefined"!=typeof document?document.currentScript:null;function equals$4(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function includeSlice(e,t){if(e===t||!t.length)return!0;const r=e.length,n=t.length;if(n>r)return!1;for(let o=0;o<r;o++)if(e[o]===t[0]){let r=1;for(;r<n&&e[o+r]===t[r];)r++;if(r===n)return!0}return!1}function startsWith$3(e,t){if(e===t||!t.length)return!0;const r=e.length,n=t.length;if(n>r)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function endsWith$3(e,t){if(e===t||!t.length)return!0;const r=e.length,n=t.length,o=r-n;if(o<0)return!1;for(let r=0;r<n;r++)if(e[o+r]!==t[r])return!1;return!0}function split$3(e,t){const r=[],n=e.length;let o=0;for(let i=0;i<n;i++)e[i]===t&&(r.push(e.slice(o,i)),o=i+1);if(o<n)r.push(e.slice(o,n));else if(o===n){const t=e.constructor;"function"==typeof t.from?r.push(t.from([])):r.push(new t([]))}return r}function chunk$4(e,t){const r=e.length,n=Math.ceil(r/t),o=new Array(n);let i=0,s=0;for(;i<r;)o[s]=e.slice(i,i+t),i+=t,s++;return o}"function"!=typeof globalThis.Event&&(globalThis.Event=(e=class Event{constructor(t,r={}){this.type=t,this.eventInitDict=r,this.bubbles=!1,this.cancelable=!1,this.cancelBubble=!1,this.composed=!1,this.currentTarget=null,this.defaultPrevented=!1,this.eventPhase=e.NONE,this.isTrusted=!1,this.returnValue=!0,this.target=null,this.timeStamp=Date.now(),this.srcElement=null,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.CAPTURING_PHASE=1,this.NONE=0,void 0!==r.bubbles&&(this.bubbles=r.bubbles),void 0!==r.cancelable&&(this.cancelable=r.cancelable),void 0!==r.composed&&(this.composed=r.composed)}composedPath(){return[]}preventDefault(){this.cancelable&&(this.defaultPrevented=!0)}stopImmediatePropagation(){}stopPropagation(){this.cancelBubble=!0}initEvent(e,t=void 0,r=void 0){this.type=e,this.bubbles=null!=t&&t,this.cancelable=null!=r&&r}},e.AT_TARGET=2,e.BUBBLING_PHASE=3,e.CAPTURING_PHASE=1,e.NONE=0,e)),"function"!=typeof globalThis.EventTarget&&(globalThis.EventTarget=class EventTarget{constructor(){this.listeners={}}addEventListener(e,t,r={}){var n;e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,once:null!==(n=null==r?void 0:r.once)&&void 0!==n&&n})}removeEventListener(e,t){if(!(e in this.listeners))return;const r=this.listeners[e];for(let e=0,n=r.length;e<n;e++)if(r[e].callback===t)return void r.splice(e,1);0===r.length&&delete this.listeners[e]}dispatchEvent(e){if(!(e.type in this.listeners))return!0;Object.defineProperties(e,{currentTarget:{configurable:!0,value:this},target:{configurable:!0,value:this}});const t=this.listeners[e.type].slice();for(let r=0,n=t.length;r<n;r++){const n=t[r];try{n.callback.call(this,e)}catch(e){setTimeout((()=>{throw e}))}n.once&&this.removeEventListener(e.type,n.callback)}return!e.defaultPrevented}});const r=new TextEncoder;function asUint8Array(e){let t;return t="string"==typeof e?r.encode(e):e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e),t}function encodeHex(e){const t=asUint8Array(e);return"function"==typeof Buffer&&t instanceof Buffer?t.toString("hex"):t.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),"")}function decodeHex(e){const t=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=parseInt(e.slice(r,r+2),16);return t}const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function encodeBase64(e){const t=asUint8Array(e);if("function"==typeof Buffer&&t instanceof Buffer)return t.toString("base64");let r,o="";const i=t.length;for(r=2;r<i;r+=3)o+=n[t[r-2]>>2],o+=n[(3&t[r-2])<<4|t[r-1]>>4],o+=n[(15&t[r-1])<<2|t[r]>>6],o+=n[63&t[r]];return r===i+1&&(o+=n[t[r-2]>>2],o+=n[(3&t[r-2])<<4],o+="=="),r===i&&(o+=n[t[r-2]>>2],o+=n[(3&t[r-2])<<4|t[r-1]>>4],o+=n[(15&t[r-1])<<2],o+="="),o}function decodeBase64(e){if("function"==typeof Buffer&&"function"==typeof Buffer.from){const t=Buffer.from(e,"base64"),r=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);return new Uint8Array(r)}const t=atob(e),r=t.length,n=new Uint8Array(r);for(let e=0;e<r;e++)n[e]=t.charCodeAt(e);return n}var o=Object.freeze({__proto__:null,decodeBase64:decodeBase64,decodeHex:decodeHex,encodeBase64:encodeBase64,encodeHex:encodeHex});function sum(...e){return e.reduce(((e,t)=>e+t),0)}function avg(...e){return sum(...e)/e.length}function product(...e){var t;return e.slice(1).reduce(((e,t)=>e*t),null!==(t=e[0])&&void 0!==t?t:0)}const i=Math.round;function round(e,t=0){if(t>0){const r=10**t;return i(e*r)/r}return i(e)}var s=Object.freeze({__proto__:null,avg:avg,product:product,round:round,sum:sum});const a=new TextEncoder,l=new TextDecoder;class ByteArray extends Uint8Array{toString(){return text(this)}toJSON(){return{type:"ByteArray",data:Array.from(this)}}}function bytes(e,t="utf8"){if("number"==typeof e)return new ByteArray(e);if("string"==typeof e){let r;return r="hex"===t?decodeHex(e):"base64"===t?decodeBase64(e):a.encode(e),new ByteArray(r.buffer,r.byteOffset,r.byteLength)}return ArrayBuffer.isView(e)?new ByteArray(e.buffer,e.byteOffset,e.byteLength):new ByteArray(e)}function text(e,t="utf8"){return"hex"===t?encodeHex(e):"base64"===t?encodeBase64(e):"function"==typeof Buffer&&e instanceof Buffer?e.toString("utf8"):l.decode(e)}function copy$2(e,t){return e.length>t.length&&(e=e.subarray(0,t.length)),t.set(e),e.length}function concat$2(...e){var t;const r=sum(...e.map((e=>e.length))),n=(null===(t=e[0])||void 0===t?void 0:t.constructor)||Uint8Array,o="function"==typeof Buffer&&Object.is(n,Buffer)?Buffer.alloc(r):new n(r);let i=0;for(const t of e)o.set(t,i),i+=t.length;return o}function compare$2(e,t){if(e===t)return 0;for(let r=0;r<e.length;r++){const n=e[r],o=t[r];if(void 0===o)return 1;if(n<o)return-1;if(n>o)return 1}return e.length<t.length?-1:0}function equals$3(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;if(e.length<1e3)return equals$4(e,t);const r=e.length,n=Math.floor(r/4),o=new Uint32Array(e.buffer,0,n),i=new Uint32Array(t.buffer,0,n);for(let o=4*n;o<r;o++)if(e[o]!==t[o])return!1;for(let e=0;e<o.length;e++)if(o[e]!==i[e])return!1;return!0}function includesSlice$1(e,t){return includeSlice(e,t)}function indexOfSlice(e,t,r=0){r<0&&(r=Math.max(0,e.length+r));const n=e.length-t.length,o=t[0];for(let i=r;i<=n;i++){if(e[i]!==o)continue;let r=1;for(;r<t.length&&e[i+r]===t[r];)r++;if(r===t.length)return i}return-1}function startsWith$2(e,t){return startsWith$3(e,t)}function endsWith$2(e,t){return endsWith$3(e,t)}function split$2(e,t){return split$3(e,t)}function chunk$3(e,t){return chunk$4(e,t)}var c=Object.freeze({__proto__:null,ByteArray:ByteArray,chunk:chunk$3,compare:compare$2,concat:concat$2,copy:copy$2,default:bytes,endsWith:endsWith$2,equals:equals$3,includesSlice:includesSlice$1,indexOfSlice:indexOfSlice,split:split$2,startsWith:startsWith$2,text:text});const u=(()=>{try{return new RegExp("^(?:\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?|\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F)(?:\\u200d(?:\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?|\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F))*$","u")}catch(e){return new RegExp("^(\\u00a9|\\u00ae|[\\u25a0-\\u27bf]|\\ud83c[\\ud000-\\udfff]|\\ud83d[\\ud000-\\udfff]|\\ud83e[\\ud000-\\udfff])$")}})(),d=chars;function compare$1(e,t){return e<t?-1:e>t?1:0}function random$2(e,t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"){const r=d(t);let n="";for(;0<e--;){n+=r[Math.floor(Math.random()*r.length)]}return n}function count$1(e,t){return t?e?e.split(t).length-1:0:e.length+1}function capitalize(e,t){const r=t?/\w+/g:/\w+/;return e.replace(r,(e=>e[0].toUpperCase()+e.slice(1).toLowerCase()))}function hyphenate(e){return e.replace(/(\S)\s+(\S)/g,((e,t,r)=>t+"-"+r))}function chars(e){return"object"==typeof Intl&&"function"==typeof Intl.Segmenter?Array.from((new Intl.Segmenter).segment(e)).map((e=>e.segment)):Array.from(e)}function words(e){const t=e.match(/\w+/g);return t?[...t].map((e=>e.split("_"))).flat():[]}function lines(e){return e.split(/\r?\n/)}function chunk$2(e,t){return chunk$4(e,t)}function truncate$2(e,t,r="end"){if(t<=0)return"";if(t>=e.length)return e;if(t-=3,"middle"===r){const r=Math.ceil(t/2),n=Math.floor(t/2);return e.slice(0,r)+"..."+e.slice(-n)}return"start"===r?"..."+e.slice(-t):e.slice(0,t)+"..."}const f=String.prototype.trim,p=String.prototype.trimEnd,h=String.prototype.trimStart;function trim(e,t=""){return t?trimEnd(trimStart(e,t),t):f.call(e)}function trimEnd(e,t=""){if(t){let r=e.length;for(;r--&&-1!==t.indexOf(e[r]););return e.substring(0,r+1)}return p.call(e)}function trimStart(e,t=""){if(t){let r=0;do{}while(-1!==t.indexOf(e[r])&&++r);return e.substring(r)}return h.call(e)}function stripEnd(e,t){return e.endsWith(t)?e.slice(0,-t.length):e}function stripStart(e,t){return e.startsWith(t)?e.slice(t.length):e}function dedent(e,...t){Array.isArray(e)&&(e=e.reduce(((e,r,n)=>e+r+(t[n]||"")),""));const r=lines(e),n=[];let o="";for(const e of r){const t=e.match(/^(\s+)\S+/);t&&(!o||t[1].length<o.length)&&(o=t[1])}for(const e of r)e.startsWith(o)?n.push(e.slice(o.length)):n.push(e);return n.join("\n").trim()}function byteLength(e){return bytes(e).byteLength}function isAscii(e,t=!1){return t?/^[-~]+$/.test(e):/^[\x00-\x7E]+$/.test(e)}function isEmoji(e){return chars(e).every((e=>u.test(e)))}var m=Object.freeze({__proto__:null,byteLength:byteLength,capitalize:capitalize,chars:chars,chunk:chunk$2,compare:compare$1,count:count$1,dedent:dedent,hyphenate:hyphenate,isAscii:isAscii,isEmoji:isEmoji,lines:lines,random:random$2,stripEnd:stripEnd,stripStart:stripStart,trim:trim,trimEnd:trimEnd,trimStart:trimStart,truncate:truncate$2,words:words});function isFloat(e){return!("number"!=typeof e||Number.isNaN(e)||Number.isFinite(e)&&e%1==0)}function isNumeric(e,t=!1){const r=typeof e;if(t)return"number"===r&&!Number.isNaN(e);if("bigint"===r)return!0;if("number"===r)return!Number.isNaN(e);if("string"===r&&e)try{return BigInt(e),!0}catch(t){return!Number.isNaN(Number(e))}return!1}function isBetween(e,t,r=void 0){const n=Array.isArray(t)?t[0]:t,o=Array.isArray(t)?t[1]:r;if(n>o)throw new RangeError("Minimum value cannot be greater than maximum value.");return e>=n&&e<=o}function clamp(e,t,r){if(t>r)throw new RangeError("Minimum value cannot be greater than maximum value.");return Math.max(t,Math.min(r,e))}function random$1(e,t){return e+Math.floor(Math.random()*(t-e+1))}function range(e,t,r=1){return sequence(e,t,r)}function serial(e=!1){return sequence(1,Number.MAX_SAFE_INTEGER,1,e)}function*sequence(e,t,r=1,n=!1){let o=e;for(;;)if(yield o,(o+=r)>t){if(!n)break;o=e}}String.compare=compare$1,String.random=random$2,void 0===String.dedent&&(String.dedent=dedent),String.prototype.count=function count(e){return count$1(String(this),e)},String.prototype.capitalize=function capitalize$1(e){return capitalize(String(this),e)},String.prototype.hyphenate=function capitalize(){return hyphenate(String(this))},String.prototype.chars=function chars$1(){return chars(String(this))},String.prototype.words=function words$1(){return words(String(this))},String.prototype.lines=function lines$1(){return lines(String(this))},String.prototype.chunk=function chunk(e){return chunk$2(String(this),e)},String.prototype.truncate=function truncate(e,t="end"){return truncate$2(String(this),e,t)},String.prototype.trim=function trim$1(e=""){return trim(String(this),e)},String.prototype.trimEnd=function trimEnd$1(e=""){return trimEnd(String(this),e)},String.prototype.trimStart=function trimStart$1(e=""){return trimStart(String(this),e)},String.prototype.stripEnd=function stripEnd$1(e){return stripEnd(String(this),e)},String.prototype.stripStart=function stripStart$1(e){return stripStart(String(this),e)},void 0===String.prototype.dedent&&(String.prototype.dedent=function dedent$1(){return dedent(String(this))}),String.prototype.byteLength=function byteLength$1(){return byteLength(String(this))},String.prototype.isAscii=function isAscii$1(e=!1){return isAscii(String(this),e)},String.prototype.isEmoji=function isEmoji$1(){return isEmoji(String(this))};var y=Object.freeze({__proto__:null,clamp:clamp,isBetween:isBetween,isFloat:isFloat,isNumeric:isNumeric,random:random$1,range:range,serial:serial});function chunk$1(e,t){return Iterator.from({next(...r){const n=function nextChunk(e,t){if(t<=0)throw new RangeError("Chunk size must be a positive integer");const r=[];for(let n=0;n<t;n++){const t=e.next();if(t.done)break;r.push(t.value)}return r.length>0?r:void 0}(e,t);return{done:void 0===n,value:n}},return(t){var r;return null===(r=e.return)||void 0===r||r.call(e,t),{done:!0,value:void 0}},throw(t){var r;throw null===(r=e.throw)||void 0===r||r.call(e,t),t}})}function isClass(e){if("function"!=typeof e)return!1;if([String,Number,Boolean,BigInt,Symbol].includes(e))return!1;if(void 0===e.prototype)return!1;if(e.prototype.constructor!==e)return!1;const t=e.toString();if("class"===t.slice(0,5))return!0;const r=e.name[0];return!!(r&&r>="A"&&r<="Z"&&t.includes("[native code]"))}function isSubclassOf(e,t){return"function"==typeof e&&"function"==typeof t&&e.prototype instanceof t}Number.isFloat=isFloat,Number.isNumeric=isNumeric,Number.isBetween=isBetween,Number.random=random$1,Number.range=range,Number.serial=serial,Number.prototype.isBetween=function(e,t){return isBetween(this,e,t)},Number.prototype.clamp||(Number.prototype.clamp=function(e,t){return clamp(this,e,t)}),"function"==typeof Iterator&&(Iterator.prototype.concat=function concat(...e){return function concat$1(...e){let t=0;return Iterator.from({next(...r){for(;t<e.length;){const n=e[t].next(...r);if(!n.done)return n;t++}return{done:!0,value:void 0}},return(r){var n,o;return null===(o=null===(n=e[t])||void 0===n?void 0:n.return)||void 0===o||o.call(n,r),{done:!0,value:void 0}},throw(r){var n,o;throw null===(o=null===(n=e[t])||void 0===n?void 0:n.throw)||void 0===o||o.call(n,r),r}})}(this,...e)},Iterator.prototype.filterMap=function filterMap(e){return function filterMap$1(e,t){let r=0;return Iterator.from({next(...n){for(;;){const o=e.next(...n);if(o.done)return o;const i=t(o.value,r++);if(null!=i)return{done:!1,value:i}}},return(t){var r;return null===(r=e.return)||void 0===r||r.call(e,t),{done:!0,value:void 0}},throw(t){var r;throw null===(r=e.throw)||void 0===r||r.call(e,t),t}})}(this,e)},Iterator.prototype.inspect=function inspect$1(e){return function inspect(e,t){let r=0;return Iterator.from({next(...n){const o=e.next(...n);return o.done||t(o.value,r++),o},return(t){var r;return null===(r=e.return)||void 0===r||r.call(e,t),{done:!0,value:void 0}},throw(t){var r;throw null===(r=e.throw)||void 0===r||r.call(e,t),t}})}(this,e)},Iterator.prototype.stepBy=function stepBy$1(e){return function stepBy(e,t){if(t<=0)throw new RangeError("Step must be a positive integer");let r=!0;return Iterator.from({next(...n){if(r)return r=!1,e.next(...n);let o;for(let r=0;r<t;r++)if(o=e.next(...n),o.done)return o;return o},return(t){var r;return null===(r=e.return)||void 0===r||r.call(e,t),{done:!0,value:void 0}},throw(t){var r;throw null===(r=e.throw)||void 0===r||r.call(e,t),t}})}(this,e)},Iterator.prototype.chunk=function chunk(e){return chunk$1(this,e)},Iterator.prototype.enumerate=function enumerate$1(){return function enumerate(e){let t=0;return Iterator.from({next(...r){const n=e.next(...r);return n.done?n:{done:!1,value:[t++,n.value]}},return(t){var r;return null===(r=e.return)||void 0===r||r.call(e,t),{done:!0,value:void 0}},throw(t){var r;throw null===(r=e.throw)||void 0===r||r.call(e,t),t}})}(this)},Iterator.prototype.zip=function zip$1(e){return function zip(e,t){return Iterator.from({next(...r){const n=e.next(...r),o=t.next(...r);return n.done||o.done?{done:!0,value:void 0}:{done:!1,value:[n.value,o.value]}},return(r){var n,o;return null===(n=e.return)||void 0===n||n.call(e,r),null===(o=t.return)||void 0===o||o.call(t,r),{done:!0,value:void 0}},throw(r){var n,o;throw null===(n=e.throw)||void 0===n||n.call(e,r),null===(o=t.throw)||void 0===o||o.call(t,r),r}})}(this,e)});var w=Object.freeze({__proto__:null,isClass:isClass,isSubclassOf:isSubclassOf});function first(e){return e[0]}function last(e){return e.length>0?e[e.length-1]:void 0}function random(e,t=!1){if(!e.length)return;if(1===e.length)return t?e.splice(0,1)[0]:e[0];const r=random$1(0,e.length-1);return t?e.splice(r,1)[0]:e[r]}function count(e,t){let r=0;for(let n=0;n<e.length;n++)e[n]===t&&r++;return r}function equals$2(e,t){return equals$4(e,t)}function includesSlice(e,t){return includeSlice(e,t)}function startsWith$1(e,t){return startsWith$3(e,t)}function endsWith$1(e,t){return endsWith$3(e,t)}function split$1(e,t){return split$3(e,t)}function chunk(e,t){return chunk$4(e,t)}function unique(e){return[...new Set(e)]}function uniqueBy(e,t){const r=new Map;for(let n=0;n<e.length;n++){const o=e[n],i=t(o,n);r.has(i)||r.set(i,o)}return[...r.values()]}function shuffle(e){for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}function orderBy(e,t,r="asc"){const n=e.slice();return"function"==typeof t?orderBy(n.map(((e,r)=>({key:t(e,r),value:e}))),"key",r).map((({value:e})=>e)):(n.sort(((e,r)=>{if("object"!=typeof e||"object"!=typeof r||!e||!r||Array.isArray(e)||Array.isArray(r))return-1;const n=e[t],o=r[t];return void 0===n||void 0===o?-1:"number"==typeof n&&"number"==typeof o?n-o:"string"==typeof n&&"string"==typeof o||"bigint"==typeof n&&"bigint"==typeof o?n<o?-1:1:-1})),"desc"===r&&n.reverse(),n)}function groupBy(e,t,r=Object){if(r===Map||isSubclassOf(r,Map)){const n=new r;for(let r=0;r<e.length;r++){const o=e[r],i=t(o,r),s=n.get(i);s?s.push(o):n.set(i,[o])}return n}{const r={};for(let n=0;n<e.length;n++){const o=e[n],i=t(o,n),s=r[i];s?s.push(o):r[i]=[o]}return r}}function keyBy(e,t,r=Object){if(r===Map||isSubclassOf(r,Map)){const n=new r;for(let r=0;r<e.length;r++){const o=e[r],i=t(o,r);n.set(i,o)}return n}{const r={};for(let n=0;n<e.length;n++){const o=e[n];r[t(o,n)]=o}return r}}function partition(e,t){const r=[],n=[];for(let o=0;o<e.length;o++){const i=e[o];(t(i,o)?r:n).push(i)}return[r,n]}function filterMap(e,t){const r=[];for(let n=0;n<e.length;n++){const o=t(e[n],n);null!=o&&r.push(o)}return r}var v=Object.freeze({__proto__:null,chunk:chunk,count:count,endsWith:endsWith$1,equals:equals$2,filterMap:filterMap,first:first,groupBy:groupBy,includesSlice:includesSlice,keyBy:keyBy,last:last,orderBy:orderBy,partition:partition,random:random,shuffle:shuffle,split:split$1,startsWith:startsWith$1,unique:unique,uniqueBy:uniqueBy});function hasOwn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function hasOwnMethod(e,t){var r;const n=Object.getPrototypeOf(e);return!(!n||!hasOwn(n,t))&&"function"==typeof(null===(r=Object.getOwnPropertyDescriptor(n,t))||void 0===r?void 0:r.value)}function patch(e,...t){for(const r of t)for(const t of Reflect.ownKeys(r))hasOwn(e,t)&&void 0!==e[t]||(e[t]=r[t]);return e}function pick(e,t){return t.reduce(((t,r)=>(r in e&&void 0!==e[r]&&(t[r]=e[r]),t)),{})}function omit(e,t){const r=Reflect.ownKeys(e).filter((e=>!t.includes(e))),n=pick(e,r);return e instanceof Error&&["name","message","stack","cause"].forEach((r=>{t.includes(r)||void 0===e[r]||hasOwn(n,r)||(n[r]=e[r])})),n}function as$1(e,t){if("function"!=typeof t)throw new TypeError("type must be a valid constructor");let r;const n={string:String,number:Number,bigint:BigInt,boolean:Boolean,symbol:Symbol};return e instanceof t?[String,Number,Boolean].includes(t)?e.valueOf():e:(r=typeof e)&&n[r]===t?e:null}function typeOf(e){var t,r;if(void 0===e)return"undefined";if(null===e)return"null";const n=typeof e;return"function"===n?isClass(e)?"class":"function":"object"===n?null!==(r=null===(t=Object.getPrototypeOf(e))||void 0===t?void 0:t.constructor)&&void 0!==r?r:Object:n}function isValid(e){return!(null==e||Object.is(e,NaN)||e instanceof Date&&"Invalid Date"===e.toString())}function isPlainObject(e){if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return null===t||t.constructor===Object}function compare(e,t){const r=doCompare(e,t);if("number"==typeof r)return r;throw new TypeError(r.description)}Array.prototype.first=function first$1(){return first(this)},Array.prototype.last=function last$1(){return last(this)},Array.prototype.random=function random$1(e=!1){return random(this,e)},Array.prototype.count=function count$1(e){return count(this,e)},Array.prototype.equals=function equals(e){return equals$2(this,e)},Array.prototype.includesSlice=function includesSlice$1(e){return includesSlice(this,e)},Array.prototype.startsWith=function startsWith(e){return startsWith$1(this,e)},Array.prototype.endsWith=function endsWith(e){return endsWith$1(this,e)},Array.prototype.split=function split(e){return split$1(this,e)},Array.prototype.chunk=function chunk$1(e){return chunk(this,e)},Array.prototype.unique=function unique$1(){return unique(this)},Array.prototype.uniqueBy=function uniqueBy$1(e){return uniqueBy(this,e)},Array.prototype.shuffle=function shuffle$1(){return shuffle(this)},Array.prototype.toShuffled=function toShuffled(){return this.slice().shuffle()},Array.prototype.toReversed||(Array.prototype.toReversed=function toReversed(){return this.slice().reverse()}),Array.prototype.toSorted||(Array.prototype.toSorted=function toSorted(e){return this.slice().sort(e)}),Array.prototype.orderBy=function orderBy$1(e,t="asc"){return orderBy(this,e,t)},Array.prototype.groupBy=function groupBy$1(e,t=Object){return groupBy(this,e,t)},Array.prototype.keyBy=function keyBy$1(e,t=Object){return keyBy(this,e,t)},Array.prototype.partition=function partition$1(e){return partition(this,e)},Array.prototype.filterMap=function filterMap$1(e){return filterMap(this,e)},Uint8Array.copy=copy$2,Uint8Array.concat=concat$2,Uint8Array.compare=compare$2,Uint8Array.prototype.equals=function equals(e){return equals$3(this,e)},Uint8Array.prototype.includesSlice=function includesSlice(e){return includesSlice$1(this,e)},Uint8Array.prototype.startsWith=function startsWith(e){return startsWith$2(this,e)},Uint8Array.prototype.endsWith=function endsWith(e){return endsWith$2(this,e)},Uint8Array.prototype.split=function split(e){return split$2(this,e)},Uint8Array.prototype.chunk=function chunk(e){return chunk$3(this,e)};const g=Symbol("Cannot compare values of different types"),b=Symbol("Cannot compare non-comparable values"),E=Symbol("Cannot compare NaN");function doCompare(e,t){if(e===t)return 0;if(typeof e!=typeof t)return g;if("string"==typeof e)return e.localeCompare(t);if("number"==typeof e)return Object.is(e,NaN)||Object.is(t,NaN)?E:e===t?0:e<t?-1:1;if("bigint"==typeof e)return e===t?0:e<t?-1:1;if("boolean"==typeof e)return e===t?0:e?1:-1;if("object"!=typeof e)return b;if("function"==typeof e.compareTo&&"function"==typeof t.compareTo){if(isPlainObject(e)&&isPlainObject(t)){const r=Reflect.ownKeys(e),n=Reflect.ownKeys(t);return r.every((e=>e in t))&&n.every((t=>t in e))?e.compareTo(t):g}return e.constructor===t.constructor||getPrototypeBy(e,"compareTo")===getPrototypeBy(t,"compareTo")?e.compareTo(t):g}return"function"==typeof e.valueOf&&"function"==typeof t.valueOf?(e=e.valueOf(),t=t.valueOf(),null===e&&null===t||void 0===e&&void 0===t?0:typeof e!=typeof t?b:"string"==typeof e?e.localeCompare(t):"number"==typeof e?Object.is(e,NaN)||Object.is(t,NaN)?b:e===t?0:e<t?-1:1:"bigint"==typeof e?e===t?0:e<t?-1:1:"boolean"==typeof e?e===t?0:e?1:-1:b):b}function getPrototypeBy(e,t){let r=Object.getPrototypeOf(e);for(;r;){if(hasOwn(r,t))return r;r=Object.getPrototypeOf(r)}return null}function equals$1(e,t){return isEqual(e,t)}function isEqual(e,t,r=[]){if(null==e)return e===t;if(e===t||Object.is(e,t))return!0;if(typeof e!=typeof t)return!1;if("object"!=typeof e)return e===t;if(e.constructor===String&&t.constructor===String)return e.valueOf()===t.valueOf();if(e.constructor===Number&&t.constructor===Number){const r=e.valueOf(),n=t.valueOf();return r===n||Object.is(r,n)}if(e.constructor===Boolean&&t.constructor===Boolean)return e.valueOf()===t.valueOf();if(r.includes(e)&&r.includes(t))return!0;if("function"==typeof e.compareTo&&"function"==typeof t.compareTo)return 0===doCompare(e,t);if(e.constructor!==t.constructor)return!1;if(e.constructor!==Object&&e.constructor){if(e instanceof Array){const n=[...r,e,t];return e.length===t.length&&e.every(((e,r)=>isEqual(e,t[r],n)))}if(e instanceof ArrayBuffer){return equals$3(new Uint8Array(e),new Uint8Array(t))}if(ArrayBuffer.isView(e)){if(e instanceof Uint8Array)return equals$3(e,t);return equals$3(new Uint8Array(e.buffer),new Uint8Array(t.buffer))}if(e instanceof Map){const n=[...r,e,t];return e.size===t.size&&[...e].every((([e,r])=>isEqual(r,t.get(e),n)))}if(e instanceof Set)return e.size===t.size&&[...e].every((e=>t.has(e)));if(e instanceof RegExp){const{source:r,flags:n,lastIndex:o}=e,{source:i,flags:s,lastIndex:a}=t;return r===i&&n===s&&o===a}if(e instanceof Error){const{name:n,message:o,stack:i,cause:s,errors:a,...l}=e,{name:c,message:u,stack:d,cause:f,errors:p,...h}=t;return n===c&&o===u&&i===d&&isEqual(s,f,[...r,e,t])&&isEqual(a,p,[...r,e,t])&&isEqual(l,h,[...r,e,t])}if(e instanceof URL)return e.href===t.href;if(e instanceof URLSearchParams)return e.toString()===t.toString();if("function"==typeof Headers&&e instanceof Headers){const r=t,n=e.getSetCookie(),o=r.getSetCookie();if(n.length!==o.length)return!1;if(n.length&&n.some((e=>!o.includes(e))))return!1;const i=[...e].filter((([e])=>"set-cookie"!==e)),s=[...r].filter((([e])=>"set-cookie"!==e));return i.length===s.length&&i.every((([e,t])=>t===r.get(e)))}if("function"==typeof FormData&&e instanceof FormData){const r=[...e].reduce(((e,[t,r])=>{var n;const o=null!==(n=e.get(t))&&void 0!==n?n:[];return o.push(r),e.set(t,o),e}),new Map),n=[...t].reduce(((e,[t,r])=>{var n;const o=null!==(n=e.get(t))&&void 0!==n?n:[];return o.push(r),e.set(t,o),e}),new Map);return r.size===n.size&&[...r].every((([e,t])=>isEqual(t,n.get(e))))}return"function"==typeof Storage&&e instanceof Storage?isEqual({...e},{...t}):0===doCompare(e,t)}{if(0===doCompare(e,t))return!0;const n=Reflect.ownKeys(e),o=Reflect.ownKeys(t);if(n.length!==o.length)return!1;const i=[...r,e,t];return n.every((r=>isEqual(e[r],t[r],i)))}}function sanitize$1(e,t=!1,r={}){const{removeNulls:n,removeEmptyStrings:o,removeEmptyObjects:i,removeArrayItems:s}=r;return function process(e,r){if("string"==typeof e)return e.trim();if(Array.isArray(e)){const a=!r||t?e.map((e=>process(e,r+1))):e;return s?a.filter((e=>null===e?!n:""===e?!o:!!isValid(e)&&("object"!=typeof e||(Array.isArray(e)?e.length>0||!i:!isPlainObject(e)||(Reflect.ownKeys(e).length>0||!i))))):a}return isPlainObject(e)&&(!r||t)?Reflect.ownKeys(e).reduce(((t,s)=>{const a=process(e[s],r+1);return null===a?n||(t[s]=a):""===a?o||(t[s]=a):isValid(a)&&("object"!=typeof a?t[s]=a:Array.isArray(a)?(a.length>0||!i)&&(t[s]=a):isPlainObject(a)?(Reflect.ownKeys(a).length>0||!i)&&(t[s]=a):t[s]=a),t}),e.constructor?{}:Object.create(null)):e}(e,0)}function sortKeys(e,t=!1){return function process(e,r){return isPlainObject(e)?!r||t?[...Object.getOwnPropertyNames(e).sort(),...Object.getOwnPropertySymbols(e)].reduce(((t,n)=>(t[n]=process(e[n],r+1),t)),e.constructor?{}:Object.create(null)):e:Array.isArray(e)&&(!r||t)?e.map((e=>process(e,r+1))):e}(e,0)}function flatKeys(e,t=1,r={}){var n;const o=t,i=e.constructor?{}:Object.create(null),s=null!==(n=null==r?void 0:r.flatArrayIndices)&&void 0!==n&&n;return isPlainObject(e)||Array.isArray(e)&&s?(function process(e,t,r){r===o?i[t]=e:Array.isArray(e)&&r?s?e.forEach(((e,n)=>{process(e,t?`${t}.${n}`:String(n),t?r+1:r)})):i[t]=e:isPlainObject(e)||Array.isArray(e)&&!r?Reflect.ownKeys(e).forEach((n=>{const o=e[n];"symbol"==typeof n?0===r&&(i[n]=o):process(o,t?`${t}.${n}`:n,t?r+1:r)})):i[t]=e}(e,"",0),i):e}function filterEntries(e,t){return Object.fromEntries(Object.entries(e).filter(t))}function mapEntries(e,t){return Object.fromEntries(Object.entries(e).map(t))}function partitionEntries(e,t){const r={},n={},o=Object.entries(e);for(const[e,i]of o)t([e,i])?r[e]=i:n[e]=i;return[r,n]}function invert(e){return Object.fromEntries(Object.entries(e).map((([e,t])=>[t,e])))}var S,k=Object.freeze({__proto__:null,as:as$1,compare:compare,equals:equals$1,filterEntries:filterEntries,flatKeys:flatKeys,hasOwn:hasOwn,hasOwnMethod:hasOwnMethod,invert:invert,isPlainObject:isPlainObject,isValid:isValid,mapEntries:mapEntries,omit:omit,partitionEntries:partitionEntries,patch:patch,pick:pick,sanitize:sanitize$1,sortKeys:sortKeys,typeOf:typeOf});Object.hasOwn||(Object.hasOwn=hasOwn),Object.hasOwnMethod||(Object.hasOwnMethod=hasOwnMethod),Object.patch=patch,Object.pick=pick,Object.omit=omit,Object.as=as$1,Object.typeOf=typeOf,Object.isValid=isValid,Object.isPlainObject=isPlainObject,Object.compare=compare,Object.equals=equals$1,Object.sanitize=sanitize$1,Object.sortKeys=sortKeys,Object.flatKeys=flatKeys,Object.filterEntries=filterEntries,Object.mapEntries=mapEntries,Object.partitionEntries=partitionEntries,Object.invert=invert,Math.sum=sum,Math.avg=avg,Math.product=product,Math.round=round;const x=Symbol.for("id"),T="object"==typeof window&&"object"==typeof window.document&&"function"==typeof window.matchMedia,O="function"==typeof ServiceWorkerGlobalScope&&globalThis instanceof ServiceWorkerGlobalScope,A="function"==typeof SharedWorkerGlobalScope&&globalThis instanceof SharedWorkerGlobalScope,F="function"==typeof DedicatedWorkerGlobalScope&&globalThis instanceof DedicatedWorkerGlobalScope,j="object"==typeof Deno&&"object"==typeof Deno.version,$="object"==typeof Bun&&"string"==typeof Bun.version,P="object"==typeof process&&!!(null===(S=process.versions)||void 0===S?void 0:S.node)&&!j,C=P&&!j&&!$,D=C&&parseInt(process.version.slice(1))<14;C&&parseInt(process.version.slice(1)),C&&parseInt(process.version.slice(1));const R=!(C&&(!0===process.abort.disabled||process.argv.includes("--worker-thread")))&&($?Bun.isMainThread:"undefined"==typeof WorkerGlobalScope);let L=class Exception extends Error{constructor(e,t=0){super(e),this.code=0,"number"==typeof t?this.code=t:"string"==typeof t?Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,writable:!0,value:t}):(t.name&&Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,writable:!0,value:t.name}),t.cause&&Object.defineProperty(this,"cause",{configurable:!0,enumerable:!1,writable:!0,value:t.cause}),t.code&&(this.code=t.code))}};Object.defineProperty(L.prototype,"name",{configurable:!0,enumerable:!1,get(){return this.constructor.name}});class NotAllowedError extends L{constructor(e,t={}){super(e,{...t,name:"NotAllowedError",code:403})}}class NotFoundError extends L{constructor(e,t={}){super(e,{...t,name:"NotFoundError",code:404})}}class AlreadyExistsError extends L{constructor(e,t={}){super(e,{...t,name:"AlreadyExistsError",code:409})}}let I=class NotSupportedError extends L{constructor(e,t={}){super(e,{...t,name:"NotSupportedError",code:405})}};class NotImplementedError extends L{constructor(e,t={}){super(e,{...t,name:"NotImplementedError",code:501})}}class TimeoutError extends L{constructor(e,t={}){super(e,{...t,name:"TimeoutError",code:408})}}class NetworkError extends L{constructor(e,t={}){super(e,{...t,name:"NetworkError"})}}var N=Object.freeze({__proto__:null,AlreadyExistsError:AlreadyExistsError,NetworkError:NetworkError,NotAllowedError:NotAllowedError,NotFoundError:NotFoundError,NotImplementedError:NotImplementedError,NotSupportedError:I,TimeoutError:TimeoutError});function createErrorEvent(e,t={}){var r,n,o,i,s,a,l,c;if("function"==typeof ErrorEvent)return new ErrorEvent(e,t);{const u=new Event(e,{bubbles:null!==(r=null==t?void 0:t.bubbles)&&void 0!==r&&r,cancelable:null!==(n=null==t?void 0:t.cancelable)&&void 0!==n&&n,composed:null!==(o=null==t?void 0:t.composed)&&void 0!==o&&o});return Object.defineProperties(u,{message:{configurable:!0,value:null!==(i=null==t?void 0:t.message)&&void 0!==i?i:""},filename:{configurable:!0,value:null!==(s=null==t?void 0:t.filename)&&void 0!==s?s:""},lineno:{configurable:!0,value:null!==(a=null==t?void 0:t.lineno)&&void 0!==a?a:0},colno:{configurable:!0,value:null!==(l=null==t?void 0:t.colno)&&void 0!==l?l:0},error:{configurable:!0,value:null!==(c=null==t?void 0:t.error)&&void 0!==c?c:void 0}}),u}}function createCloseEvent(e,t={}){var r,n,o,i,s,a;if("function"==typeof CloseEvent)return new CloseEvent(e,t);{const l=new Event(e,{bubbles:null!==(r=null==t?void 0:t.bubbles)&&void 0!==r&&r,cancelable:null!==(n=null==t?void 0:t.cancelable)&&void 0!==n&&n,composed:null!==(o=null==t?void 0:t.composed)&&void 0!==o&&o});return Object.defineProperties(l,{code:{configurable:!0,value:null!==(i=t.code)&&void 0!==i?i:0},reason:{configurable:!0,value:null!==(s=t.reason)&&void 0!==s?s:""},wasClean:{configurable:!0,value:null!==(a=t.wasClean)&&void 0!==a&&a}}),l}}function createProgressEvent(e,t={}){var r,n,o,i,s,a;if("function"==typeof ProgressEvent)return new ProgressEvent(e,t);{const l=new Event(e,{bubbles:null!==(r=null==t?void 0:t.bubbles)&&void 0!==r&&r,cancelable:null!==(n=null==t?void 0:t.cancelable)&&void 0!==n&&n,composed:null!==(o=null==t?void 0:t.composed)&&void 0!==o&&o});return Object.defineProperties(l,{lengthComputable:{configurable:!0,value:null!==(i=null==t?void 0:t.lengthComputable)&&void 0!==i&&i},loaded:{configurable:!0,value:null!==(s=null==t?void 0:t.loaded)&&void 0!==s?s:0},total:{configurable:!0,value:null!==(a=null==t?void 0:t.total)&&void 0!==a?a:0}}),l}}var B=Object.freeze({__proto__:null,createCloseEvent:createCloseEvent,createCustomEvent:function createCustomEvent(e,t={}){var r,n,o,i;if("function"==typeof CustomEvent)return new CustomEvent(e,t);{const s=new Event(e,{bubbles:null!==(r=null==t?void 0:t.bubbles)&&void 0!==r&&r,cancelable:null!==(n=null==t?void 0:t.cancelable)&&void 0!==n&&n,composed:null!==(o=null==t?void 0:t.composed)&&void 0!==o&&o});return Object.defineProperties(s,{detail:{configurable:!0,value:null!==(i=null==t?void 0:t.detail)&&void 0!==i?i:null}}),s}},createErrorEvent:createErrorEvent,createProgressEvent:createProgressEvent});const{NotSupportedError:U}=N,W=new Map([["Exception",L]]);function registerErrorType(e){W.set(e.name,e)}function getErrorConstructor(e){let t=W.get(e);if(!t&&e in globalThis){const r=globalThis[e];(r===Error||isSubclassOf(r,Error)||"function"==typeof DOMException&&r===DOMException)&&(t=r)}return t||null}function toObject(e){e instanceof Error||!e.name||!e.message||(e=fromObject(e,Error));const t={"@@type":e.constructor.name,...omit(e,["toString","toJSON","__callSiteEvals"])};return"cause"in t&&(t.cause=t.cause instanceof Error?toObject(t.cause):t.cause),"AggregateError"===t["@@type"]&&Array.isArray(t.errors)&&(t.errors=t.errors.map((e=>e instanceof Error?toObject(e):e))),t}function fromObject(e,t=null,r=!1){var n,o,i,s;if(!(null==e?void 0:e.name)||r&&!e["@@type"])return null;const a=e["@@type"]||e.name;let l;null!=t||(t=null!==(n=getErrorConstructor(a))&&void 0!==n?n:Error),"DOMException"===t.name&&"function"==typeof DOMException?l=new t(null!==(o=e.message)&&void 0!==o?o:"",e.name):(l=Object.create(t.prototype,{message:{configurable:!0,enumerable:!1,writable:!0,value:null!==(i=e.message)&&void 0!==i?i:""}}),Object.defineProperty(l,"name",{configurable:!0,enumerable:!1,writable:!0,value:e.name})),void 0!==e.stack&&Object.defineProperty(l,"stack",{configurable:!0,enumerable:!1,writable:!0,value:e.stack}),null!=e.cause&&Object.defineProperty(l,"cause",{configurable:!0,enumerable:!1,writable:!0,value:isPlainObject(e.cause)&&null!==(s=fromObject(e.cause,void 0,!0))&&void 0!==s?s:e.cause});return Reflect.ownKeys(e).filter((e=>!["@@type","name","message","stack","cause"].includes(e))).forEach((t=>{var r;null!==(r=l[t])&&void 0!==r||(l[t]=e[t])})),isAggregateError(l)&&Array.isArray(l.errors)&&(l.errors=l.errors.map((e=>isPlainObject(e)?fromObject(e):e))),l}function toErrorEvent(e,t="error"){let r="",n=0,o=0;if(e.stack){const t=e.stack.split("\n").map((e=>e.trim()));let i=t.find((e=>e.startsWith("at ")));if(i?i=i.slice(3):(i=t.find((e=>e.includes("@")&&e.length>1)))&&(i=i.slice(i.indexOf("@")+1)),i){let e=i.lastIndexOf("("),t=0;-1!==e&&(e+=1,t=i.indexOf(")",e),i=i.slice(e,t));const s=i.match(/:(\d+):(\d+)$/);s&&(r=i.slice(0,s.index),n=parseInt(s[1]),o=parseInt(s[2]))}}return createErrorEvent(t,{error:e,message:e.message,filename:r,lineno:n,colno:o})}function fromErrorEvent(e){if(e.error instanceof Error)return e.error;let t,r=!1;if(e.error&&"object"==typeof e.error&&e.error.name&&e.error.message)t=fromObject(e.error),r=!t.stack;else{if(!e.message)return null;t=new Error(e.message),r=!0}if(r){let r="";r="object"==typeof navigator&&navigator.userAgent.includes("Firefox")?e.filename?"@"+e.filename:"@debugger eval code":"object"==typeof navigator&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")?e.filename?"@"+e.filename:"global code@":`${t.name}: ${e.message}\n    at ${e.filename||"<anonymous>"}`,e.lineno&&"global code@"!==r&&(r+=":"+e.lineno),e.colno&&"global code@"!==r&&(r+=":"+e.colno),Object.defineProperty(t,"stack",{configurable:!0,enumerable:!1,writable:!0,value:r})}return t}function isDOMException(e){return"function"==typeof DOMException&&e instanceof DOMException||e instanceof Error&&"DOMException"===e.constructor.name}function isAggregateError(e){return"function"==typeof AggregateError&&e instanceof AggregateError||e instanceof Error&&"AggregateError"===e.constructor.name}function throwUnsupportedRuntimeError(){throw new U("Unsupported runtime")}function isCausedBy(e,t){for(;;){if(e.cause===t||Object.is(e.cause,t)||"function"==typeof t&&e.cause instanceof t)return!0;if(!(e.cause instanceof Error))break;e=e.cause}return!1}Object.values(N).filter((e=>isSubclassOf(e,Error))).forEach((e=>registerErrorType(e)));var M=Object.freeze({__proto__:null,AlreadyExistsError:AlreadyExistsError,Exception:L,NetworkError:NetworkError,NotAllowedError:NotAllowedError,NotFoundError:NotFoundError,NotImplementedError:NotImplementedError,NotSupportedError:I,TimeoutError:TimeoutError,fromErrorEvent:fromErrorEvent,fromObject:fromObject,getErrorConstructor:getErrorConstructor,isAggregateError:isAggregateError,isCausedBy:isCausedBy,isDOMException:isDOMException,registerErrorType:registerErrorType,throwUnsupportedRuntimeError:throwUnsupportedRuntimeError,toErrorEvent:toErrorEvent,toObject:toObject});function parseUserAgent(e){var t,r,n,o,i;if(!e)throw new SyntaxError("The user agent string cannot be empty.");const s={name:"",version:void 0,runtime:void 0,platform:"unknown",mobile:/Mobile/i.test(e),raw:e};let a=[...e.matchAll(/(\S+)\/(\d+(\.\d+)*)(\s\((.+?)\))?/g)].map((e=>{const[,t,r,,,n]=e;return{name:t,version:r,extra:n}}));if(0===a.length&&e.length)return s.name=e,/Cloudflare[-\s]Workers?/i.test(e)&&(s.runtime={identity:"workerd",version:void 0}),s;const l=null===(t=a.find((e=>{var t;return null===(t=e.extra)||void 0===t?void 0:t.includes(";")})))||void 0===t?void 0:t.extra;l&&(l.includes("Macintosh")||l.includes("iPhone")||l.includes("iPad")||l.includes("iPod")?s.platform="darwin":l.includes("Windows")?s.platform="windows":l.includes("Android")?s.platform="android":l.includes("Linux")?s.platform="linux":l.includes("FreeBSD")?s.platform="freebsd":l.includes("OpenBSD")?s.platform="openbsd":l.includes("NetBSD")?s.platform="netbsd":l.includes("AIX")?s.platform="aix":l.match(/SunOS|Solaris/)&&(s.platform="solaris"));let c=a.find((e=>"Safari"===e.name));const u=a.find((e=>/Chrome|CriOS/i.test(e.name))),d=a.find((e=>/Firefox|FxiOS/i.test(e.name))),f=a.find((e=>/Opera|OPR(iOS)?|OPT|OPR/i.test(e.name))),p=a.find((e=>/Edg(e|A|iOS)?/i.test(e.name))),h=a.find((e=>/DuckDuckGo|Ddg(A|iOS)?/i.test(e.name))),m=null!==(r=a.find((e=>/(Mac)?WeChat/i.test(e.name))))&&void 0!==r?r:a.find((e=>/MicroMessenger/i.test(e.name))),y=e.match(/\b(DingTalk)\/(\d+(\.\d+)+)/);let w,v,g;if(!s.mobile||"darwin"!==s.platform||c||u||d||(c=a.find((e=>"AppleWebKit"===e.name))),s.mobile&&"darwin"===s.platform&&c)if(s.runtime={identity:"safari",version:c.version},f)s.name="Opera",s.version=f.version;else if(p)s.name="Edge",s.version=p.version;else if(u)s.name="Chrome",s.version=u.version;else if(d)s.name="Firefox",s.version=d.version;else if(h)s.name="DuckDuckGo",s.version=h.version;else if(m)s.name="WeChat",s.version=m.version;else if(y)s.name="DingTalk",s.version=y[2];else{const e=a[a.length-1];s.name=e.name,s.version=e.version}else if(!c||u||d)if(u&&!d)if(s.runtime={identity:"chrome",version:u.version},f)s.name="Opera",s.version=f.version;else if(p)s.name="Edge",s.version=p.version;else if(h)s.name="DuckDuckGo",s.version=h.version;else if(m)s.name="WeChat",s.version=m.version;else if(y)s.name="DingTalk",s.version=y[2];else{const e=a.findIndex((e=>e===u)),t=null!==(o=a[e+1])&&void 0!==o?o:a[a.length-1];"Safari"===t.name?(s.name="Chrome",s.version=u.version):(s.name=t.name,s.version=t.version)}else if(d&&!u){s.runtime={identity:"firefox",version:d.version};const e=a.findIndex((e=>e===d)),t=null!==(i=a[e+1])&&void 0!==i?i:a[a.length-1];"Safari"===t.name?(s.name="Firefox",s.version=d.version):(s.name=t.name,s.version=t.version)}else if(p)s.name="Edge",s.version=p.version,s.runtime={identity:"unknown",version:p.version};else if(h)s.name="DuckDuckGo",s.version=h.version,s.runtime={identity:"unknown",version:h.version};else if(w=a.find((e=>"Node.js"===e.name)))s.name="Node.js",s.version=w.version,s.runtime={identity:"node",version:w.version};else if(v=a.find((e=>"Deno"===e.name)))s.name="Deno",s.version=v.version,s.runtime={identity:"deno",version:v.version};else if(g=a.find((e=>"Bun"===e.name)))s.name="Bun",s.version=g.version,s.runtime={identity:"bun",version:g.version};else if(y)s.name="DingTalk",s.version=y[2];else{const e=a[a.length-1];s.name=e.name,s.version=e.version}else if(s.runtime={identity:"safari",version:c.version},h)s.name="DuckDuckGo",s.version=h.version;else if(m)s.name="WeChat",s.version=m.version;else if(y)s.name="DingTalk",s.version=y[2];else{const e=a.findIndex((e=>e===c)),t=null!==(n=a[e+1])&&void 0!==n?n:a[a.length-1];s.name=t.name,s.version=t.version}return s}function runtime(){var e;if(j)return{identity:"deno",version:Deno.version.deno,fsSupport:!0,tsSupport:!0,worker:R?void 0:"dedicated"};if($)return{identity:"bun",version:Bun.version,fsSupport:!0,tsSupport:!0,worker:R?void 0:"dedicated"};if(C)return{identity:"node",version:process.version.slice(1),fsSupport:!0,tsSupport:process.execArgv.some((e=>/\b(tsx|ts-node|vite|swc-node|tsimp)\b/.test(e)))||/\.tsx?$|\bvite\b/.test(null!==(e=process.argv[1])&&void 0!==e?e:""),worker:R?void 0:"dedicated"};const t="function"==typeof FileSystemHandle,r=A?"shared":O?"service":F?"dedicated":void 0;if("object"==typeof navigator&&"string"==typeof navigator.userAgent){const e=parseUserAgent(navigator.userAgent);if(e.runtime){const{identity:n,version:o}=e.runtime;return"workerd"===n?{identity:n,version:o,fsSupport:t,tsSupport:(()=>{try{throw new Error("Test error")}catch(e){return/[\\/]\.?wrangler[\\/]/.test(e.stack)}})(),worker:"service"}:{identity:n,version:o,fsSupport:t,tsSupport:!1,worker:r}}return{identity:"unknown",version:void 0,fsSupport:t,tsSupport:!1,worker:r}}return"function"==typeof WorkerLocation&&globalThis.location instanceof WorkerLocation?{identity:"fastly",version:void 0,fsSupport:t,tsSupport:!1,worker:"service"}:{identity:"unknown",version:void 0,fsSupport:t,tsSupport:!1,worker:r}}const _=["darwin","windows","linux","android","freebsd","openbsd","netbsd","aix","solaris"];function platform(){if(j){if(_.includes(Deno.build.os))return Deno.build.os}else if(P){if("win32"===process.platform)return"windows";if("sunos"===process.platform)return"solaris";if(_.includes(process.platform))return process.platform}else if("object"==typeof navigator&&"string"==typeof navigator.userAgent)return parseUserAgent(navigator.userAgent).platform;return"unknown"}const z={};function env(e=void 0,t=void 0){var r,n;if(j)if("object"==typeof e&&null!==e)for(const[t,r]of Object.entries(e))Deno.env.set(t,String(r));else{if(void 0===e)return Deno.env.toObject();if(void 0===t)return Deno.env.get(e);Deno.env.set(e,String(t))}else if("object"==typeof process&&"object"==typeof(null===process||void 0===process?void 0:process.env))if("object"==typeof e&&null!==e)for(const[t,r]of Object.entries(e))process.env[t]=String(r);else{if(void 0===e)return process.env;if(void 0===t)return process.env[e];process.env[e]=String(t)}else if("workerd"===runtime().identity){if("object"!=typeof e||null===e){if(void 0===e){if(Object.keys(z).length)return z;return Object.keys(globalThis).filter((e=>/^[A-Z][A-Z0-9_]*$/.test(e)&&["string","number","boolean"].includes(typeof globalThis[e]))).reduce(((e,t)=>(e[t]=String(globalThis[t]),e)),{})}if(void 0===t){if(void 0!==z[e])return z[e];{const t=globalThis[e];return["string","number","boolean"].includes(typeof t)?String(t):void 0}}throw new I("Cannot modify environment variables in the worker.")}for(const[t,r]of Object.entries(e))["string","number","boolean"].includes(typeof r)&&(z[t]=String(r))}else{const o=globalThis.__env__;if(null==o||"object"==typeof o)if("object"==typeof e&&null!==e)for(const[t,n]of Object.entries(e))(null!==(r=globalThis.__env__)&&void 0!==r?r:globalThis.__env__={})[t]=String(n);else{if(void 0===e)return null!=o?o:{};if(void 0===t)return(null==o?void 0:o[e])?String(o[e]):void 0;(null!==(n=globalThis.__env__)&&void 0!==n?n:globalThis.__env__={})[e]=String(t)}else if("object"==typeof e&&null!==e)for(const[t,r]of Object.entries(e))z[t]=String(r);else{if(void 0===e)return z;if(void 0===t)return z[e];o[e]=String(t)}}}function unrefTimer(e){"object"==typeof e&&"function"==typeof e.unref?e.unref():"number"==typeof e&&j&&Deno.unrefTimer(e)}const H=[];const q=[];const K=j?Symbol.for("Deno.customInspect"):P?Symbol.for("nodejs.util.inspect.custom"):Symbol.for("Symbol.customInspect");var V=Object.freeze({__proto__:null,addShutdownListener:function addShutdownListener(e){if(!j&&!P)return;if(H.length)return void H.push(e);H.push(e);const shutdownListener=async()=>{try{const e=createCloseEvent("shutdown",{cancelable:!0,code:0,reason:"The program is interrupted.",wasClean:!0});Object.defineProperties(e,{target:{configurable:!0,value:globalThis},currentTarget:{configurable:!0,value:globalThis}});for(const t of H)await t(e);e.defaultPrevented||(j?Deno.exit(0):process.exit(0))}catch(e){console.error(e),j?Deno.exit(1):process.exit(1)}};j?Deno.addSignalListener("SIGINT",shutdownListener):(process.on("SIGINT",shutdownListener),"windows"===platform()&&process.on("message",(e=>{"shutdown"===e&&shutdownListener()})))},addUnhandledRejectionListener:function addUnhandledRejectionListener(e){const t=runtime().identity,fireEvent=(e,t)=>{const r=new Event("unhandledrejection",{cancelable:!0});return Object.defineProperties(r,{reason:{configurable:!0,value:e},promise:{configurable:!0,value:t},target:{configurable:!0,value:globalThis},currentTarget:{configurable:!0,value:globalThis}}),q.forEach((e=>{e.call(globalThis,r)})),r};if("node"===t||"bun"===t){if(q.length)return void q.push(e);q.push(e),process.on("unhandledRejection",((e,r)=>{fireEvent(e,r).defaultPrevented||("node"===t?console.error("[1m[31merror[0m: Uncaught (in promise)",e):console.error("Uncaught (in promise)",e),process.exit(1))}))}else if("workerd"===t){if(q.length)return void q.push(e);q.push(e),addEventListener("unhandledrejection",(e=>{(e=fireEvent(e.reason,e.promise)).defaultPrevented||console.error("Uncaught (in promise)",e.reason)}))}else"function"==typeof addEventListener&&"fastly"!==t&&"unknown"!==t&&addEventListener("unhandledrejection",e)},customInspect:K,default:runtime,env:env,isREPL:function isREPL(){return"_"in globalThis&&"_error"in globalThis||"$0"in globalThis&&"$1"in globalThis||"object"==typeof $0||"object"==typeof $1},platform:platform,refTimer:function refTimer(e){"object"==typeof e&&"function"==typeof e.ref?e.ref():"number"==typeof e&&j&&Deno.refTimer(e)},unrefTimer:unrefTimer});function asyncTask(){let e,t;const r=new Promise(((r,n)=>{e=r,t=n}));return Object.assign(r,{resolve:e,reject:t})}function abortable(e,t){return"function"==typeof e[Symbol.asyncIterator]&&"function"!=typeof e.then?async function*abortableAsyncIterable(e,t){if(t.aborted)throw t.reason;const r=asyncTask(),handleAbort=()=>r.reject(t.reason);t.addEventListener("abort",handleAbort,{once:!0});const n=e[Symbol.asyncIterator]();for(;;){const e=Promise.race([n.next(),r]);e.catch((()=>{t.removeEventListener("abort",handleAbort)}));const{done:o,value:i}=await e;if(o)return t.removeEventListener("abort",handleAbort),i;yield i}}(e,t):select([e],t)}function createTimeoutError(e){return new TimeoutError(`Operation timeout after ${e}ms`)}async function timeout(e,t){return await Promise.race([e,new Promise(((e,r)=>unrefTimer(setTimeout((()=>{r(createTimeoutError(t))}),t))))])}async function pace(e,t){const[r]=await Promise.allSettled([e,new Promise((e=>setTimeout(e,t)))]);if("fulfilled"===r.status)return r.value;throw r.reason}const G=pace;async function sleep(e){return new Promise((t=>setTimeout(t,e)))}async function until(e){return new Promise((t=>{let r=!1;const n=setInterval((async()=>{if(!r)try{r=!0;const o=await e();!1!==o&&null!=o&&(clearInterval(n),t(o))}catch(e){}finally{r=!1}}),1)}))}async function select(e,t=void 0){if(null==t?void 0:t.aborted)throw t.reason;t&&(e=[...e,new Promise(((e,r)=>{t.addEventListener("abort",(()=>{r(t.reason)}),{once:!0})}))]);const r=new Map,n=await Promise.race(e.map(((e,t)=>{if("function"==typeof e){const n=new AbortController;r.set(t,n),e=e(n.signal)}return Promise.resolve(e).then((e=>({index:t,value:e}))).catch((e=>({index:t,reason:e})))})));for(const[e,t]of r)e!==n.index&&(t.signal.aborted||t.abort());if("reason"in n)throw n.reason;return n.value}function abortWith(e,t=void 0){let r,n;if(e instanceof AbortSignal?(r=e,n=null==t?void 0:t.timeout):e&&(r=e.parent,n=e.timeout),!r&&!n)throw new TypeError("Must provide a parent signal or a timeout value, or both.");const o=new AbortController,{signal:i}=o;if(r){if(r.aborted)return o.abort(r.reason),o;const abort=()=>{i.aborted||o.abort(r.reason)};r.addEventListener("abort",abort,{once:!0}),i.addEventListener("abort",(()=>{r.aborted||r.removeEventListener("abort",abort)}))}if(n){const e=setTimeout((()=>{i.aborted||o.abort(createTimeoutError(n))}),n);unrefTimer(e),i.addEventListener("abort",(()=>{clearTimeout(e)}),{once:!0})}return o}var J=Object.freeze({__proto__:null,abortWith:abortWith,abortable:abortable,after:G,asyncTask:asyncTask,pace:pace,select:select,sleep:sleep,timeout:timeout,until:until});Promise.timeout=timeout,Promise.after=G,Promise.pace=pace,Promise.sleep=sleep,Promise.until=until,Promise.select=select;const Q=Symbol("inverse");class BiMap extends Map{get[Symbol.toStringTag](){return"BiMap"}constructor(e=null){if(super(),this[Q]=new Map,e)for(const[t,r]of e)this.set(t,r)}set(e,t){return super.set(e,t),this[Q].set(t,e),this}getKey(e){return this[Q].get(e)}hasValue(e){return this[Q].has(e)}deleteValue(e){if(this[Q].has(e)){const t=this[Q].get(e);return super.delete(t),this[Q].delete(e),!0}return!1}clear(){super.clear(),this[Q].clear()}}class CiMap extends Map{get[Symbol.toStringTag](){return"CiMap"}constructor(e=null){if(super(),e)for(const[t,r]of e)this.set(t,r)}set(e,t){const r=String(e).toLowerCase();return super.set(r,{key:e,value:t}),this}get(e){var t;const r=String(e).toLowerCase();return null===(t=super.get(r))||void 0===t?void 0:t.value}has(e){const t=String(e).toLowerCase();return super.has(t)}delete(e){const t=String(e).toLowerCase();return super.delete(t)}*entries(){for(const{key:e,value:t}of super.values())yield[e,t]}*keys(){for(const{key:e}of super.values())yield e}*values(){for(const{value:e}of super.values())yield e}forEach(e,t){super.forEach((({key:t,value:r})=>{e(r,t,this)}),t)}[Symbol.iterator](){return this.entries()}}var Y=Object.freeze({__proto__:null,BiMap:BiMap,CiMap:CiMap});globalThis.BiMap=BiMap,globalThis.CiMap=CiMap,globalThis.Exception=L,globalThis.NotAllowedError=NotAllowedError,globalThis.NotFoundError=NotFoundError,globalThis.AlreadyExistsError=AlreadyExistsError,globalThis.NotSupportedError=I,globalThis.NotImplementedError=NotImplementedError,globalThis.TimeoutError=TimeoutError,globalThis.NetworkError=NetworkError,Error.toObject=toObject,Error.fromObject=fromObject,Error.toErrorEvent=toErrorEvent,Error.fromErrorEvent=fromErrorEvent,Error.prototype.toJSON=function toJSON(){return toObject(this)},Error.prototype.isCausedBy=function isCausedBy$1(e){return isCausedBy(this,e)};const X=new Map;function parseAs(e,t){return as(JSON.parse(e),t)}function as(e,t){if(null==e)return null;if("function"==typeof t.fromJSON)return t.fromJSON(e);if("boolean"==typeof e)return t===Boolean?e:null;if("number"==typeof e){if(t===Number)return e;if(t!==BigInt)return null;try{return BigInt(e)}catch(e){return null}}else if("string"==typeof e){if(t===String)return e;if(t===Date){const t=new Date(e);return isValid(t)?t:null}if(t!==BigInt)return null;try{return BigInt(e)}catch(e){return null}}else if(Array.isArray(e)){if(t===Array)return e;if(t.prototype instanceof Array)return t.from(e);if("function"!=typeof t.prototype[Symbol.iterator]||"function"!=typeof t.from)return null;try{return t.from(e)}catch(e){return null}}else{if([String,Number,Boolean,Date,Array].includes(t))return null;{if("Buffer"===e.type&&Array.isArray(e.data))if("function"==typeof Buffer&&t===Buffer)try{return Buffer.from(e.data)}catch(e){return null}else{if("function"!=typeof t.prototype[Symbol.iterator]||"function"!=typeof t.from)return null;try{return t.from(e.data)}catch(e){return null}}else if("ByteArray"===e.type&&Array.isArray(e.data))try{return bytes(e.data)}catch(e){return null}const r=Object.getOwnPropertyNames(e),n=Object.values(e);if(!r.slice(0,50).map(Number).every((e=>!Number.isNaN(e)))||!n.slice(0,50).map(Number).every((e=>!Number.isNaN(e)))||"function"!=typeof t.prototype[Symbol.iterator]||"function"!=typeof t.from){if(t.prototype instanceof Error){const r=fromObject(e);if(r){const n=X.get(t.prototype);if(n)for(const t of Reflect.ownKeys(e)){const o=n[t];o&&(r[t]=as(e[t],o))}}return r}{const r=Object.create(t.prototype),n=X.get(t.prototype);if(n)for(const t of Reflect.ownKeys(e)){const o=n[t];r[t]=o?as(e[t],o):e[t]}else Object.assign(r,e);return r}}try{return t.from(Object.values(e))}catch(e){return null}}}}function type(e){return(t,r)=>{const n=X.get(t);n?n[r]=e:X.set(t,{[r]:e})}}var Z=Object.freeze({__proto__:null,as:as,parseAs:parseAs,type:type});JSON.parseAs=parseAs,JSON.as=as,JSON.type=type;const ee=async function(){}.constructor,te=function*(){}.constructor,re=async function*(){}.constructor,ne=Object.getPrototypeOf(Uint8Array);var oe=Object.freeze({__proto__:null,AsyncFunction:ee,AsyncGeneratorFunction:re,GeneratorFunction:te,TypedArray:ne});function isIteratorLike(e){return"object"==typeof e&&null!==e&&"function"==typeof e.next}function isGenerator(e){return function isIterableIterator(e){return isIteratorLike(e)&&"function"==typeof e[Symbol.iterator]}(e)&&hasGeneratorSpecials(e)}function isAsyncGenerator$1(e){return function isAsyncIterableIterator(e){return isIteratorLike(e)&&"function"==typeof e[Symbol.asyncIterator]}(e)&&hasGeneratorSpecials(e)}function hasGeneratorSpecials(e){return"function"==typeof e.return&&"function"==typeof e.throw}globalThis.AsyncFunction=ee,globalThis.GeneratorFunction=te,globalThis.AsyncGeneratorFunction=re,globalThis.TypedArray=ne,Object.defineProperty(Symbol,"customInspect",{value:K}),Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")),Symbol.asyncIterator||Object.defineProperty(Symbol,"asyncIterator",{value:Symbol("Symbol.asyncIterator")});const ie=Symbol("GeneratorSource"),se=Symbol("GeneratorStatus"),ae=Symbol("GeneratorResult");class Thenable{constructor(e){this[ie]=e,this[se]="suspended",this[ae]=void 0}then(e,t){let r;return r=void 0===this[ie]||"closed"===this[se]?Promise.resolve(this[ae]):"erred"===this[se]?Promise.reject(this[ie]):"function"==typeof this[ie].then?Promise.resolve(this[ie]):"function"==typeof this[ie].next?function processIterator(e){return new Promise(((t,r)=>{function fulfilled(t){try{step(e.next(t))}catch(e){r(e)}}function rejected(t){var n;try{step(null===(n=e.throw)||void 0===n?void 0:n.call(e,t))}catch(e){r(e)}}function step(e){Promise.resolve(e).then((e=>{e.done?t(e.value):new Promise((t=>{t(e.value)})).then(fulfilled,rejected)}))}step(e.next())}))}(this[ie]):Promise.resolve(this[ie]),this[se]="closed",r.then((e=>this[ae]=e)).then(e,t)}catch(e){return Promise.resolve(this).then(null,e)}}class ThenableGenerator extends Thenable{next(...e){const t=e[0];let r;if(void 0===this[ie]||"closed"===this[se])r={value:void 0,done:!0};else{if("erred"===this[se])return this.throw(this[ie]);r="function"==typeof this[ie].next?this[ie].next(t):{value:this[ie],done:!0}}return!0===r.done&&(this[se]="closed",this[ae]=r.value),r}return(e){return this[se]="closed",this[ae]=e,this[ie]&&"function"==typeof this[ie].return?this[ie].return(e):{value:e,done:!0}}throw(e){if(this[se]="closed",this[ie]&&"function"==typeof this[ie].throw)return this[ie].throw(e);throw e}[Symbol.iterator](){return this}}class ThenableAsyncGenerator extends Thenable{next(...e){const t=e[0];let r;return r=void 0===this[ie]||"closed"===this[se]?Promise.resolve({value:void 0,done:!0}):"function"==typeof this[ie].next?Promise.resolve(this[ie].next(t)):Promise.resolve(this[ie]).then((e=>({value:e,done:!0}))),r.then((e=>(!0===e.done&&(this[se]="closed",this[ae]=e.value),e)))}return(e){return this[se]="closed",Promise.resolve(e).then((e=>(this[ae]=e,this[ie]&&"function"==typeof this[ie].return?Promise.resolve(this[ie].return(e)):Promise.resolve({value:e,done:!0}))))}throw(e){return this[se]="closed",this[ie]&&"function"==typeof this[ie].throw?Promise.resolve(this[ie].throw(e)):Promise.reject(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}const ThenableGeneratorFunction=function(e){if(!(this instanceof ThenableGeneratorFunction))return new ThenableGeneratorFunction(e);function anonymous(...t){try{const r=e.apply(this,t);return"function"==typeof r.then||function isAsyncGenerator(e){return null!==e&&"object"==typeof e&&"function"==typeof e.next&&"function"==typeof e.return&&"function"==typeof e.throw&&"function"==typeof e[Symbol.asyncIterator]}(r)?new ThenableAsyncGenerator(r):new ThenableGenerator(r)}catch(e){return Object.assign(new ThenableGenerator(e),{[se]:"erred"})}}return anonymous.prototype=ThenableGeneratorFunction,anonymous.__proto__=this,anonymous};function _try(e,...t){if("function"==typeof e)try{return _try(e.apply(void 0,t))}catch(e){return[e=e instanceof Error?e:new Error(String(e)),void 0]}let r=e;return r instanceof ThenableAsyncGenerator?Promise.resolve(r).then((e=>[null,e])).catch((e=>[e=e instanceof Error?e:new Error(String(e)),void 0])):isAsyncGenerator$1(r)?async function*(){let e,t;for(;;)try{const{done:n,value:o}=await r.next(e);if(n){t=o;break}e=yield Promise.resolve([null,o])}catch(e){e=e instanceof Error?e:new Error(String(e)),yield Promise.resolve([e,void 0]);break}return[null,t]}():isGenerator(r)?function*(){let e,t;for(;;)try{const{done:n,value:o}=r.next(e);if(n){t=o;break}e=yield[null,o]}catch(e){e=e instanceof Error?e:new Error(String(e)),yield[e,void 0];break}return[null,t]}():"function"==typeof(null==r?void 0:r.then)?Promise.resolve(r).then((e=>[null,e])).catch((e=>[e=e instanceof Error?e:new Error(String(e)),void 0])):[null,r]}Object.setPrototypeOf(ThenableGeneratorFunction,Function),Object.setPrototypeOf(ThenableGeneratorFunction.prototype,Function.prototype),ThenableGeneratorFunction.create=function create(e){return new ThenableGeneratorFunction(e)};const le=Symbol("uninitialized");function wrap(e,t){const wrapped=function(...r){return t.call(this,e,...r)};return Object.defineProperty(wrapped,"name",Object.getOwnPropertyDescriptor(e,"name")),Object.defineProperty(wrapped,"length",Object.getOwnPropertyDescriptor(e,"length")),Object.defineProperty(wrapped,"toString",{configurable:!0,enumerable:!1,writable:!0,value:e.toString.bind(e)}),wrapped}function mergeIfNotExists(e,t,r=!1){const n=Reflect.ownKeys(t);for(const o of n)"constructor"!==o&&(r?o in e||setProp(e,t,o):Object.prototype.hasOwnProperty.call(e,o)||setProp(e,t,o));return e}function mergeHierarchy(e,t,r=!1){mergeIfNotExists(e.prototype,t.prototype,r);const n=Object.getPrototypeOf(t);n.name&&mergeHierarchy(e,n,!0)}function setProp(e,t,r){const n=Object.getOwnPropertyDescriptor(t,r);n?Object.defineProperty(e,r,n):e[r]=t[r]}const ce=new Map;const ue=new Map;var de;void 0===Symbol.dispose&&Object.defineProperty(Symbol,"dispose",{value:Symbol("Symbol.dispose")});const fe=serial(!0);class Channel{constructor(e=0){if(this[de]=fe.next().value,this.buffer=[],this.producers=[],this.consumers=[],this.error=null,this.state=1,e<0)throw new RangeError("the capacity of a channel must not be negative");this.capacity=e}send(e){if(1!==this.state)throw new TypeError("the channel is closed");if(this.consumers.length){const t=this.consumers.shift();return Promise.resolve(t(null,e))}return this.capacity&&this.buffer.length<this.capacity?(this.buffer.push(e),Promise.resolve(void 0)):new Promise((t=>{this.producers.push((()=>{if(this.capacity){const r=this.buffer.shift();return this.buffer.push(e),t(),r}return t(),e}))}))}recv(){if(this.buffer.length){const e=this.buffer.shift();return 2!==this.state||this.buffer.length||(this.state=0),Promise.resolve(e)}if(this.producers.length){const e=this.producers.shift();return 2!==this.state||this.producers.length||(this.state=0),Promise.resolve(e())}if(0===this.state)return Promise.resolve(void 0);if(this.error){const{error:e}=this;return this.state=0,this.error=null,Promise.reject(e)}return 2===this.state?(this.state=0,Promise.resolve(void 0)):new Promise(((e,t)=>{this.consumers.push(((r,n)=>{2!==this.state||this.consumers.length||(this.state=0),r?t(r):e(n)}))}))}close(e=null){if(1!==this.state)return;let t;for(this.state=2,this.error=e;t=this.consumers.shift();)t(e,void 0)}[(de=x,Symbol.asyncIterator)](){const e=this;return{async next(){const t=e.buffer.length,r=e.producers.length;return{value:await e.recv(),done:0===e.state&&!t&&!r}}}}[Symbol.dispose](){this.close()}}function chan(e=0){return new Channel(e)}class Queue{constructor(e,t=0){this.channel=chan(t),(async()=>{var t;for await(const r of this.channel)try{await e.call(void 0,r)}catch(e){null===(t=this.errorHandler)||void 0===t||t.call(this,e)}})().catch((e=>{var t;null===(t=this.errorHandler)||void 0===t||t.call(void 0,e)}))}push(e){return this.channel.send(e)}close(){var e;null===(e=this.channel)||void 0===e||e.close()}onError(e){this.errorHandler=e}[Symbol.dispose](){this.close()}}var pe;void 0===Symbol.dispose&&Object.defineProperty(Symbol,"dispose",{value:Symbol("Symbol.dispose")});const he=Symbol.for("queue"),me=Symbol.for("value"),ye=Symbol.for("mutex"),we=Symbol.for("unlocked");class Mutex{constructor(e){this[pe]=[],this[me]=e}async lock(){await new Promise((e=>{this[he].length?this[he].push(e):(this[he].push(e),e())}));const e=Object.create(Mutex.Lock.prototype);return e[ye]=this,e}}pe=he,function(e){var t;class Lock{constructor(e){this[t]=!1,this[ye]=e}checkState(){if(this[we])throw new ReferenceError("Trying to access data after unlocked.")}get value(){return this.checkState(),this[ye][me]}set value(e){this.checkState(),this[ye][me]=e}unlock(){this[we]=!0;const e=this[ye][he];e.shift();const t=e[0];t?t():ve.hasValue(this[ye])&&ve.deleteValue(this[ye])}[(t=we,Symbol.dispose)](){this.unlock()}}e.Lock=Lock}(Mutex||(Mutex={}));const ve=new BiMap;function isNotQuery(e){return"?"!==e[0]&&"#"!==e[0]}function isVolume(e,t=!1){return t?/^[a-zA-Z]:$/.test(e):/^[a-zA-Z]:(\\)?$/.test(e)}function isWindowsPath(e){return/^[a-zA-Z]:/.test(e)&&"://"!==e.slice(1,4)}function isPosixPath(e){return/^\//.test(e)}function isFsPath(e){return/^(\.[\/\\]|\.\.[\/\\]|[a-zA-Z]:|\/)/.test(e)}function isUrl(e){return/^[a-z](([a-z\-]+)?:\/\/\S+|[a-z\-]+:\/\/$)/i.test(e)||isFileUrl(e)}function isFileUrl(e){return"string"==typeof e?/^file:((\/\/|\/)\S+|\/?$)/i.test(e):"file:"===e.protocol}function isAbsolute(e){return isPosixPath(e)||isWindowsPath(e)||isUrl(e)}function split(e){if(e){if(isUrl(e)){const{protocol:t,host:r,pathname:n,search:o,hash:i}=new URL(e);let s=t+"//"+r;if("file:"!==t||r||(s+="/"),"/"===n)return o&&i?[s,o,i]:o?[s,o]:i?[s,i]:[s];{const e=trim(decodeURI(n),"/").split(/[/\\]+/);return o&&i?[s,...e,o,i]:o?[s,...e,o]:i?[s,...e,i]:[s,...e]}}if(isWindowsPath(e)){const[t,r,...n]=split("file:///"+e.replace(/[/\\]+/g,"/"));return[r+"\\",...n]}if(isPosixPath(e)){const[t,...r]=split("file://"+e.replace(/[/\\]+/g,"/"));return["/",...r]}{e=e.replace(/[/\\]+/g,"/");const[t,r]=e.split("?");if(r){const e=t?trimEnd(t,"/").split("/"):[],[n,o]=r.split("#");return o?[...e,"?"+n,"#"+o]:[...e,"?"+n]}{const[t,r]=e.split("#"),n=t?trimEnd(t,"/").split("/"):[];return r?[...n,"#"+r]:n}}}return[]}function stripFileProtocol(e){return e.replace(/^file:\/\/(localhost)?\/?([a-z]:)/i,"$2").replace(/^file:\/?([a-z]:)/i,"$1").replace(/^file:\/\/(localhost)?\//i,"/").replace(/^file:\//i,"/")}function extractSegmentsForComparison(e,t,r={}){r.caseInsensitive&&(e=e.toLowerCase(),t=t.toLowerCase()),r.ignoreFileProtocol&&(e=stripFileProtocol(e),t=stripFileProtocol(t));const n=split(e).filter(isNotQuery),o=split(t).filter(isNotQuery);return n.length<o.length?{result:!1,paths:[],subs:[]}:(r.caseInsensitive||(n.forEach(((e,t)=>{isVolume(e)&&(n[t]=e.toLowerCase())})),o.forEach(((e,t)=>{isVolume(e)&&(o[t]=e.toLowerCase())}))),o.length?{result:void 0,paths:n,subs:o}:{result:!0,paths:n,subs:o})}function startsWith(e,t,r={}){const{result:n,paths:o,subs:i}=extractSegmentsForComparison(e,t,r);return void 0!==n?n:startsWith$1(o,i)}function endsWith(e,t,r={}){const{result:n,paths:o,subs:i}=extractSegmentsForComparison(e,t,r);return void 0!==n?n:endsWith$1(o,i)}function equals(e,t,r={}){const{result:n,paths:o,subs:i}=extractSegmentsForComparison(e,t,r);return!1!==n&&o.length===i.length&&equals$2(o,i)}const ge=(()=>{if(j){if("windows"===Deno.build.os)return"\\"}else if(P&&"win32"===process.platform)return"\\";return"/"})();function cwd(){if(j)return Deno.cwd();if(P)return process.cwd();if("object"==typeof location&&location.origin)return location.origin+("/"===location.pathname?"":location.pathname);throw new I("Unable to determine the current working directory.")}function join(...e){let t=[];for(let r=0;r<e.length;r++){const n=e[r];n&&(isAbsolute(n)&&(t=[]),t.push(n))}const r=[];for(let e=0;e<t.length;e++){let n=t[e];for(const e of split(n))".."===e?!r.length||r.every((e=>".."===e))?r.push(".."):(r.length>2||2===r.length&&!isAbsolute(r[1])||1===r.length&&!isAbsolute(r[0]))&&r.pop():e&&"."!==e&&r.push(e)}if(!r.length)return".";const n=r[0],o=isUrl(n)||isPosixPath(n)?"/":isWindowsPath(n)?"\\":ge;let i="";for(let e=0;e<r.length;e++){const t=r[e];i&&"?"!==t[0]&&"#"!==t[0]?isVolume(t)?i?i+=t+"/":i=t:i+=(i.endsWith(o)?"":o)+trim(t,"/\\"):i+=t}return/^file:\/\/\/[a-z]:$/i.test(i)?i+"/":i}function resolve(...e){e=e.filter((e=>""!==e));const t=cwd();return e.length?(e=isAbsolute(e[0])?e:[t,...e],join(...e)):t}function dirname(e){if(isUrl(e)){const{protocol:t,host:r,pathname:n}=new URL(e),o=t+"//"+r,i=dirname(decodeURI(n));return"/"===i?"file:"!==t||r?o:o+"/":o+i}{const t=split(e).filter(isNotQuery),r=t.pop();return t.length?join(...t):"/"===r?"/":isVolume(r,!0)?r+"\\":isVolume(r)?r:"."}}function basename(e,t=""){if(isUrl(e)){const{pathname:r}=new URL(e);return basename(decodeURI(r),t)}{const r=split(e).filter(isNotQuery).pop();return!r||"/"===r||isVolume(r)?"":t?stripEnd(r,t):r}}function extname(e){const t=basename(e),r=t.lastIndexOf(".");return-1===r?"":t.slice(r)}function toFileUrl(e){if(isFileUrl(e))return e;if(isUrl(e))throw new I("Cannot convert a URL to a file URL.");{let t=resolve(e).replace(/\\/g,"/");return t="/"===t[0]?t:"/"+t,new URL("file://"+t).href}}function toFsPath(e){if("object"==typeof e){if("file:"===e.protocol)return join(fileUrlToFsPath(e.toString()));throwNonFileUrlConversionError()}return isFsPath(e)?e:isFileUrl(e)?join(fileUrlToFsPath(e)):isUrl(e)?void throwNonFileUrlConversionError():resolve(e)}function fileUrlToFsPath(e){return e.replace(/^file:(\/\/)?/i,"").replace(/^\/([a-z]):/i,"$1:")}function throwNonFileUrlConversionError(){throw new I("Cannot convert a non-file URL to a file system path.")}var be=Object.freeze({__proto__:null,basename:basename,contains:function contains(e,t,r={}){const{result:n,paths:o,subs:i}=extractSegmentsForComparison(e,t,r);return void 0!==n?n:includesSlice(o,i)},cwd:cwd,dirname:dirname,endsWith:endsWith,equals:equals,extname:extname,isAbsolute:isAbsolute,isFileUrl:isFileUrl,isFsPath:isFsPath,isPosixPath:isPosixPath,isUrl:isUrl,isWindowsPath:isWindowsPath,join:join,normalize:function normalize(e){return join(e)},resolve:resolve,sanitize:function sanitize(e){return join(...split(e).filter(isNotQuery))},sep:ge,split:split,startsWith:startsWith,toFileUrl:toFileUrl,toFsPath:toFsPath});const Ee={"public.item":["*/*"],"public.movie":["video/*"],"public.audio":["audio/*"],"public.image":["image/*"],"public.text":["text/*"],"public.plain-text":[".txt","text/plain"],"public.rtf":[".rtf","text/rtf"],"public.html":[".html",".htm","text/html"],"public.xml":[".xml","text/xml"],"public.css":[".css","text/css"],"public.json":[".json","application/json"],"public.yaml":[".yaml",".yml","application/yaml","application/x-yaml"],"public.toml":[".toml","application/toml"],"public.ini":[".ini","text/ini"],"public.comma-separated-values-text":[".csv","text/csv"],"public.c-source":[".c","text/x-csrc"],"public.objective-c-source":[".m","text/x-objcsrc"],"public.c-plus-plus-source":[".cpp",".cc",".cp",".c++",".cxx","text/x-c++src"],"public.objective-c-plus-plus-source":[".mm","text/x-objcppsrc"],"public.c-header":[".h","text/x-chdr"],"public.c-plus-plus-header":[".hpp",".hh",".h++",".hxx","text/x-c++hdr"],"public.assembly-source":[".s",".S","text/x-asm"],"com.apple.rez-source":[".r","text/x-rez"],"public.mig-source":[".defs","text/x-mig"],"com.apple.symbol-export":[".exp","text/x-export"],"com.netscape.javascript-source":[".js",".mjs",".cjs","text/javascript","application/javascript"],"public.shell-script":[".sh",".command",".bat",".cmd",".ps1","text/x-shellscript"],"public.csh-script":[".csh","text/x-csh"],"public.perl-script":[".pl",".pm","application/perl","text/x-perl","text/x-perl-script"],"public.python-script":[".py",".pyc","application/python","text/x-python","text/x-python-script"],"public.ruby-script":[".rb","application/ruby","text/ruby","text/x-ruby-script"],"public.php-script":[".php",".php3",".php4",".php5",".phtml","application/php","text/php","text/x-php-script"],"com.apple.applescript.text":[".applescript"],"com.apple.applescript.script":[".scpt"],"public.object-code":[".o"],"com.microsoft.windows-executable":[".exe",".com",".msi","application/vnd.microsoft.portable-executable"],"com.microsoft.windows-dynamic-link-library":[".dll",".ocx","application/x-msdownload"],"com.sun.java-source":[".java",".jav","text/x-java-source"],"com.sun.java-class":[".class"],"com.sun.java-archive":[".jar","application/java-archive"],"com.sun.java-properties":[".properties","text/x-java-properties"],"com.sun.java-keystore":[".jks","application/x-java-keystore"],"com.sun.java-web-start":[".jnlp","application/jnlp"],"com.apple.quartz-composer-composition":[".qtz","application/x-quartzcomposer"],"org.gnu.gnu-tar-archive":[".gtar","application/x-gtar"],"public.tar-archive":[".tar","application/x-tar","application/tar"],"org.gnu.gnu-zip-archive":[".gz",".gzip","application/gzip","application/x-gzip"],"org.gnu.gnu-zip-tar-archive":[".tgz","application/x-tar-gz","application/x-gzip-compressed-tar"],"public.bzip2-archive":[".bz2","application/x-bzip2"],"public.tar-bzip2-archive":[".tbz",".tbz2","application/x-bzip2-compressed-tar"],"com.apple.xar-archive":[".xar","application/x-xar"],"com.apple.binhex-archive":[".hqx","application/mac-binhex40","application/binhex"],"com.apple.macbinary-archive":[".bin","application/x-macbinary","application/macbinary"],"public.vcard":[".vcf","text/vcard"],"public.jpeg":[".jpg",".jpeg","image/jpeg"],"public.jpeg-2000":[".jp2","image/jp2"],"public.tiff":[".tiff",".tif","image/tiff"],"com.apple.pict":[".pct","image/pict"],"com.apple.macpaint-image":[".pntg","image/x-macpaint"],"public.png":[".png","image/png"],"public.xbitmap-image":[".xbm","image/x-xbitmap"],"com.apple.quicktime-image":[".qtif","image/x-quicktime"],"com.apple.icns":[".icns","image/icns"],"com.apple.quicktime-movie":[".mov",".qt","video/quicktime"],"public.avi":[".avi","video/x-msvideo"],"public.mpeg":[".mpg",".mpeg","video/mpeg"],"public.mpeg-4":[".mp4","video/mp4"],"public.3gpp":[".3gp","video/3gpp"],"public.3gpp2":[".3g2","video/3gpp2"],"public.mp3":[".mp3","audio/mpeg","audio/mp3"],"public.mpeg-4-audio":[".m4a","audio/x-m4a"],"com.apple.protected-mpeg-4-audio":[".m4p","audio/mp4","audio/x-m4p"],"public.ulaw-audio":[".au","audio/basic"],"public.aifc-audio":[".aifc","audio/x-aifc"],"public.aiff-audio":[".aiff",".aif","audio/aiff"],"com.apple.coreaudio-format":[".caf","audio/x-caf"],"com.apple.bundle":[".bundle"],"com.apple.application-bundle":[".app"],"com.apple.plugin":[".plugin"],"com.apple.metadata-importer":[".mdimporter"],"com.apple.dashboard-widget":[".wdgt"],"public.cpio-archive":[".cpio","application/x-cpio"],"public.zip-archive":[".zip","application/zip"],"com.apple.framework":[".framework"],"com.apple.rtfd":[".rtfd","application/rtfd"],"public.opentype-font":[".otf","application/x-font-opentype"],"public.truetype-ttf-font":[".ttf","application/x-font-truetype"],"public.truetype-collection-font":[".ttc","application/x-font-ttf"],"com.apple.font-suitcase":[".dfont","application/x-font-suitcase"],"com.adobe.postscript.pfa-font":[".pfa","application/x-font-type1"],"com.adobe.postscript-pfb-font":[".pfb","application/x-font-type2"],"com.apple.colorsync-profile":[".icc",".icm","application/vnd.iccprofile"],"com.adobe.pdf":[".pdf","application/pdf"],"com.adobe.postscript":[".ps","application/postscript"],"com.adobe.encapsulated-postscript":[".eps","application/x-eps"],"com.adobe.photoshop-image":[".psd","image/vnd.adobe.photoshop","image/psd"],"com.adobe.illustrator.ai-image":[".ai","application/illustrator","application/vnd.adobe.illustrator"],"com.compuserve.gif":[".gif","image/gif"],"com.microsoft.bmp":[".bmp","image/bmp"],"com.microsoft.ico":[".ico","image/x-icon"],"com.microsoft.word.doc":[".doc","application/msword"],"com.microsoft.excel.xls":[".xls","application/vnd.ms-excel"],"com.microsoft.powerpoint.ppt":[".ppt","application/vnd.ms-powerpoint"],"org.openxmlformats.spreadsheetml.sheet":[".xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],"org.openxmlformats.presentationml.presentation":[".pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],"org.openxmlformats.wordprocessingml.document":[".docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],"com.microsoft.waveform-audio":[".wav","audio/wav"],"com.microsoft.advanced-systems-format":[".asf","video/x-ms-asf"],"com.microsoft.windows-media-wm":[".wm","video/x-ms-wm"],"com.microsoft.windows-media-wmv":[".wmv","video/x-ms-wmv"],"com.microsoft.windows-media-wmp":[".wmp","video/x-ms-wmp"],"com.microsoft.windows-media-wma":[".wma","audio/x-ms-wma"],"com.microsoft.advanced-stream-redirector":[".asx","video/x-ms-asx"],"com.microsoft.windows-media-wmx":[".wmx","video/x-ms-wmx"],"com.microsoft.windows-media-wvx":[".wvx","video/x-ms-wvx"],"com.microsoft.windows-media-wax":[".wax","audio/x-ms-wax"],"com.apple.iwork.pages.sffpages":[".pages","application/x-iwork-pages-sffpages"],"com.apple.iwork.numbers.sffnumbers":[".numbers","application/x-iwork-numbers-sffnumbers"],"com.apple.iwork.keynote.sffkey":[".key","application/x-iwork-keynote-sffkey"],"com.truevision.tga-image":[".tga","image/x-tga"],"com.sgi.sgi-image":[".sgi","image/sgi"],"com.sgi.rgb-image":[".rgb","image/x-rgb"],"com.ilm.openexr-image":[".exr","image/x-exr"],"com.kodak.flashpix.image":[".fpx",".fpix","image/vnd.fpx"],"com.j2.jfx-fax":[".jfx","image/jfax"],"com.js.efx-fax":[".efx","image/efax"],"com.digidesign.sd2-audio":[".sd2","audio/x-sd2"],"com.real.realmedia":[".rm","application/vnd.rn-realmedia"],"com.real.realmedia-vbr":[".rv",".rmvb","application/vnd.rn-realmedia-vbr"],"com.real.realaudio":[".ra","audio/vnd.rn-realaudio"],"com.real.smil":[".smil","application/smil"],"com.allume.stuffit-archive":[".sit","application/x-stuffit"],"org.opml.opml":[".opml","text/x-opml"],"net.daringfireball.markdown":[".md","text/markdown"],"vnd.sqlite3":[".sqlite3",".sqlite",".db","application/x-sqlite3"],"public.iso-image":[".iso","application/x-iso-image"],"com.apple.disk-image":[".dmg",".smi",".img","application/x-apple-diskimage"],"public.heic":[".heic",".heif","image/heic"],"com.apple.installer-package-archive":[".pkg","application/x-apple-installer-package"],"public.mpeg-2-transport-stream":[".ts","video/mp2t","application/typescript","text/typescript"],"public.x509-certificate":[".cer",".crt",".der",".pem","application/x-x509-ca-cert"],"com.microsoft.cab-archive":[".cab","application/vnd.ms-cab-compressed"],"public.xz-archive":[".xz","application/x-xz"],"public.7z-archive":[".7z","application/x-7z-compressed"],"com.rarlab.rar-archive":[".rar","application/x-rar-compressed"],"public.rpm-archive":[".rpm","application/x-rpm"],"public.deb-archive":[".deb","application/vnd.debian.binary-package"],"public.ar-archive":[".ar","application/x-unix-archive"],"public.wasm-executable":[".wasm","application/wasm"],"public.svg-image":[".svg","image/svg+xml"],"public.webp":[".webp","image/webp"],"public.avif":[".avif","image/avif"],"public.pkcs8":[".p8",".pkcs8","application/pkcs8"],"public.pkcs10":[".p10",".pkcs10","application/pkcs10"],"public.x-pkcs12":[".p12",".pfx","application/x-pkcs12"],"public.systemd-swap-unit":[".swap","application/systemd-swap"],"public.systemd-service-unit":[".service","application/systemd-service"],"public.systemd-socket-unit":[".socket","application/systemd-socket"],"public.webmanifest":[".webmanifest","application/manifest+json"],"com.apple.xcode.project":[".xcodeproj","application/x-xcodeproj"]};function getUTI(e){if((e=e.toLowerCase()).startsWith("*.")&&(e=e.slice(1)),e)for(const[t,r]of Object.entries(Ee))if(t===e||r.includes(e))return t}function getMIME(e){if((e=e.toLowerCase()).startsWith("*.")&&(e=e.slice(1)),e){if(e.includes("/"))return e;if("."!==e[0]){const t=Ee[e]||null;return t?t.find((e=>e.includes("/"))):void 0}for(const t of Object.values(Ee))if(t.includes(e)){const e=t.find((e=>e.includes("/")));if(e)return e}}}function getExtensions(e){if((e=e.toLowerCase()).startsWith("*.")&&(e=e.slice(1)),!e)return[];if("."===e[0])return[e];if("."!==e[0]&&!e.includes("/")){const t=Ee[e]||null;return t?t.filter((e=>"."===e[0])):[]}if(e.endsWith("/*")){const t=e.slice(0,-1);return Object.values(Ee).filter((r=>r.some((r=>r!==e&&r.startsWith(t))))).map((e=>e.filter((e=>"."===e[0])))).flat()}for(const t of Object.values(Ee))if(t.includes(e))return t.filter((e=>e.startsWith(".")));return[]}var Se=Object.freeze({__proto__:null,getExtensions:getExtensions,getMIME:getMIME,getUTI:getUTI});class InvalidOperationError extends L{constructor(e,t={}){super(e,{...t,name:"InvalidOperationError",code:400})}}registerErrorType(InvalidOperationError);class IsDirectoryError extends L{constructor(e,t={}){super(e,{...t,name:"IsDirectoryError",code:400})}}registerErrorType(IsDirectoryError);class NotDirectoryError extends L{constructor(e,t={}){super(e,{...t,name:"NotDirectoryError",code:400})}}registerErrorType(NotDirectoryError);class FileTooLargeError extends L{constructor(e,t={}){super(e,{...t,name:"FileTooLargeError",code:413})}}registerErrorType(FileTooLargeError);class FilesystemLoopError extends L{constructor(e,t={}){super(e,{...t,name:"FilesystemLoopError",code:508})}}registerErrorType(FilesystemLoopError);class BusyError extends L{constructor(e,t={}){super(e,{...t,name:"BusyError",code:423})}}registerErrorType(BusyError);class InterruptedError extends L{constructor(e,t={}){super(e,{...t,name:"InterruptedError",code:500})}}function ensureFsTarget(e){if(e instanceof URL){if("file:"!==e.protocol)throw new TypeError("Only file URLs are supported");return toFsPath(e.href)}return"string"==typeof e&&isFileUrl(e)?toFsPath(e):e}function wrapFsError(e,t=void 0){if(!(e instanceof Error)||e instanceof L||e instanceof TypeError)return e instanceof Error?e:new L("string"==typeof e?e:"Unknown error",{code:500,cause:e});{const r=function getErrorName(e){return e.constructor===Error?e.constructor.name:e.name}(e),n=e.code;return"NotFoundError"===r||"NotFound"===r||"ENOENT"===n||"ENOTFOUND"===n?new NotFoundError(e.message,{cause:e}):"NotAllowedError"===r||"PermissionDenied"===r||"InvalidStateError"===r||"SecurityError"===r||"EACCES"===r||"EPERM"===n||"ERR_ACCESS_DENIED"===n?new NotAllowedError(e.message,{cause:e}):"AlreadyExists"===r||"EEXIST"===n||"ERR_FS_CP_EEXIST"===n?new AlreadyExistsError(e.message,{cause:e}):"TypeMismatchError"===r&&"file"===t||"IsADirectory"===r||"EISDIR"===n||"ERR_FS_EISDIR"===n?new IsDirectoryError(e.message,{cause:e}):"TypeMismatchError"===r&&"directory"===t||"NotADirectory"===r||"ENOTDIR"===n?new NotDirectoryError(e.message,{cause:e}):"InvalidModificationError"===r||"NotSupported"===r||"ENOTEMPTY"===n||"ERR_FS_CP_EINVAL"===n||"ERR_FS_CP_FIFO_PIPE"===n||"ERR_FS_CP_DIR_TO_NON_DIR"===n||"ERR_FS_CP_NON_DIR_TO_DIR"===n||"ERR_FS_CP_SOCKET"===n||"ERR_FS_CP_SYMLINK_TO_SUBDIRECTORY"===n||"ERR_FS_CP_UNKNOWN"===n||"ERR_FS_INVALID_SYMLINK_TYPE"===n?new InvalidOperationError(e.message,{cause:e}):"NoModificationAllowedError"===r||"Busy"===r||"TimedOut"===r||"ERR_DIR_CONCURRENT_OPERATION"===n?new BusyError(r,{cause:e}):"Interrupted"===r||"ERR_DIR_CLOSED"===n?new InterruptedError(e.message,{cause:e}):"QuotaExceededError"===r||"ERR_FS_FILE_TOO_LARGE"===n?new FileTooLargeError(e.message,{cause:e}):"FilesystemLoop"===r?new FilesystemLoopError(e.message,{cause:e}):e}}function rawOp(e,t=void 0){return e.catch((e=>{throw wrapFsError(e,t)}))}function fixDirEntry(e){return Object.defineProperty(e,"path",{get:()=>e.relativePath}),e}function fixFileType(e){var t;if(!e.type){const r=extname(e.name);r&&Object.defineProperty(e,"type",{value:null!==(t=getMIME(r))&&void 0!==t?t:"",writable:!1,configurable:!0})}return e}function makeTree(e,t,r=!1){const n=t.map((e=>({...e,paths:split(e.relativePath)}))),o=function walk(e,t){e=[...orderBy(e.filter((e=>"directory"===e.kind)),(e=>e.name),"asc"),...orderBy(e.filter((e=>"file"===e.kind)),(e=>e.name),"asc")];const n=[];for(const o of e)if("directory"===o.kind){const e=o.paths,i=t.filter((t=>startsWith$1(t.paths,e))),s=i.filter((t=>t.paths.length===e.length+1));if(s.length){const e=i.filter((e=>!s.includes(e))),t={...omit(o,["paths"]),children:walk(s,e)};r&&fixDirEntry(t),n.push(t)}else{let e={...omit(o,["paths"]),children:[]};r&&fixDirEntry(e),n.push(e)}}else{const e={...omit(o,["paths"])};r&&fixDirEntry(e),n.push(e)}return n}(n.filter((e=>1===e.paths.length)),n.filter((e=>e.paths.length>1)));let i;"object"==typeof e?i=e.name||"(root)":e?(i=basename(e),i&&"."!==i||(i="(root)")):i="(root)";const s={name:i,kind:"directory",relativePath:"",children:o};return"object"==typeof e&&(s.handle=e),r&&fixDirEntry(s),s}async function resolveHomeDir(e){if("~"===e[0]&&(j||P)){e=(await import("node:os")).homedir()+e.slice(1)}return e}function isFunction(e){return"function"==typeof e}function resolveByteStream(e){let t;return new ReadableStream({type:"bytes",async start(){const r=await e;try{t=r.getReader({mode:"byob"})}catch(e){t=r.getReader()}},async pull(e){var r;try{let n,o,i;"byobRequest"in e&&(null===(r=e.byobRequest)||void 0===r?void 0:r.view)&&(n=e.byobRequest,o=n.view),t instanceof ReadableStreamBYOBReader?(null!=o||(o=new Uint8Array(4096)),i=await t.read(o)):i=await t.read(),n?i.done?(e.close(),void 0!==i.value?n.respondWithNewView(i.value):n.respond(0)):t instanceof ReadableStreamBYOBReader?n.respondWithNewView(i.value):e.enqueue(i.value):i.done?e.close():e.enqueue(i.value)}catch(r){t.releaseLock(),e.error(r)}},cancel(e=void 0){t.cancel(e),t.releaseLock()}})}function asAsyncIterable(e){if("function"==typeof e[Symbol.asyncIterator])return e;if("function"==typeof e[Symbol.iterator])return{[Symbol.asyncIterator]:async function*(){for(const t of e)yield t}};if("function"==typeof ReadableStream&&e instanceof ReadableStream){const t=e.getReader();return{[Symbol.asyncIterator]:async function*(){try{for(;;){const{done:e,value:r}=await t.read();if(e)break;yield r}}catch(e){t.cancel(e)}finally{t.releaseLock()}}}}return"function"==typeof e.then?async function*resolveAsyncIterable(e){const t=(await e).getReader();try{for(;;){const{done:e,value:r}=await t.read();if(e)break;yield r}}finally{t.releaseLock()}}(e):null}function toAsyncIterable(e,t=void 0){var r;const n=asAsyncIterable(e);if(n)return n;const o=chan(1/0),i=o.send.bind(o),s=o.close.bind(o),handleBrowserErrorEvent=e=>{let t;t="function"==typeof ErrorEvent&&e instanceof ErrorEvent?e.error||fromErrorEvent(e):new Error("something went wrong",{cause:e}),s(t)},a=Object.getPrototypeOf(e),l=Object.getOwnPropertyDescriptor(a,"onmessage");if((null==l?void 0:l.set)&&isFunction(e.close)){const n=Object.getOwnPropertyDescriptor(a,"onerror"),o=Object.getOwnPropertyDescriptor(a,"onclose");let c;if((null==t?void 0:t.event)&&"message"!==(null==t?void 0:t.event)&&isFunction(e.addEventListener)){const r=e,n=t.event,msgListener=e=>{i(e.data)};r.addEventListener(n,msgListener),c=()=>{r.removeEventListener(n,msgListener)}}else l.set.call(e,(e=>{i(e.data)})),c=()=>{var t;null===(t=l.set)||void 0===t||t.call(e,null)};if(null===(r=null==n?void 0:n.set)||void 0===r||r.call(e,handleBrowserErrorEvent),null==o?void 0:o.set)o.set.call(e,(()=>{var t,r;s(),null===(t=o.set)||void 0===t||t.call(e,null),null===(r=null==n?void 0:n.set)||void 0===r||r.call(e,null),null==c||c()}));else if(!(null==o?void 0:o.set)&&isFunction(e.close)){const t=e,r=t.close;Object.defineProperty(t,"close",{configurable:!0,writable:!0,value:function close(){var o;r.call(t),s(),Object.defineProperty(t,"close",{configurable:!0,writable:!0,value:r}),null===(o=null==n?void 0:n.set)||void 0===o||o.call(e,null),null==c||c()}})}}else if(isFunction(e.send)&&isFunction(e.close)){const t=e;if("function"==typeof t.addEventListener){const msgListener=e=>{i(e.data)};t.addEventListener("message",msgListener),t.addEventListener("error",handleBrowserErrorEvent),t.addEventListener("close",(()=>{s(),t.removeEventListener("message",msgListener),t.removeEventListener("error",handleBrowserErrorEvent)}))}else t.onmessage=e=>{i(e.data)},t.onerror=handleBrowserErrorEvent,t.onclose=()=>{s(),t.onclose=null,t.onerror=null,t.onmessage=null}}else if(isFunction(e.addEventListener)){const r=e,n=(null==t?void 0:t.message)||"message",o=(null==t?void 0:t.error)||"error",a=(null==t?void 0:t.close)||"close",msgListener=e=>{e instanceof MessageEvent&&i(e.data)};r.addEventListener(n,msgListener),r.addEventListener(o,handleBrowserErrorEvent),r.addEventListener(a,(function closeListener(){s(),r.removeEventListener(a,closeListener),r.removeEventListener(n,msgListener),r.removeEventListener(o,handleBrowserErrorEvent)}))}else{if(!isFunction(e.on))throw new TypeError("The source cannot be converted to an async iterable object.");{const r=e;let n,o,a;"object"==typeof process&&e===process?(n="message",o="uncaughtException",a="exit"):isFunction(e.send)&&isFunction(e.kill)||isFunction(e.postMessage)&&isFunction(e.terminate)||isFunction(e.postMessage)&&isFunction(e.close)?(n="message",o="error",a="exit"):(n=(null==t?void 0:t.data)||"data",o=(null==t?void 0:t.error)||"error",a=(null==t?void 0:t.close)||"close"),r.on(n,i),r.once(o,s),r.once(a,(()=>{s(),r.off(n,i),r.off(o,s)}))}}return{[Symbol.asyncIterator]:o[Symbol.asyncIterator].bind(o)}}function toReadableStream(e,t=void 0){if(e instanceof ReadableStream)return e;if("function"==typeof e.then)return function resolveReadableStream(e){const{readable:t,writable:r}=new TransformStream;return e.then((e=>e.pipeTo(r))),t}(e);const r=toAsyncIterable(e,t)[Symbol.asyncIterator]();return new ReadableStream({async pull(e){const{done:t,value:n}=await r.next();t?e.close():e.enqueue(n)},cancel(e=void 0){var t;null===(t=r.throw)||void 0===t||t.call(r,e)}})}async function readAsArray(e){const t=asAsyncIterable(e),r=[];for await(const e of t)r.push(e);return r}async function readAsArrayBuffer(e){if("function"==typeof Blob&&e instanceof Blob)return await e.arrayBuffer();if(ArrayBuffer.isView(e))return e.buffer;const t=asAsyncIterable(e);if(!t)throw new TypeError("The source is not an async iterable object.");return concat$2(...await readAsArray(t)).buffer}async function readAsObjectURL(e,t){if(e instanceof Blob)return URL.createObjectURL(e);if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)){const r=new Blob([e],{type:t});return URL.createObjectURL(r)}const r=await readAsArrayBuffer(e),n=new Blob([r],{type:t});return URL.createObjectURL(n)}async function readAsText(e,t=void 0){if("function"==typeof Blob&&e instanceof Blob&&!t)return await e.text();if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)||"function"==typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return new TextDecoder(t).decode(e);const r=await readAsArrayBuffer(e);return new TextDecoder(t).decode(r)}function concat(...e){if(!e[0])throw new TypeError("No sources provided.");if("function"==typeof ReadableStream&&e[0]instanceof ReadableStream){if(!e.every((e=>e instanceof ReadableStream)))throw new TypeError("All sources must be readable streams.");const t=e;let r=0,n=t[r].getReader();return new ReadableStream({async pull(e){try{let{done:o,value:i}=await n.read();if(o){if(n.releaseLock(),r++,r<t.length)return n=t[r].getReader(),this.pull(e);e.close()}else e.enqueue(i)}catch(t){n.releaseLock(),e.error(t)}}})}{if(e.some((e=>"function"!=typeof e[Symbol.asyncIterator])))throw new TypeError("All sources must be async iterable objects.");const t=e;return{[Symbol.asyncIterator]:async function*(){for(const e of t)yield*e}}}}registerErrorType(InterruptedError);var ke=Object.freeze({__proto__:null,concat:concat,readAsArray:readAsArray,readAsArrayBuffer:readAsArrayBuffer,readAsBlob:async function readAsBlob(e,t){if(e instanceof ArrayBuffer||ArrayBuffer.isView(e))return new Blob([e],{type:t});const r=await readAsArrayBuffer(e);return new Blob([r],{type:t})},readAsDataURL:async function readAsDataURL(e,t){if(e instanceof ArrayBuffer){return`data:${t};base64,${text(new Uint8Array(e),"base64")}`}if(e instanceof Uint8Array){return`data:${t};base64,${text(e,"base64")}`}if(ArrayBuffer.isView(e)){return`data:${t};base64,${text(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),"base64")}`}const r=await readAsArrayBuffer(e);return`data:${t};base64,${text(new Uint8Array(r),"base64")}`},readAsJSON:async function readAsJSON(e){const t=await readAsText(e);return JSON.parse(t)},readAsObjectURL:readAsObjectURL,readAsText:readAsText,resolveByteStream:resolveByteStream,toAsyncIterable:toAsyncIterable,toReadableStream:toReadableStream});const xe=function Result(e){if(!new.target)throw new TypeError("Class constructor Result cannot be invoked without 'new'");const t=this;e.ok?Object.defineProperties(t,{ok:{value:!0,enumerable:!0},value:{value:e.value,enumerable:!0}}):Object.defineProperties(t,{ok:{value:!1,enumerable:!0},error:{value:e.error,enumerable:!0}})};xe.prototype.unwrap=function unwrap(e=void 0){if(this.ok)return this.value;if(e)return e(this.error);throw this.error},xe.prototype.optional=function optional(){return this.ok?this.value:void 0},xe.try=function try_(e,...t){if("function"!=typeof e)return Promise.resolve(e).then((e=>e instanceof xe?e:Ok(e))).catch((e=>Err(e)));try{const r=e.call(void 0,...t);return"function"==typeof(null==r?void 0:r.then)?xe.try(r):r instanceof xe?r:Ok(r)}catch(e){return Err(e)}},xe.wrap=function wrap$1(e=void 0){return"function"==typeof e?wrap(e,(function(e,...t){try{const r=e.call(this,...t);return"function"==typeof(null==r?void 0:r.then)?Promise.resolve(r).then((e=>e instanceof xe?e:Ok(e))).catch((e=>Err(e))):r instanceof xe?r:Ok(r)}catch(e){return Err(e)}})):(...e)=>{if("object"==typeof e[1]){const[t]=e;return xe.wrap(t)}{const[t,r,n]=e;return void(n.value=xe.wrap(n.value))}}};const Ok=e=>new xe({ok:!0,value:e}),Err=e=>new xe({ok:!1,error:e}),Te=xe.try;var Oe=Object.freeze({__proto__:null,Err:Err,Ok:Ok,Result:xe,try_:Te});async function getDirHandle(e="",t={}){var r;"object"==typeof location&&"string"==typeof location.origin&&(e=stripStart(e,location.origin));const{create:n=!1,recursive:o=!1}=t,i=split(stripStart(e,"/")).filter((e=>"."!==e));let s=null!==(r=t.root)&&void 0!==r?r:await rawOp(navigator.storage.getDirectory(),"directory");for(let e=0;e<i.length;e++){const t=i[e];s=await rawOp(s.getDirectoryHandle(t,{create:n&&(o||e===i.length-1)}),"directory")}return s}async function getFileHandle(e,t={}){var r;const n=dirname(e),o=basename(e),i=await getDirHandle(n,{root:t.root});return await rawOp(i.getFileHandle(o,{create:null!==(r=t.create)&&void 0!==r&&r}),"file")}async function stat$1(e,t={}){var r,n,o,i,s;if("object"==typeof e){if("file"===e.kind){const t=await rawOp(e.getFile(),"file");return{name:e.name,kind:"file",size:t.size,type:null!==(n=null!==(r=t.type)&&void 0!==r?r:getMIME(extname(e.name)))&&void 0!==n?n:"",mtime:new Date(t.lastModified),atime:null,birthtime:null,mode:0,uid:0,gid:0,isBlockDevice:!1,isCharDevice:!1,isFIFO:!1,isSocket:!1}}return{name:e.name,kind:"directory",size:0,type:"",mtime:null,atime:null,birthtime:null,mode:0,uid:0,gid:0,isBlockDevice:!1,isCharDevice:!1,isFIFO:!1,isSocket:!1}}{const{value:r,error:n}=await Te(getFileHandle(e,t));if(r){const e=await rawOp(r.getFile(),"file");return{name:e.name,kind:"file",size:e.size,type:null!==(i=null!==(o=e.type)&&void 0!==o?o:getMIME(extname(e.name)))&&void 0!==i?i:"",mtime:new Date(e.lastModified),atime:null,birthtime:null,mode:0,uid:0,gid:0,isBlockDevice:!1,isCharDevice:!1,isFIFO:!1,isSocket:!1}}if("IsDirectoryError"===(null===(s=as$1(n,Exception))||void 0===s?void 0:s.name))return{name:basename(e),kind:"directory",size:0,type:"",mtime:null,atime:null,birthtime:null,mode:0,uid:0,gid:0,isBlockDevice:!1,isCharDevice:!1,isFIFO:!1,isSocket:!1};throw n}}async function mkdir$1(e,t={}){if(await async function exists$1(e,t={}){try{return await stat$1(e,t),!0}catch(e){if(e instanceof Exception&&"NotFoundError"===e.name)return!1;throw e}}(e,{root:t.root}))throw new AlreadyExistsError(`File or folder already exists, mkdir '${e}'`);await getDirHandle(e,{...t,create:!0})}async function*readDir$1(e,t={}){const r="object"==typeof e?e:await getDirHandle(e,t);yield*readDirHandle(r,t)}async function*readDirHandle(e,t={}){const{base:r="",recursive:n=!1}=t,o=e.entries();for await(const[e,t]of o){const e=fixDirEntry({name:t.name,kind:t.kind,relativePath:join(r,t.name),handle:t});yield e,n&&"directory"===t.kind&&(yield*readDirHandle(t,{base:e.relativePath,recursive:n}))}}async function copyInBrowser(e,t,r={}){var n,o;if("object"==typeof e&&"object"!=typeof t)throw new TypeError("The destination must be a FileSystemHandle.");if("object"==typeof t&&"object"!=typeof e)throw new TypeError("The source must be a FileSystemHandle.");if("object"==typeof e&&"object"==typeof t){if("file"===e.kind)return"file"===t.kind?await copyFileHandleToFileHandle(e,t):await copyFileHandleToDirHandle(e,t);if("directory"===t.kind){if(!r.recursive)throw new InvalidOperationError("Cannot copy a directory without the 'recursive' option");return await copyDirHandleToDirHandle(e,t)}throw new NotDirectoryError("The destination location is not a directory")}const i=dirname(e),s=basename(e);let a=await getDirHandle(i,{root:r.root});const{value:l,error:c}=await Te(rawOp(a.getFileHandle(s),"file"));if(l){const e=dirname(t),o=basename(t);let i=await getDirHandle(e,{root:r.root});const{error:c,value:u}=await Te(rawOp(i.getFileHandle(o,{create:!0}),"file"));if(u)await copyFileHandleToFileHandle(l,u),r.move&&await rawOp(a.removeEntry(s),"directory");else{if("IsDirectoryError"!==(null===(n=as$1(c,Exception))||void 0===n?void 0:n.name)||r.move)throw c;i=await rawOp(i.getDirectoryHandle(o),"directory"),await copyFileHandleToDirHandle(l,i)}}else{if("IsDirectoryError"!==(null===(o=as$1(c,Exception))||void 0===o?void 0:o.name))throw c;{if(!r.recursive)throw new InvalidOperationError("Cannot copy a directory without the 'recursive' option");const e=a;a=await rawOp(a.getDirectoryHandle(s),"directory");const n=await getDirHandle(t,{root:r.root,create:!0});await copyDirHandleToDirHandle(a,n),r.move&&await rawOp(e.removeEntry(s,{recursive:!0}),"directory")}}}async function copyFileHandleToFileHandle(e,t){try{const r=await e.getFile(),n=await t.createWritable();await r.stream().pipeTo(n)}catch(e){throw wrapFsError(e,"file")}}async function copyFileHandleToDirHandle(e,t){try{const r=await e.getFile(),n=await t.getFileHandle(e.name,{create:!0}),o=await n.createWritable();await r.stream().pipeTo(o)}catch(e){throw wrapFsError(e,"file")}}async function copyDirHandleToDirHandle(e,t){const r=e.entries();for await(const[e,n]of r)if("file"===n.kind)try{const e=await n.getFile(),r=await t.getFileHandle(n.name,{create:!0}),o=e.stream(),i=await r.createWritable();await o.pipeTo(i)}catch(e){throw wrapFsError(e,"file")}else{const e=await rawOp(t.getDirectoryHandle(n.name,{create:!0}),"directory");await copyDirHandleToDirHandle(n,e)}}async function createFileHandleWritableStream(e,t){var r;const n=await rawOp(e.createWritable({keepExistingData:null!==(r=null==t?void 0:t.append)&&void 0!==r&&r}),"file");if(t.append){const t=await rawOp(e.getFile(),"file");t.size&&n.seek(t.size)}return n}const Ae="object"==typeof Deno&&"object"==typeof Deno.build?"windows"===Deno.build.os?"\r\n":"\n":"object"==typeof process&&"string"==typeof process.platform&&"win32"===process.platform?"\r\n":"\n";async function exists(e,t={}){var r;try{return await stat(e,t),!0}catch(e){if("NotFoundError"===(null===(r=as$1(e,L))||void 0===r?void 0:r.name))return!1;throw e}}async function stat(e,t={}){var r,n,o,i,s,a,l,c,u,d,f,p,h,m,y,w,v,g;if("object"==typeof(e=ensureFsTarget(e))||!j&&!P)return await stat$1(e,t);const b=await resolveHomeDir(e);if(j){const e=await rawOp(t.followSymlink?Deno.stat(b):Deno.lstat(b)),p=e.isDirectory?"directory":e.isSymlink?"symlink":"file";return{name:basename(b),kind:p,size:e.size,type:"file"===p&&null!==(r=getMIME(extname(b)))&&void 0!==r?r:"",mtime:null!==(n=e.mtime)&&void 0!==n?n:null,atime:null!==(o=e.atime)&&void 0!==o?o:null,birthtime:null!==(i=e.birthtime)&&void 0!==i?i:null,mode:null!==(s=e.mode)&&void 0!==s?s:0,uid:null!==(a=e.uid)&&void 0!==a?a:0,gid:null!==(l=e.gid)&&void 0!==l?l:0,isBlockDevice:null!==(c=e.isBlockDevice)&&void 0!==c&&c,isCharDevice:null!==(u=e.isCharDevice)&&void 0!==u&&u,isFIFO:null!==(d=e.isFifo)&&void 0!==d&&d,isSocket:null!==(f=e.isSocket)&&void 0!==f&&f}}{const e=await import("node:fs/promises"),r=await rawOp(t.followSymlink?e.stat(b):e.lstat(b)),n=r.isDirectory()?"directory":r.isSymbolicLink()?"symlink":"file";return{name:basename(b),kind:n,size:r.size,type:"file"===n&&null!==(p=getMIME(extname(b)))&&void 0!==p?p:"",mtime:null!==(h=r.mtime)&&void 0!==h?h:null,atime:null!==(m=r.atime)&&void 0!==m?m:null,birthtime:null!==(y=r.birthtime)&&void 0!==y?y:null,mode:null!==(w=r.mode)&&void 0!==w?w:0,uid:null!==(v=r.uid)&&void 0!==v?v:0,gid:null!==(g=r.gid)&&void 0!==g?g:0,isBlockDevice:r.isBlockDevice(),isCharDevice:r.isCharacterDevice(),isFIFO:r.isFIFO(),isSocket:r.isSocket()}}}async function mkdir(e,t={}){if(e=ensureFsTarget(e),!j&&!P)return await mkdir$1(e,t);if(e=await resolveHomeDir(e),j)await rawOp(Deno.mkdir(e,t));else{const r=await import("node:fs/promises");await rawOp(r.mkdir(e,t))}}async function ensureDir(e,t={}){var r;if(!await exists(e,t))try{await mkdir(e,{...t,recursive:!0})}catch(e){if("AlreadyExistsError"===(null===(r=as$1(e,L))||void 0===r?void 0:r.name))return;throw e}}async function*readDir(e,t={}){if("object"==typeof(e=ensureFsTarget(e))||!j&&!P)return void(yield*readDir$1(e,t));const r=await resolveHomeDir(e);if(j)yield*async function*read(e,r){try{for await(const n of Deno.readDir(e)){const o=fixDirEntry({name:n.name,kind:n.isDirectory?"directory":n.isSymlink?"symlink":"file",relativePath:join(r,n.name)});yield o,(null==t?void 0:t.recursive)&&n.isDirectory&&(yield*read(join(e,n.name),o.relativePath))}}catch(e){throw wrapFsError(e)}}(r,"");else{const e=await import("node:fs/promises");yield*async function*read(r,n){const o=await rawOp(e.readdir(r,{withFileTypes:!0}));for(const e of o){const o=fixDirEntry({name:e.name,kind:e.isDirectory()?"directory":e.isSymbolicLink()?"symlink":"file",relativePath:join(n,e.name)});yield o,(null==t?void 0:t.recursive)&&e.isDirectory()&&(yield*read(join(r,e.name),o.relativePath))}}(r,"")}}async function readFile(e,t={}){if("object"==typeof(e=ensureFsTarget(e))||!j&&!P)return await async function readFile$1(e,t={}){const r="object"==typeof e?e:await getFileHandle(e,{root:t.root}),n=await rawOp(r.getFile(),"file"),o=new Uint8Array(n.size);let i=0,s=toAsyncIterable(n.stream());t.signal&&(s=abortable(s,t.signal));for await(const e of s)o.set(e,i),i+=e.length;return o}(e,t);const r=await resolveHomeDir(e);if(j)return await rawOp(Deno.readFile(r,t));{const e=await import("node:fs/promises"),n=await rawOp(e.readFile(r,t));return new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}}async function readFileAsText(e,t={}){const{encoding:r,...n}=t,o=await readFile(e,n);return await readAsText(o,r)}async function readFileAsFile(e,t={}){var r,n,o;if("object"==typeof(e=ensureFsTarget(e))||!j&&!P)return await async function readFileAsFile$1(e,t={}){const r="object"==typeof e?e:await getFileHandle(e,{root:t.root});return fixFileType(await rawOp(r.getFile(),"file"))}(e,t);const i=await stat(e,t),s=await readFile(e,t),a=null!==(r=getMIME(extname(e)))&&void 0!==r?r:"",l=new File([s],basename(e),{type:a}),c=null!==(o=null===(n=i.mtime)||void 0===n?void 0:n.getTime())&&void 0!==o?o:Date.now();return Object.defineProperty(l,"lastModified",{configurable:!0,enumerable:!0,writable:!1,value:c}),Object.defineProperty(l,"lastModifiedDate",{configurable:!0,enumerable:!0,writable:!1,value:new Date(c)}),Object.defineProperty(l,"webkitRelativePath",{configurable:!0,enumerable:!0,writable:!1,value:""}),l}async function writeFile(e,t,r={}){if("object"==typeof(e=ensureFsTarget(e))||!j&&!P)return await async function writeFile$1(e,t,r={}){const n="object"==typeof e?e:await getFileHandle(e,{root:r.root,create:!0}),o=await createFileHandleWritableStream(n,r);if(r.signal){const{signal:e}=r;if(e.aborted)throw await o.abort(e.reason),wrapFsError(e.reason,"file");e.addEventListener("abort",(()=>{o.abort(e.reason)}))}try{t instanceof Blob?await t.stream().pipeTo(o):t instanceof ReadableStream?await t.pipeTo(o):(await o.write(t),await o.close())}catch(e){throw wrapFsError(e,"file")}}(e,t,r);const n=await resolveHomeDir(e);if(j){if("string"==typeof t)return await rawOp(Deno.writeTextFile(n,t,r));if(t instanceof Blob)return await rawOp(Deno.writeFile(n,t.stream(),r));if(t instanceof ArrayBuffer)return await rawOp(Deno.writeFile(n,new Uint8Array(t),r));if(t instanceof Uint8Array)return await rawOp(Deno.writeFile(n,t,r));if(ArrayBuffer.isView(t))return await rawOp(Deno.writeFile(n,bytes(t),r));if(t)return await rawOp(Deno.writeFile(n,t,r))}else if("function"==typeof Blob&&t instanceof Blob){const e=t.stream(),o=createNodeWritableStream(n,r);await e.pipeTo(o)}else{if(!("function"==typeof ReadableStream&&t instanceof ReadableStream)){const e=await import("node:fs/promises"),{append:o,...i}=r;let s;if(t instanceof ArrayBuffer)s=new Uint8Array(t);else if(t instanceof Uint8Array)s=t;else if(ArrayBuffer.isView(t))s=bytes(t);else{if("string"!=typeof t)throw new TypeError("Unsupported data type");s=t}return await rawOp(e.writeFile(n,s,{flag:o?"a":"w",...i}))}{const e=createNodeWritableStream(n,r);await t.pipeTo(e)}}}async function chmod(e,t){if("windows"!==platform())if(e=ensureFsTarget(e),e=await resolveHomeDir(e),j)await rawOp(Deno.chmod(e,t));else if(P){const r=await import("node:fs/promises");await rawOp(r.chmod(e,t))}}async function utimes(e,t,r){if(e=ensureFsTarget(e),e=await resolveHomeDir(e),j)await rawOp(Deno.utime(e,t,r));else if(P){const n=await import("node:fs/promises");await rawOp(n.utimes(e,t,r))}}function createReadableStream(e,t={}){if("object"==typeof(e=ensureFsTarget(e))||!j&&!P)return function createReadableStream$1(e,t={}){return resolveByteStream((async()=>{const r="object"==typeof e?e:await getFileHandle(e,{root:t.root});return(await rawOp(r.getFile(),"file")).stream()})())}(e,t);if(j)return resolveByteStream((async()=>{const t=await resolveHomeDir(e);return(await rawOp(Deno.open(t,{read:!0}))).readable})());{let t;const r=new TextEncoder;return new ReadableStream({async start(n){const o=await import("node:fs"),i=await resolveHomeDir(e);t=o.createReadStream(i),t.on("data",(e=>{const t="string"==typeof e?r.encode(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength);n.enqueue(t)})),t.on("end",(()=>n.close())),t.on("error",(e=>n.error(e)))},cancel(e=void 0){t.destroy(e)}})}}function createWritableStream(e,t={}){if("object"==typeof(e=ensureFsTarget(e))||!j&&!P)return function createWritableStream$1(e,t={}){const{readable:r,writable:n}=new TransformStream;return("object"==typeof e?Promise.resolve(e):getFileHandle(e,{root:t.root,create:!0})).then((e=>createFileHandleWritableStream(e,t))).then((e=>r.pipeTo(e))),n}(e,t);const r=e;if(j){const{readable:e,writable:n}=new TransformStream;return resolveHomeDir(r).then((e=>{var r;return Deno.open(e,{write:!0,create:!0,append:null!==(r=t.append)&&void 0!==r&&r})})).then((e=>e.writable)).then((t=>e.pipeTo(t))),n}return createNodeWritableStream(r,t)}function createNodeWritableStream(e,t){let r;return new WritableStream({async start(){const{append:n,...o}=t,{createWriteStream:i}=await import("node:fs");e=await resolveHomeDir(e),r=i(e,{flags:n?"a":"w",...o})},write:e=>new Promise(((t,n)=>{r.write(e,(e=>e?n(e):t()))})),close:()=>new Promise((e=>{r.end((()=>e()))})),abort(e){r.destroy(e)}})}var Fe=Object.freeze({__proto__:null,BusyError:BusyError,EOL:Ae,FileTooLargeError:FileTooLargeError,FilesystemLoopError:FilesystemLoopError,InterruptedError:InterruptedError,InvalidOperationError:InvalidOperationError,IsDirectoryError:IsDirectoryError,NotDirectoryError:NotDirectoryError,chmod:chmod,chown:async function chown(e,t,r){if("windows"!==platform())if(e=ensureFsTarget(e),e=await resolveHomeDir(e),j)await rawOp(Deno.chown(e,t,r));else if(P){const n=await import("node:fs/promises");await rawOp(n.chown(e,t,r))}},copy:async function copy(e,t,r={}){if(e=ensureFsTarget(e),t=ensureFsTarget(t),"object"==typeof e||"object"==typeof t||!j&&!P)return await async function copy$1(e,t,r={}){return copyInBrowser(e,t,r)}(e,t,r);e=await resolveHomeDir(e),t=await resolveHomeDir(t);const n="directory"===(await stat(e,{followSymlink:!0})).kind;let o=!1;if(n&&!r.recursive)throw new InvalidOperationError("Cannot copy a directory without the 'recursive' option");try{if(o="directory"===(await stat(t,{followSymlink:!0})).kind,n&&!o)throw new NotDirectoryError(`'${t}' is not a directory`)}catch(e){n&&(await mkdir(t),o=!0)}if(j)if(n){const r=readDir(e,{recursive:!0});for await(const n of r){const r=join(e,n.relativePath),o=join(t,n.relativePath);"directory"===n.kind?await rawOp(Deno.mkdir(o)):await rawOp(Deno.copyFile(r,o))}}else{const r=o?join(t,basename(e)):t;await rawOp(Deno.copyFile(e,r))}else{const r=await import("node:fs/promises");if(n){const n=readDir(e,{recursive:!0});for await(const o of n){const n=join(e,o.relativePath),i=join(t,o.relativePath);"directory"===o.kind?await rawOp(r.mkdir(i)):await rawOp(r.copyFile(n,i))}}else{const n=o?join(t,basename(e)):t;await rawOp(r.copyFile(e,n))}}},createReadableStream:createReadableStream,createWritableStream:createWritableStream,ensureDir:ensureDir,exists:exists,getDirHandle:getDirHandle,getFileHandle:getFileHandle,link:async function link(e,t,r={}){if(e=ensureFsTarget(e),t=ensureFsTarget(t),e=await resolveHomeDir(e),t=await resolveHomeDir(t),j)if(r.symbolic)if("windows"===platform()){const r=await stat(e);await rawOp(Deno.symlink(e,t,{type:"directory"===r.kind?"dir":"file"}))}else await rawOp(Deno.symlink(e,t));else await rawOp(Deno.link(e,t));else if(P){const n=await import("node:fs/promises");if(r.symbolic)if("windows"===platform()){const r=await stat(e);await rawOp(n.symlink(e,t,"directory"===r.kind?"dir":"file"))}else await rawOp(n.symlink(e,t));else await rawOp(n.link(e,t))}else throwUnsupportedRuntimeError()},mkdir:mkdir,readDir:readDir,readFile:readFile,readFileAsFile:readFileAsFile,readFileAsText:readFileAsText,readLink:async function readLink(e){if(e=ensureFsTarget(e),e=await resolveHomeDir(e),j)return await rawOp(Deno.readLink(e));if(P){const t=await import("node:fs/promises");return await rawOp(t.readlink(e))}throwUnsupportedRuntimeError()},readTree:async function readTree(e,t={}){const r=makeTree(e=ensureFsTarget(e),await readAsArray(readDir(e,{...t,recursive:!0})),!0);return!r.handle&&t.root&&(r.handle=t.root),r},remove:async function remove(e,t={}){if(e=ensureFsTarget(e),!j&&!P)return await async function remove$1(e,t={}){const r=dirname(e),n=basename(e),o=await getDirHandle(r,{root:t.root});await rawOp(o.removeEntry(n,t),"directory")}(e,t);if(e=await resolveHomeDir(e),j)await rawOp(Deno.remove(e,t));else{const r=await import("node:fs/promises");if("function"==typeof r.rm)await rawOp(r.rm(e,t));else try{(await r.stat(e)).isDirectory()?await r.rmdir(e,t):await r.unlink(e)}catch(e){throw wrapFsError(e)}}},rename:async function rename(e,t,r={}){if(e=ensureFsTarget(e),t=ensureFsTarget(t),!j&&!P)return await async function rename$1(e,t,r={}){return await copyInBrowser(e,t,{root:r.root,recursive:!0,move:!0})}(e,t,r);if(e=await resolveHomeDir(e),t=await resolveHomeDir(t),j)await rawOp(Deno.rename(e,t));else{const r=await import("node:fs/promises");await rawOp(r.rename(e,t))}},stat:stat,truncate:async function truncate(e,t=0,r={}){if("object"==typeof(e=ensureFsTarget(e))||!j&&!P)return await async function truncate$1(e,t=0,r={}){const n="object"==typeof e?e:await getFileHandle(e,{root:r.root});try{const e=await n.createWritable({keepExistingData:!0});await e.truncate(t),await e.close()}catch(e){throw wrapFsError(e,"file")}}(e,t,r);const n=await resolveHomeDir(e);if(j)await rawOp(Deno.truncate(n,t));else{const e=await import("node:fs/promises");await rawOp(e.truncate(n,t))}},utimes:utimes,writeFile:writeFile,writeLines:async function writeLines(e,t,r={}){const n=await readFileAsText(e,r).catch((e=>{var t;if("NotFoundError"!==(null===(t=as$1(e,L))||void 0===t?void 0:t.name))throw e;return""})),o=n.match(/\r?\n/g);let i=Ae;if(o){const e=o.filter((e=>"\r\n"===e)).length;i=e>o.length-e?"\r\n":"\n"}let s=t.join(i);s.endsWith(i)||("\r\n"===i&&s.endsWith("\r")?s+="\n":s+=i),!r.append||n.endsWith(i)||s.startsWith(i)||("\r\n"===i&&n.endsWith("\r")?s.startsWith("\n")||(s="\n"+s):s=i+s),await writeFile(e,s,r)}});const je=new Map;async function getObjectURL(e,t="text/javascript"){var r;const n=isUrl(e);let o=n?je.get(e):void 0;if(o)return o;const i=await fetch(e);if(!i.ok)throw new NetworkError(`Failed to fetch resource: ${e}`);let s;const a=t.includes("javascript")?"javascript":t;if(null===(r=i.headers.get("content-type"))||void 0===r?void 0:r.includes(a))s=await i.blob();else{const e=await i.arrayBuffer();s=new Blob([new Uint8Array(e)],{type:t})}return o=URL.createObjectURL(s),n&&je.set(e,o),o}function interop(e,t=void 0){if("function"==typeof e)return e().then((e=>interop(e,t)));if(e instanceof Promise)return e.then((e=>interop(e,t)));let r=e["module.exports"];if(isObject(r)||"function"==typeof r){return"default,module.exports"===Object.getOwnPropertyNames(e).sort().join(",")&&e.default===r&&!1!==t?{default:r}:r}if(isObject(r=e.default)){if(!0===e.__esModule||!0===r.__esModule)return r;if(t)return e;const exportNames=e=>"default"!==e&&"__esModule"!==e,n=Object.getOwnPropertyNames(e).filter(exportNames).sort(),o=Object.getOwnPropertyNames(r).filter(exportNames).sort();if(String(n)===String(o)||!1===t&&!n.length)return r}return e}function isObject(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function isMain(e){var t;if("main"in e&&"boolean"==typeof e.main)return e.main;if("serviceWorker"in globalThis&&"url"in e)return globalThis.serviceWorker.scriptURL===e.url;if((F||A)&&"url"in e&&"object"==typeof location&&location)return e.url===location.href;if("object"==typeof process&&Array.isArray(process.argv)&&process.argv.length){if(!process.argv[1])return["<repl>","[eval]"].includes(e.id);const r="url"in e?e.url:null!==(t=e.filename)&&void 0!==t?t:process.argv[1],n=extname(r);let o=process.argv[1];return!extname(o)&&n&&(o+=n),equals(r,o,{ignoreFileProtocol:!0})}return!1}const $e=new Map;const Pe=new Map;const Ce=new Map;var De=Object.freeze({__proto__:null,importScript:function importScript(e,t={}){if(!T)return Promise.reject(new I("This function is only available in the browser."));e=new URL(e,location.href).href;let r=$e.get(e);return r||(r=new Promise(((r,n)=>{getObjectURL(e).then((o=>{const i=document.createElement("script");i.src=o,i.type="module"===t.type?"module":"text/javascript",i.setAttribute("data-src",e),i.onload=()=>setTimeout(r,0),i.onerror=()=>n(new NetworkError(`Failed to load script: ${e}`)),document.head.appendChild(i)})).catch(n)})),$e.set(e,r),r)},importStylesheet:function importStylesheet(e){if(!T)return Promise.reject(new I("This function is only available in the browser."));e=new URL(e,location.href).href;let t=$e.get(e);return t||(t=new Promise(((t,r)=>{getObjectURL(e,"text/css").then((n=>{const o=document.createElement("link");o.href=n,o.rel="stylesheet",o.setAttribute("data-src",e),o.onload=()=>setTimeout(t,0),o.onerror=()=>r(new NetworkError(`Failed to load stylesheet: ${e}`)),document.head.appendChild(o)})).catch(r)})),$e.set(e,t),t)},importWasm:async function importWasm(e,t=void 0){if(!P&&!j||e instanceof WebAssembly.Module||e instanceof URL&&"file:"!==e.protocol||"string"==typeof e&&isUrl(e)&&!isFileUrl(e))return await async function importWasm$1(e,t){if(e instanceof WebAssembly.Module){let r=Pe.get(e);return r||(r=WebAssembly.instantiate(e,t).then((e=>e.exports)),Pe.set(e,r)),await r}const r="string"==typeof e?e:e.href;if("function"==typeof WebAssembly.instantiateStreaming){let e=Pe.get(r);return e||(e=fetch(r).then((e=>WebAssembly.instantiateStreaming(e,t))).then((e=>e.instance.exports)),Pe.set(r,e)),await e}{let e=Pe.get(r);return e||(e=fetch(r).then((e=>e.arrayBuffer())).then((e=>WebAssembly.instantiate(e,t))).then((e=>e.instance.exports)),Pe.set(r,e)),await e}}(e,t);const r="string"==typeof e?e:e.href,n=isFileUrl(r)?toFsPath(r):resolve(r);if("function"==typeof WebAssembly.instantiateStreaming){let e=Ce.get(n);if(!e){const r=createReadableStream(n);e=Promise.resolve(new Response(r,{headers:{"Content-Type":"application/wasm"}})).then((e=>WebAssembly.instantiateStreaming(e,t))).then((e=>e.instance.exports)),Ce.set(n,e)}return await e}{let e=Ce.get(n);return e||(e=readFile(n).then((e=>WebAssembly.instantiate(e,t))).then((e=>e.instance.exports)),Ce.set(n,e)),await e}},interop:interop,isMain:isMain});const Re=new Map;function sanitizeModuleId(e,t=!1){let r="";if("function"==typeof e){let t=e.toString(),n=7,o=t.lastIndexOf("import(");if(-1===o&&(n=8,o=t.lastIndexOf("require(")),-1===o)throw new TypeError("The given script is not a dynamic import expression.");{o+=n;const e=t.indexOf(")",o);r=trim(t.slice(o,e)," '\"'")}}else r=e;return C&&isFsPath(r)&&!/\.[cm]?(js|ts|)x?$/.test(r)&&(r+=".js"),t||isAbsolute(r)||(r="./"+r),r}const Le=new Map;function isChannelMessage(e){return e&&"object"==typeof e&&["send","close"].includes(e.type)&&"number"==typeof e.channelId}async function handleChannelMessage(e){const t=Le.get(e.channelId);if(t)if("send"===e.type)await t.raw.send(e.value);else if("close"===e.type){const{value:r,channelId:n}=e;t.raw.close(r),Le.delete(n),R&&t.writers.length>1&&t.writers.forEach((e=>{e("close",r,n)}))}}function wrapChannel(e,t){return function wireChannel(e,t){const r=e[x];if(Le.has(r))Le.get(r).writers.push(t);else{const n=e.send.bind(e),o=e.close.bind(e);Le.set(r,{channel:e,raw:{send:n,close:o},writers:[t],counter:0}),Object.defineProperties(e,{send:{configurable:!0,writable:!0,value:async e=>{const t=Le.get(r);if(t){if(1!==t.channel.state)throw new TypeError("the channel is closed");const n=t.writers[t.counter++%t.writers.length];await Promise.resolve(n("send",e,r))}}},close:{configurable:!0,writable:!0,value:(e=null)=>{const t=Le.get(r);if(t){Le.delete(r);const n=t.channel;t.writers.forEach((t=>{t("close",e,r)})),Object.defineProperties(n,{send:{configurable:!0,writable:!0,value:t.raw.send},close:{configurable:!0,writable:!0,value:t.raw.close}}),n.close(e)}}}})}}(e,t),{"@@type":"Channel","@@id":e[x],capacity:e.capacity}}const Ie=serial(!0);let Ne,Be=[];const Ue=new Map,We=(async()=>{if("object"==typeof navigator&&navigator.hardwareConcurrency)return navigator.hardwareConcurrency;if(C){const e=await import("node:os");return"function"==typeof e.availableParallelism?e.availableParallelism():e.cpus().length}return 8})();function isCallResponse(e){return e&&"object"==typeof e&&["return","yield","error","gen"].includes(e.type)}function getModuleDir(e){if(".ts"===extname(e))return resolve(e,"../..");let t=dirname(e);return endsWith(t,"jsext/bundle")?dirname(t):resolve(t,"../..")}async function createWorker(e){let{adapter:r="worker_threads",parallel:n}=e;const o=await async function getWorkerEntry(e={}){if(j)return e.workerEntry?e.workerEntry:("undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:t&&"SCRIPT"===t.tagName.toUpperCase()&&t.src||new URL("jsext.js",document.baseURI).href).includes("jsr.io")?"jsr:@ayonli/jsext/worker.ts":join(getModuleDir("undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:t&&"SCRIPT"===t.tagName.toUpperCase()&&t.src||new URL("jsext.js",document.baseURI).href),"worker.ts");if(P){if(e.workerEntry)return e.workerEntry;const r=toFsPath("undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:t&&"SCRIPT"===t.tagName.toUpperCase()&&t.src||new URL("jsext.js",document.baseURI).href);if(r===process.argv[1]){const e=join(cwd(),"node_modules/@ayonli/jsext");return $?".ts"===extname(r)?join(e,"worker.ts"):join(e,"bundle/worker.mjs"):join(e,"bundle/worker-node.mjs")}{const e=getModuleDir(r);return $?".ts"===extname(r)?join(e,"worker.ts"):join(e,"bundle/worker.mjs"):join(e,"bundle/worker-node.mjs")}}if(e.workerEntry)return isUrl(e.workerEntry)?await getObjectURL(e.workerEntry):e.workerEntry;{const e="https://ayonli.github.io/jsext/bundle/worker.mjs";return await getObjectURL(e)}}(n);if(C||$){if("child_process"===r){const{fork:e}=await import("node:child_process"),t=e(o,["--worker-thread"],{stdio:"inherit",serialization:D?"json":"advanced"}),r=t.pid;return await new Promise(((e,r)=>{t.once("error",r),t.once("message",(()=>{t.off("error",r),e()}))})),{worker:t,workerId:r,kind:"node_process"}}if(C){const{Worker:e}=await import("node:worker_threads"),t=new e(o,{argv:["--worker-thread"]}),r=t.threadId;return await new Promise(((e,r)=>{t.once("error",r),t.once("online",(()=>{t.off("error",r),e()}))})),{worker:t,workerId:r,kind:"node_worker"}}{const e=new Worker(o,{type:"module"}),t=Ie.next().value;return await new Promise(((t,r)=>{e.onerror=e=>{r(new Error(e.message||"Unable to start the worker."))},e.addEventListener("open",(()=>{e.onerror=null,t()}))})),{worker:e,workerId:t,kind:"bun_worker"}}}return{worker:new Worker(o,{type:"module"}),workerId:Ie.next().value,kind:"web_worker"}}function handleWorkerMessage(e,t,r){var n,o,i,s;if(isChannelMessage(r))handleChannelMessage(r);else if(isCallResponse(r)&&r.taskId){const a=Ue.get(r.taskId);if(!a)return;if("return"===r.type||"error"===r.type){if("error"===r.type){const e=isPlainObject(r.error)&&null!==(n=fromObject(r.error))&&void 0!==n?n:r.error;e instanceof Error&&(e.message.includes("not be cloned")||(null===(o=e.stack)||void 0===o?void 0:o.includes("not be cloned"))||e.message.includes("Do not know how to serialize"))&&Object.defineProperty(e,"stack",{configurable:!0,enumerable:!1,writable:!0,value:(e.stack?e.stack+"\n    ":"")+`at ${a.fn} (${a.module})`}),a.promise?(a.promise.reject(e),a.channel&&a.channel.close()):a.channel?a.channel.close(e):a.error=e}else{const e=unwrapReturnValue(r.value);a.promise?a.promise.resolve(e):a.result={value:e},a.channel&&a.channel.close()}e.tasks.delete(r.taskId),e.tasks.size||"function"!=typeof t.unref||t.unref()}else if("yield"===r.type){const n=unwrapReturnValue(r.value);null===(i=a.channel)||void 0===i||i.send({value:n,done:r.done}),r.done&&handleWorkerMessage(e,t,{type:"return",value:n,taskId:r.taskId})}else"gen"===r.type&&(null===(s=a.generate)||void 0===s||s.call(a))}}function handleWorkerClose(e,t){for(const r of e.tasks){e.tasks.delete(r);const n=Ue.get(r);n&&(n.promise?(n.promise.reject(t),n.channel&&n.channel.close()):n.channel?n.channel.close(t):n.error=t)}Be=Be.filter((t=>t!==e))}async function acquireWorker(e,t){const r=t.maxWorkers||await We;let n=Be.find((e=>!e.tasks.size));n?n.lastAccess=Date.now():Be.length<r?(Be.push(n={getWorker:(async()=>{const e=(await createWorker({parallel:t})).worker,r=handleWorkerMessage.bind(void 0,n,e),o=handleWorkerClose.bind(void 0,n);if(C)e.on("message",r).on("error",o);else if($){const t=e;t.onmessage=e=>r(e.data),t.onerror=()=>t.terminate(),t.addEventListener("close",(e=>{o(new Error(e.reason+" ("+e.code+")"))}))}else{const t=e;t.onmessage=e=>r(e.data),t.onerror=e=>{var r;t.terminate(),o(null!==(r=fromErrorEvent(e))&&void 0!==r?r:new Error("worker exited"))}}return e})(),tasks:new Set,lastAccess:Date.now()}),Ne||(Ne=setInterval((()=>{const e=Date.now(),t=[];Be=Be.filter((r=>{const n=!r.tasks.size&&e-r.lastAccess>=1e4;return n&&t.push(r),!n})),t.forEach((async e=>{const t=await e.getWorker;await t.terminate()}))}),1e3),unrefTimer(Ne))):(n=Be[e%Be.length],n.lastAccess=Date.now()),n.tasks.add(e);const o=await n.getWorker;return"ref"in o&&"function"==typeof o.ref&&o.ref(),o}function wrapArgs(e,t){const r=[];return e=e.map((e=>{if(e instanceof Channel)return wrapChannel(e,((e,r,n)=>{t.then((t=>{if("function"==typeof t.postMessage)try{t.postMessage({type:e,value:r,channelId:n})}catch(t){if("close"!==e||!String(t).includes("Worker has been terminated"))throw t}else t.send({type:e,value:r,channelId:n})}))}));if(e instanceof L||isDOMException(e)||isAggregateError(e))return toObject(e);if(e instanceof ArrayBuffer)r.push(e);else if(isPlainObject(e))for(const t of Object.getOwnPropertyNames(e)){const n=e[t];n instanceof ArrayBuffer?r.push(n):(n instanceof L||isDOMException(n)||isAggregateError(n))&&(e[t]=toObject(n))}else Array.isArray(e)&&(e=e.map((e=>e instanceof ArrayBuffer?(r.push(e),e):e instanceof L||isDOMException(e)||isAggregateError(e)?toObject(e):e)));return e})),{args:e,transferable:r}}function unwrapReturnValue(e){return isPlainObject(e)&&"string"==typeof e["@@type"]&&getErrorConstructor(e["@@type"])?fromObject(e):e}const Me=serial(!0);async function safeRemoteCall(e,t,r,n){try{e.postMessage(t,r)}catch(t){throw Ue.delete(n),"function"==typeof e.unref&&e.unref(),t}}function createLocalCall(e,t,r){const n=async function resolveModule(e,t){let r;if(C||$){const n=t?toFsPath(new URL(e,t).href):e;r=await import(n)}else{const n=new URL(e,t).href;if(r=Re.get(n),!r)if(j)r=await import(n),Re.set(n,r);else try{r=await import(n),Re.set(n,r)}catch(e){if(!String(e).includes("Failed"))throw e;{const e=await getObjectURL(n);r=await import(e),Re.set(n,r)}}}return interop(r)}(e).then((e=>e[t](...r)));return new ThenableAsyncGenerator({then:(e,t)=>n.then(e,t),async next(e){const t=await n;return await t.next(e)},async return(e){const t=await n;return await t.return(e)},throw:async e=>(await n).throw(e)})}function extractBaseUrl(e){var t,r,n;let o=e.split("\n");const i=o.findIndex((e=>"Error"===e));let s,a;if(-1!==i&&0!==i&&(o=o.slice(i)),s=(null===(t=o[0])||void 0===t?void 0:t.startsWith("Error"))?o[2]:o[1],s){let e=s.lastIndexOf("("),t=0;if(-1!==e?(e+=1,t=s.indexOf(")",e),s=s.slice(e,t)):s.startsWith("    at ")?s=s.slice(7):"object"==typeof location&&(e=null!==(n=null===(r=s.match(/(https?|file):/))||void 0===r?void 0:r.index)&&void 0!==n?n:-1,e>0&&(s=s.slice(e))),a=s.replace(/:\d+:\d+$/,""),!/^(https?|file):/.test(a))if(isFsPath(a))a=toFileUrl(a);else try{a=toFileUrl(cwd())+"/"}catch(e){a=""}}return a}function parallel(e){C||"function"==typeof Worker||throwUnsupportedRuntimeError();let t,r=sanitizeModuleId(e,!0);if(isFsPath(r))if("function"==typeof Error.captureStackTrace){const e={};Error.captureStackTrace(e),t=extractBaseUrl(e.stack)}else{t=extractBaseUrl(new Error("").stack)}return t&&(r=new URL(r,t).href),new Proxy(Object.create(null),{get:(e,t)=>{if(Reflect.has(e,t))return e[t];if("symbol"==typeof t)return;const n={[t]:(...e)=>R?function createRemoteCall(e,t,r){const n=Me.next().value;Ue.set(n,{module:e,fn:t});let o=acquireWorker(n,parallel);const{args:i,transferable:s}=wrapArgs(r,o);return o=o.then((async r=>(await safeRemoteCall(r,{type:"call",module:e,fn:t,args:i,taskId:n},s,n),r))),new ThenableAsyncGenerator({then(e,t){const r=Ue.get(n);return r.error?(Ue.delete(n),null==t?void 0:t(r.error)):r.result?(Ue.delete(n),null==e?void 0:e(r.result.value)):o.then((()=>(r.promise=asyncTask()).finally((()=>{Ue.delete(n)})))).then(e,t)},async next(e){var t;const r=Ue.get(n);if(r.error){const e=r.error;throw Ue.delete(n),e}if(r.result){const e=r.result.value;return Ue.delete(n),{value:e,done:!0}}{null!==(t=r.channel)&&void 0!==t||(r.channel=chan(1/0));const i=await o;r.generate||await new Promise((e=>{r.generate=e}));const{args:s,transferable:a}=wrapArgs([e],o);return await safeRemoteCall(i,{type:"next",args:s,taskId:n},a,n),await r.channel.recv()}},async return(e){Ue.delete(n);const t=await o,{args:r,transferable:i}=wrapArgs([e],o);return await safeRemoteCall(t,{type:"return",args:r,taskId:n},i,n),{value:e,done:!0}},async throw(e){Ue.delete(n);const t=await o;throw await safeRemoteCall(t,{type:"throw",args:[e],taskId:n},s,n),e}})}(r,t,e):createLocalCall(r,t,e)};return n[t]}})}!function(e){e.maxWorkers=void 0,e.workerEntry=void 0,e.isMainThread=!1}(parallel||(parallel={})),Object.defineProperty(parallel,"isMainThread",{value:R,writable:!1});var _e=parallel;const ze=new Map;let He;const qe=[];async function run$1(e,t,r){var n,o;C||"function"==typeof Worker||throwUnsupportedRuntimeError(),e="string"==typeof e?e:e.href;const i=run$1.maxWorkers||_e.maxWorkers||await We;if(null===(n=null==r?void 0:r.signal)||void 0===n?void 0:n.aborted)throw r.signal.reason;const s=(null==r?void 0:r.fn)||"default";let a,l=sanitizeModuleId(e);if(T)a=location.href;else if(!isAbsolute(l))try{a=toFileUrl(cwd())+"/"}catch(e){a=""}a&&(l=new URL(l,a).href);const c={type:"call",module:l,fn:s,args:null!=t?t:[]},u=(null==r?void 0:r.adapter)||"worker_threads",d=null!==(o=ze.get(u))&&void 0!==o?o:ze.set(u,[]).get(u);let f=d.find((e=>!e.busy));if(f)f.busy=!0,f.lastAccess=Date.now();else{if(!(d.length<i))return new Promise((e=>{qe.push(e)})).then((()=>run$1(l,t,r)));d.push(f={getWorker:createWorker({parallel:_e,adapter:u}),adapter:u,busy:!0,lastAccess:Date.now()}),He||(He=setInterval((()=>{ze.forEach(((e,t)=>{const r=Date.now(),n=[];ze.set(t,e.filter((e=>{const t=!e.busy&&r-e.lastAccess>=1e4;return t&&n.push(e),!t}))),n.forEach((async e=>{const{worker:t}=await e.getWorker;"function"==typeof t.terminate?await t.terminate():t.kill()}))}))}),1e3),unrefTimer(He))}let p,h,m,y,w,v=null,terminate=()=>Promise.resolve(void 0);const g=(null==r?void 0:r.timeout)||(null==r?void 0:r.signal)?abortWith({timeout:null==r?void 0:r.timeout,parent:null==r?void 0:r.signal}):new AbortController,{signal:b}=g;b.addEventListener("abort",(()=>{v||p||(v=b.reason,terminate().then((()=>{handleClose(v,!0)})))}));const handleMessage=async e=>{var t,n;if(isChannelMessage(e))await handleChannelMessage(e);else if(isCallResponse(e))if("return"===e.type||"error"===e.type){if("error"===e.type){const r=isPlainObject(e.error)&&null!==(t=fromObject(e.error))&&void 0!==t?t:e.error;r instanceof Error&&(r.message.includes("not be cloned")||(null===(n=r.stack)||void 0===n?void 0:n.includes("not be cloned"))||r.message.includes("Do not know how to serialize"))&&Object.defineProperty(r,"stack",{configurable:!0,enumerable:!1,writable:!0,value:(r.stack?r.stack+"\n    ":"")+`at ${s} (${l})`}),v=r}else p={value:unwrapReturnValue(e.value)};(null==r?void 0:r.keepAlive)||await terminate(),handleClose(null,!(null==r?void 0:r.keepAlive))}else if("yield"===e.type){const t=unwrapReturnValue(e.value);e.done?handleMessage({type:"return",value:t}):null==m||m.send(t)}},handleClose=(e,t=!1)=>{var r,n,o;if(t){if(f){const e=null===(n=ze.get(u))||void 0===n?void 0:n.filter((e=>e!==f));(null==e?void 0:e.length)?ze.set(u,e):ze.delete(u),qe.length&&(null===(o=qe.shift())||void 0===o||o())}}else null==w||w(),qe.length&&(null===(r=qe.shift())||void 0===r||r());e&&(null!=v||(v=e)),v?h?(h.reject(v),m&&m.close()):m&&(v instanceof Error?m.close(v):"string"==typeof v?m.close(new Error(v)):m.close(new Error("unknown error",{cause:v}))):(null!=p||(p={value:void 0}),h&&h.resolve(p.value),m&&m.close())},safeRemoteCall=async(e,t,n=[])=>{try{"function"==typeof e.postMessage?e.postMessage(t,n):await new Promise(((r,n)=>{e.send(t,(e=>{e?n(e):r()}))}))}catch(t){throw"function"==typeof e.unref&&e.unref(),v=t,(null==r?void 0:r.keepAlive)||await terminate(),handleClose(null,!(null==r?void 0:r.keepAlive)),t}};if(C||$)if("child_process"===u){const e=await f.getWorker,t=e.worker;if(y=e.workerId,t.ref(),t.on("message",handleMessage),t.once("exit",((e,t)=>{v||p||handleClose(new Error(`worker exited (${null!=e?e:t})`),!0)})),w=()=>{t.unref(),t.off("message",handleMessage),t.removeAllListeners("exit"),f&&(f.busy=!1)},terminate=()=>Promise.resolve(void t.kill(1)),v)throw await terminate(),v;const{args:r}=wrapArgs(c.args,Promise.resolve(t));c.args=r,await safeRemoteCall(t,c)}else if(C){const e=await f.getWorker,t=e.worker,handleErrorEvent=e=>{v||p||handleClose(e,!0)};if(y=e.workerId,t.ref(),t.on("message",handleMessage),t.once("error",handleErrorEvent),w=()=>{t.unref(),t.off("message",handleMessage),t.off("error",handleErrorEvent),f&&(f.busy=!1)},terminate=async()=>{await t.terminate()},v)throw await terminate(),v;const{args:r,transferable:n}=wrapArgs(c.args,Promise.resolve(t));c.args=r,await safeRemoteCall(t,c,n)}else{const e=await f.getWorker,t=e.worker,handleCloseEvent=e=>{v||p||handleClose(new Error(e.reason+" ("+e.code+")"),!0)};if(y=e.workerId,t.ref(),t.onmessage=e=>handleMessage(e.data),t.onerror=()=>{t.terminate()},t.addEventListener("close",handleCloseEvent),w=()=>{t.unref(),t.onmessage=null,t.onerror=null,t.removeEventListener("close",handleCloseEvent),f&&(f.busy=!1)},terminate=()=>Promise.resolve(t.terminate()),v)throw await terminate(),v;const{args:r,transferable:n}=wrapArgs(c.args,Promise.resolve(t));c.args=r,await safeRemoteCall(t,c,n)}else{const e=await f.getWorker,t=e.worker;if(y=e.workerId,t.onmessage=e=>handleMessage(e.data),t.onerror=e=>{var r;v||p||(t.terminate(),handleClose(null!==(r=fromErrorEvent(e))&&void 0!==r?r:new Error("worker exited"),!0))},w=()=>{t.onmessage=null,t.onerror=null,f&&(f.busy=!1)},terminate=()=>Promise.resolve(t.terminate()),v)throw await terminate(),v;const{args:r,transferable:n}=wrapArgs(c.args,Promise.resolve(t));c.args=r,await safeRemoteCall(t,c,n)}return{workerId:y,abort(e=void 0){g.abort(e)},async result(){const e=asyncTask();return v?e.reject(v):p?e.resolve(p.value):h=e,await e},iterate(){if(h)throw new TypeError("result() has been called.");if(p)throw new TypeError("The response is not iterable.");return m=chan(1/0),{[Symbol.asyncIterator]:m[Symbol.asyncIterator].bind(m)}}}}!function(e){e.maxWorkers=void 0}(run$1||(run$1={}));var Ke=run$1;const Ve=new Map;function emitWarning(e,t,r,n,o,i,s=!1){if(!n||!Ve.has(t)){let a={};"function"==typeof Error.captureStackTrace?Error.captureStackTrace(a,t):a=new Error("");let l=a.stack.split("\n");const c=l.findIndex((e=>"Error"===e));let u;-1!==c&&0!==c&&(l=l.slice(c)),u="safari"===i?l.find((e=>e.trim().startsWith("module code@")))||l[o]:"bun"!==i||s?l[o]:l.find((e=>e.trim().startsWith("at module code")))||l[o];let d=`${e} is deprecated`;if(r&&(d+=", "+r),u){u=u.trim();let e=u.indexOf("(");if(-1!==e){e+=1;const t=u.indexOf(")",e);u=u.slice(e,t)}d+=" ("+u+")"}console.warn("DeprecationWarning:",d),n&&Ve.set(t,!0)}}const Ge=Symbol.for("value");class Pipeline{constructor(e){this[Ge]=e}get[Symbol.toStringTag](){return"Pipeline"}get value(){return this[Ge]}pipe(e,...t){return new Pipeline(e(this[Ge],...t))}valueOf(){return this[Ge]}}const Je={_try:_try,try:_try,func:function func(e){return function(...t){var r;const n=[],defer=e=>{n.push(e)};let o;try{const r=e.call(this,defer,...t);if(isAsyncGenerator$1(r)){const e=async function*(){var e;let t;for(;;)try{const{done:e,value:n}=await r.next(t);if(e){o={value:n,error:null};break}t=yield Promise.resolve(n)}catch(e){o={value:void 0,error:e};break}for(let t=n.length-1;t>=0;t--)await(null===(e=n[t])||void 0===e?void 0:e.call(n));if(o.error)throw o.error;return o.value}();return e}if(isGenerator(r)){const e=function*(){var e;let t;for(;;)try{const{done:e,value:n}=r.next(t);if(e){o={value:n,error:null};break}t=yield n}catch(e){o={value:void 0,error:e};break}for(let t=n.length-1;t>=0;t--)null===(e=n[t])||void 0===e||e.call(n);if(o.error)throw o.error;return o.value}();return e}if("function"==typeof(null==r?void 0:r.then))return Promise.resolve(r).then((e=>({value:e,error:null}))).catch((e=>({value:void 0,error:e}))).then((async e=>{var t;for(let e=n.length-1;e>=0;e--)await(null===(t=n[e])||void 0===t?void 0:t.call(n));if(e.error)throw e.error;return e.value}));o={value:r,error:null}}catch(e){o={value:void 0,error:e}}for(let e=n.length-1;e>=0;e--)null===(r=n[e])||void 0===r||r.call(n);if(o.error)throw o.error;return o.value}},once:function once(e){let t=le;return()=>(t===le&&(t=e()),t)},wrap:wrap,mixin:function mixin(e,...t){const r={ctor:null};r.ctor=class extends e{};for(const e of t)if("function"==typeof e)mergeHierarchy(r.ctor,e);else{if(!e||"object"!=typeof e)throw new TypeError("Mixin must be a constructor or an object.");mergeIfNotExists(r.ctor.prototype,e)}return r.ctor},throttle:function throttle(e,t){const r="number"==typeof t?null:t.for,n="number"==typeof t?t:t.duration,o="number"!=typeof t&&!!(null==t?void 0:t.noWait),handleCall=function(t,...r){var i;if(t.result&&(t.pending&&o||Date.now()<(null!==(i=t.expires)&&void 0!==i?i:0))){if(t.result.error)throw t.result.error;return t.result.value}if(t.pending)return t.pending;try{const i=e.call(this,...r);if("function"==typeof(null==i?void 0:i.then)){if(t.pending=Promise.resolve(i).finally((()=>{t.result={value:t.pending},t.pending=void 0,t.expires=Date.now()+n})),o&&t.result){if(t.result.error)throw t.result.error;return t.result.value}return t.pending}return t.result={value:i},t.expires=Date.now()+n,i}catch(e){throw t.result={error:e},t.expires=Date.now()+n,e}};if(null==r||""===r){const e={for:null};return function(...t){return handleCall.call(this,e,...t)}}{let e=ce.get(r);return e||(e={for:r},ce.set(r,e)),function(...t){return handleCall.call(this,e,...t)}}},debounce:function debounce(e,t,r=void 0){const n="number"==typeof t?void 0:t.signal,o="number"==typeof t?t:t.delay,i="number"==typeof t?null:t.for,s=null!=i&&""!==i;let a=s?ue.get(i):void 0;a||(a={for:i,tasks:[],data:void 0,timer:void 0},s&&ue.set(i,a));const l=a,getResolvers=e=>{const t=e.tasks,r=e.data;e.tasks=[],e.data=void 0,s&&ue.delete(i);return{resolve:e=>{t.forEach((({resolve:t})=>t(e)))},reject:e=>{t.forEach((({reject:t})=>t(e)))},data:r}};return null==n||n.addEventListener("abort",(()=>{l.timer&&clearTimeout(l.timer);const{reject:e}=getResolvers(l);e(n.reason)})),async function(t){if(null==n?void 0:n.aborted)throw n.reason;"function"==typeof r&&void 0!==l.data?l.data=r(l.data,t):l.data=t,l.timer&&clearTimeout(l.timer),l.timer=setTimeout((t=>{const{resolve:r,reject:n,data:o}=getResolvers(t);try{const t=e.call(this,o);"function"==typeof(null==t?void 0:t.then)?Promise.resolve(t).then(r,n):r(t)}catch(e){n(e)}}),o,l);const i=asyncTask();return l.tasks.push(i),await i}},queue:function queue(e,t=0){return new Queue(e,t)},lock:async function lock(e){let t=ve.get(e);return t||ve.set(e,t=new Mutex(void 0)),await t.lock()},chan:chan,parallel:_e,run:Ke,deprecate:function deprecate(e,...t){var r,n,o,i;const{identity:s}=runtime();if("function"==typeof e){const o=null!==(r=t[0])&&void 0!==r?r:"",i=null!==(n=t[1])&&void 0!==n&&n;return wrap(e,(function wrapped(e,...t){const r={node:2,deno:2,chrome:2,workerd:2,bun:1,safari:1,firefox:3,fastly:3,unknown:3}[s];return emitWarning(e.name+"()",wrapped,o,i,r,s,!0),e.apply(this,t)}))}return emitWarning(e,t[0],null!==(o=t[1])&&void 0!==o?o:"",null!==(i=t[2])&&void 0!==i&&i,{node:1,deno:1,chrome:1,workerd:1,bun:1,safari:1,firefox:3,fastly:3,unknown:3}[s],s,!1)},pipe:function pipe(e){return new Pipeline(e)}};class FilenameTooLongError extends L{constructor(e,t={}){super(e,{...t,name:"FilenameTooLongError",code:414})}}registerErrorType(FilenameTooLongError);class CorruptedArchiveError extends L{constructor(e,t={}){super(e,{...t,name:"ArchiveCorruptedError",code:400})}}var Qe,Ye;registerErrorType(CorruptedArchiveError);const Xe=Symbol.for("stream"),Ze=Symbol.for("bodyUsed");var et;!function(e){e[e.file=0]="file",e[e.link=1]="link",e[e.symlink=2]="symlink",e[e["character-device"]=3]="character-device",e[e["block-device"]=4]="block-device",e[e.directory=5]="directory",e[e.fifo=6]="fifo",e[e["contiguous-file"]=7]="contiguous-file"}(et||(et={}));const tt=512,rt=new Map([["name",100],["mode",8],["uid",8],["gid",8],["size",12],["mtime",12],["checksum",8],["typeflag",1],["linkname",100],["magic",6],["version",2],["uname",32],["gname",32],["devmajor",8],["devminor",8],["prefix",155],["padding",12]]),nt=256;function throwCorruptedArchiveError(){throw new CorruptedArchiveError("The archive is corrupted.")}function parseHeader(e){const t=new TextDecoder,r={};let n=0;for(const[o,i]of rt){const s=e.subarray(n,n+i),a=t.decode(s);r[o]=a,n+=i}const o=getChecksum(e);if(o!==parseInt(r.checksum,8)){if(o===nt)return null;throwCorruptedArchiveError()}if(!r.magic.startsWith("ustar"))throw new TypeError("Unsupported archive format: "+r.magic);return[r,e.subarray(0,n),e.subarray(n)]}function getChecksum(e){let t=nt;for(let r=0;r<tt;r++)r>=148&&r<156||(t+=e[r]);return t}function createEntry(e){var t;const r=stripEnd(trimHeaderField(e.name),"/"),n=trimHeaderField(e.prefix),o=(n?n+"/":"")+r;return{name:basename(o),kind:null!==(t=et[parseInt(e.typeflag)])&&void 0!==t?t:"file",relativePath:o,size:parseInt(e.size,8),mtime:new Date(1e3*parseInt(e.mtime,8)),mode:parseInt(e.mode,8),uid:parseInt(e.uid,8),gid:parseInt(e.gid,8),owner:trimHeaderField(e.uname),group:trimHeaderField(e.gname)}}function trimHeaderField(e){const t=e.indexOf("\0");return(-1===t?e:e.slice(0,t)).trim()}function getEmptyData(e){if("directory"===e.kind)return new Uint8Array(0);throw new TypeError("data must be provided for files.")}const ot=Symbol.for("entries");class Tarball{constructor(){if(this[Qe]=[],this[Ye]=!1,"undefined"==typeof ReadableStream)throw new NotSupportedError("ReadableStream is not supported in this environment.")}constructEntry(e,t,r){var n,o,i,s,a,l,c,u;let d=e,f="";if(d.length>100){let e=d.length;for(;e>=0;){if(e=d.lastIndexOf("/",e),e<=155){f=d.slice(0,e),d=d.slice(e+1);break}e--}if(e<0||d.length>100||f.length>155)throw new FilenameTooLongError("UStar format does not allow a long file name (length of [file nameprefix] + / + [file name] must be shorter than 256 bytes)")}const p=new TextEncoder;let h,m=0,y=r.mtime;if("string"==typeof t){const e=p.encode(t);h=toReadableStream([e]),m=e.byteLength}else if(t instanceof ArrayBuffer)h=toReadableStream([new Uint8Array(t)]),m=t.byteLength;else if(t instanceof Uint8Array)h=toReadableStream([t]),m=t.byteLength;else if(ArrayBuffer.isView(t)){const e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);h=toReadableStream([e]),m=e.byteLength}else if("function"==typeof File&&t instanceof File)h=t.stream(),m=t.size,y=null!==(n=r.mtime)&&void 0!==n?n:new Date(t.lastModified);else if("function"==typeof Blob&&t instanceof Blob)h=t.stream(),m=t.size;else{if(!(t instanceof ReadableStream))throw new TypeError("data must be a string, Uint8Array, ArrayBuffer, ArrayBufferView, Blob, or ReadableStream.");if(h=t,null==r.size)throw new TypeError("size must be provided for ReadableStream data.");m=r.size}null!=y||(y=new Date);const w=null!==(o=r.kind)&&void 0!==o?o:"file",v=null!==(i=r.mode)&&void 0!==i?i:"directory"===w?493:420;"directory"===w&&(m=0);const g={name:d.padEnd(100,"\0"),mode:v.toString(8).padStart(6,"0")+" \0",uid:(null!==(s=r.uid)&&void 0!==s?s:0).toString(8).padStart(6,"0")+" \0",gid:(null!==(a=r.gid)&&void 0!==a?a:0).toString(8).padStart(6,"0")+" \0",size:m.toString(8).padStart(m<8**11?11:12,"0").padEnd(12," "),mtime:Math.floor(y.getTime()/1e3).toString(8).padStart(11,"0").padEnd(12," "),checksum:" ".repeat(8),typeflag:w in et?String(et[w]):"0",linkname:"\0".repeat(100),magic:"ustar\0",version:"00",uname:(null!==(l=r.owner)&&void 0!==l?l:"").padEnd(32,"\0"),gname:(null!==(c=r.group)&&void 0!==c?c:"").padEnd(32,"\0"),devmajor:"\0".repeat(8),devminor:"\0".repeat(8),prefix:f.padEnd(155,"\0"),padding:"\0".repeat(12)},b=new Uint8Array(tt);let E=0;for(const[e,t]of rt){const r=null!==(u=g[e])&&void 0!==u?u:"",n=p.encode(r);if(n.byteLength!==t)throw new TypeError(`Invalid header field length for ${e}: ${n.byteLength}`);b.set(n,E),E+=t}const S=getChecksum(b);b.set(p.encode(S.toString(8).padStart(6,"0")+"\0 "),148);return{name:r.name||("function"==typeof File&&t instanceof File?t.name:basename(e)),kind:w,relativePath:e,size:m,mtime:y,mode:v,uid:r.uid||0,gid:r.gid||0,owner:r.owner||"",group:r.group||"",header:b,body:h}}append(e,t={}){null!=e||(e=getEmptyData(t));let r=t.relativePath;if(!r){if(!("function"==typeof File&&e instanceof File))throw new TypeError("info.relativePath must be provided.");r=e.webkitRelativePath||e.name}const n=dirname(r).replace(/\\/g,"/");n&&"."!==n&&!this[ot].some((e=>e.relativePath===n))&&this.append(null,{kind:"directory",relativePath:n});const o=this.constructEntry(r,e,t);this[ot].push(o)}retrieve(e){const t=this[ot].find((t=>t.relativePath===e));if(!t)return null;const r=omit(t,["header","body"]);return Object.defineProperty(r,"stream",{get(){if(r[Xe])return r[Xe];{const[e,n]=t.body.tee();return t.body=e,r[Xe]=n}}}),r}remove(e){const t=this[ot].findIndex((t=>t.relativePath===e));return-1!==t&&(this[ot].splice(t,1),!0)}replace(e,t,r={}){const n=this[ot].findIndex((t=>t.relativePath===e)),o=-1===n?void 0:this[ot][n];if(!o)return!1;if("directory"===o.kind&&"directory"!==r.kind)return!1;if("directory"!==o.kind&&"directory"===r.kind)return!1;null!=t||(t=getEmptyData(r));const i=this.constructEntry(e,t,r);return this[ot][n]=i,!0}[(Qe=ot,Ye=Ze,Symbol.iterator)](){return this.entries()}*entries(){const e=this[ot][Symbol.iterator]();for(const t of e)yield omit(t,["header","body"])}treeView(){const e=new Date,t=[...this.entries()],{children:r,...n}=makeTree("",t);return{...n,size:0,mtime:e,mode:493,uid:0,gid:0,owner:"",group:"",children:null!=r?r:[]}}get size(){return this[ot].reduce(((e,t)=>{e+=t.header.byteLength,e+=t.size;const r=tt-(t.size%tt||tt);return r>0&&(e+=r),e}),0)+1024}get bodyUsed(){return this[Ze]}stream(e={}){if(this[Ze])throw new TypeError("The body of the tarball has been used.");this[Ze]=!0;const t=[];for(const{size:e,header:r,body:n}of this[ot]){t.push(toReadableStream([r])),t.push(n);const o=tt-(e%tt||tt);o>0&&t.push(toReadableStream([new Uint8Array(o)]))}t.push(toReadableStream([new Uint8Array(1024)]));const r=concat(...t);if(e.gzip){const e=new CompressionStream("gzip");return r.pipeThrough(e)}return r}static async load(e,t={}){if(t.gzip){const t=new DecompressionStream("gzip");e=e.pipeThrough(t)}const r=new Tarball,n=e.getReader();let o=new Uint8Array(0),i=null,s=null,a=null,l=null,c=0,u=0;try{e:for(;;){const{done:e,value:t}=await n.read();if(e)break;for(o=o.byteLength?concat$2(o,t):t;;){if(u>0&&o.byteLength>=u&&(o=o.subarray(u),u=0),!a){if(!(o.byteLength>=tt))break;{const e=parseHeader(o);if(!e){o=new Uint8Array(0);break e}[s,i,o]=e,a=createEntry(s)}}const e=a.size;if(l){{let t=e-c;if(o.byteLength>t){const e=o.subarray(0,t);l.push(e),c+=e.byteLength,o=o.subarray(t)}else l.push(o),c+=o.byteLength,o=new Uint8Array(0)}if(c!==e)break;{const t={...a,header:i,body:toReadableStream(l)};r[ot].push(t),u=tt-(e%tt||tt),c=0,s=null,i=null,a=null,l=null}}else l=[]}}return o.byteLength&&throwCorruptedArchiveError(),r}finally{n.releaseLock()}}}var it,st,at,lt,ct=Object.freeze({__proto__:null,CorruptedArchiveError:CorruptedArchiveError,FilenameTooLongError:FilenameTooLongError,Tarball:Tarball,tar:async function tar(e,t={},r={}){var n,o;let i;e=ensureFsTarget(e),"string"==typeof t?(t=isFileUrl(t)?toFsPath(t):t,i=r.root?t:resolve(t)):"object"==typeof t&&("function"==typeof FileSystemFileHandle&&t instanceof FileSystemFileHandle?i=t:t instanceof URL?i=ensureFsTarget(t):r=t),e="string"!=typeof e||r.root?e:resolve(e);const{signal:s}=r,a="string"==typeof e?basename(e):e.name,l=readDir(e,{...r,recursive:!0}),c=new Tarball;for await(const t of l){let i,l,u,d=null;t.handle?(i=t.relativePath,l=await stat(t.handle)):"string"==typeof e?(i=join(e,t.relativePath),l=await stat(i,r)):(i=t.relativePath,l=await stat(t.relativePath,r)),"directory"!==l.kind&&(d=createReadableStream(null!==(n=t.handle)&&void 0!==n?n:i,r),null==s||s.addEventListener("abort",(()=>{d.cancel(s.reason).catch((()=>{}))}),{once:!0})),u="directory"===l.kind?"directory":"symlink"===l.kind?"symlink":l.isBlockDevice?"block-device":l.isCharDevice?"character-device":l.isFIFO||l.isSocket?"fifo":"file",c.append(d,{name:t.name,kind:u,relativePath:a?a+"/"+t.relativePath:t.relativePath,size:"directory"===t.kind?0:l.size,mtime:null!==(o=l.mtime)&&void 0!==o?o:new Date,mode:l.mode,uid:l.uid,gid:l.gid})}if(!i)return c;const u=createWritableStream(i,r),d=c.stream(r);null==s||s.addEventListener("abort",(()=>{u.abort(s.reason).catch((()=>{}))}),{once:!0}),await d.pipeTo(u)},untar:async function untar(e,t={},r={}){var n;let o;e=e instanceof ReadableStream?e:ensureFsTarget(e),"string"==typeof t?(t=isFileUrl(t)?toFsPath(t):t,o=r.root?t:resolve(t)):"object"==typeof t&&("function"==typeof FileSystemDirectoryHandle&&t instanceof FileSystemDirectoryHandle?o=t:t instanceof URL?o=ensureFsTarget(t):r=t);let i=(e="string"==typeof e&&r.root?resolve(e):e)instanceof ReadableStream?e:createReadableStream(e,r);if(r.gzip){const e=new DecompressionStream("gzip");i=i.pipeThrough(e)}const{signal:s}=r;if(null==s||s.addEventListener("abort",(()=>{i.cancel(s.reason)})),!o)return await Tarball.load(i);"string"==typeof o&&await ensureDir(o,r);let a=0,l=null!==(n=r.size)&&void 0!==n?n:0;if(!l&&r.onProgress)if("string"==typeof e){l=(await stat(e,r)).size}else if("function"==typeof FileSystemFileHandle&&e instanceof FileSystemFileHandle){l=(await e.getFile()).size}const c=[],u=i.getReader();let d=new Uint8Array(0),f=null,p=null,h=0,m=0;try{e:for(;;){const{done:e,value:t}=await u.read();if(e)break;for(d=d.byteLength?concat$2(d,t):t;;){if(m>0&&d.byteLength>=m&&(d=d.subarray(m),m=0),!f){if(!(d.byteLength>=tt))break;{const e=parseHeader(d);if(!e){d=new Uint8Array(0);break e}d=e[2],f=createEntry(e[0]),c.push(f)}}const e=f.size;let t;if(p){const t=d.subarray(0,e-h);await p.write(t),d=d.subarray(e-h),h+=t.byteLength,t.byteLength&&(a+=t.byteLength,r.onProgress&&r.onProgress(createProgressEvent("progress",{lengthComputable:!!l,loaded:a,total:l})))}else{if("directory"!==f.kind){let e=r;"function"==typeof FileSystemDirectoryHandle&&o instanceof FileSystemDirectoryHandle?(e={...r,root:o},t=f.relativePath):t=join(o,f.relativePath);const n=dirname(t);n&&"."!==n&&"/"!==n&&await ensureDir(n,e);p=createWritableStream(t,e).getWriter();continue}"function"==typeof FileSystemDirectoryHandle&&o instanceof FileSystemDirectoryHandle?await ensureDir(f.relativePath,{...r,root:o}):(t=join(o,f.relativePath),await ensureDir(t,r))}if(h!==e)break;m=tt-(e%tt||tt),h=0,null==p||p.close(),p=null,f=null}}d.byteLength?throwCorruptedArchiveError():l&&a<l&&r.onProgress&&(a=l,r.onProgress(createProgressEvent("progress",{lengthComputable:!0,loaded:a,total:l})))}finally{u.releaseLock()}if((j||P)&&"string"==typeof o){const e="windows"===platform(),t=makeTree(basename(o),c);await async function restoreStats(t){var r;for(const n of t){const t=join(o,n.relativePath);"directory"===n.kind&&(null===(r=n.children)||void 0===r?void 0:r.length)&&await restoreStats(n.children),n.mode&&!e&&await chmod(t,n.mode),n.mtime&&await utimes(t,new Date,n.mtime)}}(t.children)}}});!function(e){e.TAB=bytes("\t"),e.LF=bytes("\n"),e.CR=bytes("\r"),e.BS=bytes("\b"),e.DEL=bytes([127]),e.ESC=bytes([27]),e.CTRL_C=bytes([3]),e.CTRL_A=bytes([1]),e.CTRL_E=bytes([5])}(it||(it={})),function(e){e.UP=bytes("[A"),e.DOWN=bytes("[B"),e.LEFT=bytes("[D"),e.RIGHT=bytes("[C"),e.HOME=bytes("[H"),e.END=bytes("[F"),e.PAGE_UP=bytes("[5~"),e.PAGE_DOWN=bytes("[6~"),e.INSERT=bytes("[2~"),e.DELETE=bytes("[3~")}(st||(st={})),function(e){e.F1=bytes("OP"),e.F2=bytes("OQ"),e.F3=bytes("OR"),e.F4=bytes("OS"),e.F5=bytes("[15~"),e.F6=bytes("[17~"),e.F7=bytes("[18~"),e.F8=bytes("[19~"),e.F9=bytes("[20~"),e.F10=bytes("[21~"),e.F11=bytes("[23~"),e.F12=bytes("[24~")}(at||(at={})),function(e){e.CLR=bytes("\r[K"),e.CLR_RIGHT=bytes("[0K"),e.CLR_LEFT=bytes("[1K"),e.CLR_DOWN=bytes("[0J"),e.CLR_UP=bytes("[1J"),e.CLR_SCREEN=bytes("[2J"),e.HIDE_CURSOR=bytes("[?25l"),e.SHOW_CURSOR=bytes("[?25h"),e.MOUSE_ON=bytes("[?1000h"),e.MOUSE_OFF=bytes("[?1000l"),e.MOUSE_WHEEL_ON=bytes("[?1015h"),e.MOUSE_WHEEL_OFF=bytes("[?1015l"),e.PASTE_ON=bytes("[?2004h"),e.PASTE_OFF=bytes("[?2004l"),e.WRAP_ON=bytes("[?7h"),e.WRAP_OFF=bytes("[?7l"),e.ALT_BUFFER_ON=bytes("[?1049h"),e.ALT_BUFFER_OFF=bytes("[?1049l")}(lt||(lt={}));const ut=["ac","asnp","cat","cd","chdir","clc","clear","clhy","cli","clp","cls","clv","cnsn","compare","copy","cp","cpi","cpp","curl","cvpa","dbp","del","diff","dir","dnsn","ebp","echo","epal","epcsv","epsn","erase","etsn","exsn","fc","fl","foreach","ft","fw","gal","gbp","gc","gci","gcm","gcs","gdr","ghy","gi","gjb","gl","gm","gmo","gp","gps","group","gsn","gsnp","gsv","gu","gv","gwmi","h","history","icm","iex","ihy","ii","ipal","ipcsv","ipmo","ipsn","irm","ise","iwmi","iwr","kill","lp","ls","man","help","md","mkdir","measure","mi","mount","move","mp","mv","nal","ndr","ni","nmo","npssc","nsn","nv","ogv","oh","popd","ps","pushd","pwd","r","rbp","rcjb","rcsn","rd","rdr","ren","ri","rjb","rm","rmdir","rmo","rni","rnp","rp","rsn","rsnp","rujb","rv","rvpa","rwmi","sajb","sal","saps","sasv","sbp","sc","select","set","shcm","si"],isFullWidth=e=>12288===e||e>=65281&&e<=65376||e>=65504&&e<=65510,isWide=e=>e>=4352&&e<=4447||8986===e||8987===e||9001===e||9002===e||e>=9193&&e<=9196||9200===e||9203===e||9725===e||9726===e||9748===e||9749===e||e>=9800&&e<=9811||9855===e||9875===e||9889===e||9898===e||9899===e||9917===e||9918===e||9924===e||9925===e||9934===e||9940===e||9962===e||9970===e||9971===e||9973===e||9978===e||9981===e||9989===e||9994===e||9995===e||10024===e||10060===e||10062===e||e>=10067&&e<=10069||10071===e||e>=10133&&e<=10135||10160===e||10175===e||11035===e||11036===e||11088===e||11093===e||e>=11904&&e<=11929||e>=11931&&e<=12019||e>=12032&&e<=12245||e>=12272&&e<=12287||e>=12289&&e<=12350||e>=12353&&e<=12438||e>=12441&&e<=12543||e>=12549&&e<=12591||e>=12593&&e<=12686||e>=12688&&e<=12771||e>=12783&&e<=12830||e>=12832&&e<=12871||e>=12880&&e<=19903||e>=19968&&e<=42124||e>=42128&&e<=42182||e>=43360&&e<=43388||e>=44032&&e<=55203||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65106||e>=65108&&e<=65126||e>=65128&&e<=65131||e>=94176&&e<=94180||94192===e||94193===e||e>=94208&&e<=100343||e>=100352&&e<=101589||e>=101632&&e<=101640||e>=110576&&e<=110579||e>=110581&&e<=110587||110589===e||110590===e||e>=110592&&e<=110882||110898===e||e>=110928&&e<=110930||110933===e||e>=110948&&e<=110951||e>=110960&&e<=111355||126980===e||127183===e||127374===e||e>=127377&&e<=127386||e>=127488&&e<=127490||e>=127504&&e<=127547||e>=127552&&e<=127560||127568===e||127569===e||e>=127584&&e<=127589||e>=127744&&e<=127776||e>=127789&&e<=127797||e>=127799&&e<=127868||e>=127870&&e<=127891||e>=127904&&e<=127946||e>=127951&&e<=127955||e>=127968&&e<=127984||127988===e||e>=127992&&e<=128062||128064===e||e>=128066&&e<=128252||e>=128255&&e<=128317||e>=128331&&e<=128334||e>=128336&&e<=128359||128378===e||128405===e||128406===e||128420===e||e>=128507&&e<=128591||e>=128640&&e<=128709||128716===e||e>=128720&&e<=128722||e>=128725&&e<=128727||e>=128732&&e<=128735||128747===e||128748===e||e>=128756&&e<=128764||e>=128992&&e<=129003||129008===e||e>=129292&&e<=129338||e>=129340&&e<=129349||e>=129351&&e<=129535||e>=129648&&e<=129660||e>=129664&&e<=129672||e>=129680&&e<=129725||e>=129727&&e<=129733||e>=129742&&e<=129755||e>=129760&&e<=129768||e>=129776&&e<=129784||e>=131072&&e<=196605||e>=196608&&e<=262141,dt=[...Object.values(it),...Object.values(st),...Object.values(at)],ft=j?Deno.args:P?process.argv.slice(2):[],pt=j?Deno.stdin.isTerminal():!!P&&process.stdin.isTTY;function charWidth(e){if(u.test(e)){const t=byteLength(e);return 3===t||6===t?1:2}return isWide(e.codePointAt(0))||isFullWidth(e.codePointAt(0))?2:1}function stringWidth(e){return sum(...chars(e).map(charWidth))}function throwNoStdioError(e){throw new I(`No ${e} available`)}const ht=new Mutex(1);async function lockStdin(e){if(!pt)throw new I("Not a terminal");const t=await ht.lock();try{if(j)try{return Deno.stdin.setRaw(!0),await e()}finally{Deno.stdin.setRaw(!1)}else if(P){const{stdin:t}=process;t.isPaused()&&t.resume();const r=[...t.listeners("data")];r.length&&t.removeAllListeners("data");try{return t.setRawMode(!0),await e()}finally{t.setRawMode(!1),r.length?r.forEach((e=>t.addListener("data",e))):t.pause()}}else throwNoStdioError("stdin")}finally{t.unlock()}}async function readStdin(){if(j){const e=Deno.stdin.readable.getReader();try{const{done:t,value:r}=await e.read();return bytes(t?[]:r)}finally{e.releaseLock()}}else{if(P){const e=process.stdin;return new Promise((t=>{const listener=r=>{e.removeListener("data",listener),t(bytes(r))};e.on("data",listener)}))}throwNoStdioError("stdin")}}async function writeStdout(e){j?await Deno.stdout.write(e):P?await new Promise((t=>{process.stdout.write(e,(()=>t()))})):throwNoStdioError("stdout")}function writeStdoutSync(e){j?Deno.stdout.writeSync(e):P?process.stdout.write(e):throwNoStdioError("stdout")}async function moveLeftBy(e){await writeStdout(bytes(`[${stringWidth(e)}D`))}async function moveRightBy(e){await writeStdout(bytes(`[${stringWidth(e)}C`))}function isTypingInput(e){return e.length>0&&!dt.some((t=>equals$3(e,t)))}function getWindowSize(){if(!j)return P?{width:process.stdout.columns,height:process.stdout.rows}:T?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};try{const{columns:e,rows:t}=Deno.consoleSize();return{width:e,height:t}}catch(e){return{width:0,height:0}}}function isWSL(){return"linux"===platform()&&(j?Deno.osRelease().includes("microsoft-standard-WSL"):!!P&&!!process.env.WSL_INTEROP)}function parseValue(e){let t=e.trim();return"true"===t?t=!0:"false"===t?t=!1:/^[-+]?\d+(\.\d+)?$/.test(t)&&(t=Number(t)),t}function parseKeyValue(e,t=!1){let r=e.indexOf("=");if(-1===r)return[e,void 0];{const n=e.slice(0,r),o=e.slice(r+1);return!0===t||Array.isArray(t)&&t.includes(n)?[n,o]:[n,parseValue(o)]}}function parseArgs(e,t={}){var r;const{alias:n={},lists:o=[],noCoercion:i=!1}=t,s={};let a=null,l=0;const set=(e,t)=>{var r;o.includes(e)?(null!==(r=s[e])&&void 0!==r?r:s[e]=[]).push(t):s[e]=t};for(let t=0;t<e.length;t++){const o=e[t];if("--"===o){s["--"]=e.slice(t+1);break}if(o.startsWith("--")){a&&(set(a,!0),a=null);const[e,t]=parseKeyValue(o.slice(2),i);void 0!==t?set(e,t):a=o.slice(2)}else if(o.startsWith("-")){a&&(set(a,!0),a=null);const e=o.slice(1);a=null!==(r=n[e])&&void 0!==r?r:e}else if(a)!0===i||Array.isArray(i)&&i.includes(a)?set(a,o):set(a,parseValue(o)),a=null;else{const e=String(l++);!0===i||Array.isArray(i)&&i.includes(e)?set(e,o):set(e,parseValue(o))}}return a&&set(a,!0),s}function quote(e){return/["'\s]/.test(e)?'"'+e.replace(/(["\\$])/g,"\\$1")+'"':String(e).replace(/([A-Za-z]:)?([#!"$&'()*,:;<=>?@[\\\]^`{|}])/g,"$1\\$2")}async function run(e,t,r={}){const n=r.signal,o="windows"===platform(),i=isWSL()&&e.endsWith("powershell.exe");if(P||j){const{spawn:r}=await import("node:child_process"),{decode:s}=await interop(import("iconv-lite"),!1),a=o&&ut.includes(e)?r("powershell",["-c",e,...t.map(quote)],{signal:n}):r(e,t,{signal:n}),l=[],c=[];a.stdout.on("data",(e=>{o||i?l.push(s(e,"cp936")):l.push(String(e))})),a.stderr.on("data",(e=>{o||i?c.push(s(e,"cp936")):c.push(String(e))}));const u=await new Promise(((e,t)=>{a.once("exit",((t,r)=>{e(null===t&&r?1:null!=t?t:0)})).once("error",t)}));return{code:u,stdout:l.join(""),stderr:c.join("")}}throwUnsupportedRuntimeError()}async function powershell(e,t={}){let r="powershell";return isWSL()&&(r="/mnt/c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe"),await run(r,["-c",e],t)}async function which(e){if("windows"===platform()){const{code:t,stdout:r}=await run("powershell",["-Command",`Get-Command -Name ${e} | Select-Object -ExpandProperty Source`]);return t?null:r.trim()}{const{code:t,stdout:r}=await run("which",[e]);return t?null:r.trim()}}var mt=Object.freeze({__proto__:null,get ControlKeys(){return it},get ControlSequences(){return lt},get FunctionKeys(){return at},get NavigationKeys(){return st},args:ft,charWidth:charWidth,edit:async function edit(e){e=ensureFsTarget(e);const t=(e=await resolveHomeDir(e)).match(/(:|#L)(\d+)/);let r;if(t&&(r=Number(t[2]),e=e.slice(0,t.index)),T)return void window.open("vscode://file/"+trimStart(e,"/")+(r?`:${r}`:""));(A||A||F&&["chrome","firefox","safari"].includes(runtime().identity))&&throwUnsupportedRuntimeError();const n=platform(),o=await which("code"),throwOpenError=(e,t)=>{throw new Error(e||`Unable to open ${t} in the editor.`)};if(o){const t=r?["--goto",`${e}:${r}`]:[e],{code:n,stderr:i}=await run(o,t);return void(n&&throwOpenError(i,e))}if("darwin"===n){const{code:t,stderr:r}=await run("open",["-t",e]);return void(t&&throwOpenError(r,e))}if("windows"===n||isWSL()){const t="windows"===n?"notepad.exe":"/mnt/c/Windows/System32/notepad.exe",{code:r,stderr:o}=await run(t,[e]);return void(r&&throwOpenError(o,e))}let i,s=env("EDITOR")||env("VISUAL")||await which("gedit")||await which("kate")||await which("vim")||await which("vi")||await which("nano");if(!s)throw new Error("Cannot determine which editor to open.");if(s=basename(s),["gedit","kate","vim","vi","nano"].includes(s)&&(i=r?[`+${r}`,e]:[e]),["vim","vi","nano"].includes(s)){if(await which("gnome-terminal")?(i=["--",s,...i],s="gnome-terminal"):(i=["-e",`'${s} ${i.map(quote).join(" ")}'`],s=await which("konsole")||await which("xfce4-terminal")||await which("deepin-terminal")||await which("xterm")),!s)throw new Error("Cannot determine which terminal to open.")}else i=[e];const{code:a,stderr:l}=await run(s,i);a&&throwOpenError(l,e)},getWindowSize:getWindowSize,isTTY:pt,isTypingInput:isTypingInput,isWSL:isWSL,lockStdin:lockStdin,moveLeftBy:moveLeftBy,moveRightBy:moveRightBy,parseArgs:parseArgs,powershell:powershell,quote:quote,readStdin:readStdin,run:run,stringWidth:stringWidth,sudo:async function sudo(e,t,r={}){const n=platform();if("windows"!==n&&!(null==r?void 0:r.gui)||"linux"===n&&!env("DISPLAY")||isWSL())return await run("sudo",[e,...t]);if(!["darwin","windows","linux"].includes(n))throw new I("Unsupported platform");const{exec:o}=await interop(import("sudo-prompt"));return await new Promise(((i,s)=>{o(`${e}`+(t.length?` ${t.map(quote).join(" ")}`:""),{name:(null==r?void 0:r.title)||(j?"Deno":$?"Bun":"NodeJS")},((t,r,o)=>{if(t)s(t);else{let t=String(r);if("windows"===n&&"echo"===e&&t.startsWith('"')){let e=t.lastIndexOf('"');t=t.slice(1,e)+t.slice(e+1)}i({code:0,stdout:t,stderr:String(o)})}}))}))},which:which,writeStdout:writeStdout,writeStdoutSync:writeStdoutSync});var yt=Object.freeze({__proto__:null,alert:async function alert$3(e,t={}){if(T){const{alert:r}=await Promise.resolve().then((function(){return Hr}));await r(e,t)}else if(j||P){const{default:r}=await Promise.resolve().then((function(){return fn}));await r(e,t)}else throwUnsupportedRuntimeError()},confirm:async function confirm$3(e,t={}){if(T){const{confirm:r}=await Promise.resolve().then((function(){return Hr}));return await r(e,t)}if(j||P){const{default:r}=await Promise.resolve().then((function(){return pn}));return await r(e,t)}throwUnsupportedRuntimeError()},downloadFile:async function downloadFile$2(e,t={}){if(T){const{downloadFile:r}=await Promise.resolve().then((function(){return zr}));return r(e,t)}(j||P)&&"function"==typeof fetch||throwUnsupportedRuntimeError();const{downloadFile:r}=await Promise.resolve().then((function(){return Yr}));return r(e,t)},openDirectory:async function openDirectory$2(e={}){if(T){const{openDirectory:e}=await Promise.resolve().then((function(){return zr}));return await e()}if(j||P){const{openDirectory:t}=await Promise.resolve().then((function(){return Yr}));return await t(e)}throwUnsupportedRuntimeError()},openFile:async function openFile$2(e){if(T){const{openFile:t}=await Promise.resolve().then((function(){return zr}));return await t(e)}if(j||P){const{openFile:t}=await Promise.resolve().then((function(){return Yr}));return await t(e)}throwUnsupportedRuntimeError()},openFiles:async function openFiles$2(e={}){if(T){const{openFiles:t}=await Promise.resolve().then((function(){return zr}));return await t(e)}if(j||P){const{openFiles:t}=await Promise.resolve().then((function(){return Yr}));return await t(e)}throwUnsupportedRuntimeError()},pickDirectory:async function pickDirectory$2(e={}){if("function"==typeof globalThis.showDirectoryPicker){const{pickDirectory:e}=await Promise.resolve().then((function(){return zr}));return await e()}if(j||P){const{pickDirectory:t}=await Promise.resolve().then((function(){return Yr}));return await t(e)}throwUnsupportedRuntimeError()},pickFile:async function pickFile$2(e={}){if("function"==typeof globalThis.showOpenFilePicker){const{pickFile:t}=await Promise.resolve().then((function(){return zr}));return await t(e)}if(j||P){const{pickFile:t}=await Promise.resolve().then((function(){return Yr}));return await t(e)}throwUnsupportedRuntimeError()},pickFiles:async function pickFiles$2(e={}){if("function"==typeof globalThis.showOpenFilePicker){const{pickFiles:t}=await Promise.resolve().then((function(){return zr}));return await t(e)}if(j||P){const{pickFiles:t}=await Promise.resolve().then((function(){return Yr}));return await t(e)}throwUnsupportedRuntimeError()},progress:async function progress$3(e,t,r=void 0){if(T){const{progress:n}=await Promise.resolve().then((function(){return Hr}));return await n(e,t,r)}if(j||P){const{default:n}=await Promise.resolve().then((function(){return Qr}));return await n(e,t,r)}throwUnsupportedRuntimeError()},prompt:async function prompt$3(e,t=""){var r,n,o;const i="string"==typeof t?t:t.defaultValue,s="object"==typeof t&&null!==(r=t.type)&&void 0!==r?r:"text",a="password"===s?"object"==typeof t&&null!==(n=t.mask)&&void 0!==n?n:"*":void 0,l="object"==typeof t&&(null!==(o=t.gui)&&void 0!==o&&o),c="object"==typeof t?t.timeout:void 0;if(T){const{prompt:t}=await Promise.resolve().then((function(){return Hr}));return await t(e,{defaultValue:i,type:s,timeout:c})}if(j||P){const{default:t}=await Promise.resolve().then((function(){return hn}));return await t(e,{defaultValue:i,type:s,mask:a,gui:l,timeout:c})}throwUnsupportedRuntimeError()},saveFile:async function saveFile$2(e,t={}){if(T){const{saveFile:r}=await Promise.resolve().then((function(){return zr}));return await r(e,t)}if(j||P){const{saveFile:r}=await Promise.resolve().then((function(){return Yr}));return await r(e,t)}throwUnsupportedRuntimeError()}});function toBytes(e){if("string"==typeof e)return bytes(e);if(e instanceof ArrayBuffer)return new Uint8Array(e);if(e instanceof Uint8Array)return e;if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("Unsupported data type")}async function toBytesAsync(e){if("string"==typeof e||e instanceof ArrayBuffer||ArrayBuffer.isView(e))return toBytes(e);if("function"==typeof ReadableStream&&e instanceof ReadableStream)return new Uint8Array(await readAsArrayBuffer(e));if("function"==typeof Blob&&e instanceof Blob)return new Uint8Array(await e.arrayBuffer());throw new TypeError("Unsupported data type")}function hash$1(e){let t;if("string"==typeof e)t=e;else if(e instanceof ArrayBuffer)t=text(new Uint8Array(e));else if(e instanceof Uint8Array)t=text(e);else{if(!ArrayBuffer.isView(e))throw new TypeError("Unsupported data type");t=text(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}let r=5381,n=t.length;for(;n;)r=33*r^t.charCodeAt(--n);return r>>>0}const wt=(()=>{const e=new Uint32Array(256);for(let t=0;t<256;t++){let r=t;for(let e=0;e<8;e++)r=1&r?3988292384^r>>>1:r>>>1;e[t]=r}return e})();async function sha1$1(e,t=void 0){const r=await toBytesAsync(e),n=await crypto.subtle.digest("SHA-1",r);return"hex"===t?text(new Uint8Array(n),"hex"):"base64"===t?text(new Uint8Array(n),"base64"):n}async function sha256$1(e,t=void 0){const r=await toBytesAsync(e),n=await crypto.subtle.digest("SHA-256",r);return"hex"===t?text(new Uint8Array(n),"hex"):"base64"===t?text(new Uint8Array(n),"base64"):n}async function sha512$1(e,t=void 0){const r=await toBytesAsync(e),n=await crypto.subtle.digest("SHA-512",r);return"hex"===t?text(new Uint8Array(n),"hex"):"base64"===t?text(new Uint8Array(n),"base64"):n}async function hmac$1(e,t,r,n=void 0){const o=await crypto.subtle.importKey("raw",bytes(t),{name:"HMAC",hash:{sha1:"SHA-1",sha256:"SHA-256",sha512:"SHA-512"}[e]},!1,["sign"]),i=await toBytesAsync(r),s=await crypto.subtle.sign("HMAC",o,i);return"hex"===n?text(new Uint8Array(s),"hex"):"base64"===n?text(new Uint8Array(s),"base64"):s}async function nodeHash(e,t,r=void 0){const n=await import("node:crypto"),o=await toBytesAsync(t),i=n.createHash(e);if(i.update(o),r)return i.digest(r);{const e=i.digest();return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}}async function sha256(e,t=void 0){return"object"==typeof crypto&&"object"==typeof crypto.subtle?t?sha256$1(e,t):sha256$1(e):j||P?nodeHash("sha256",e,t):void throwUnsupportedRuntimeError()}var vt,gt,bt,Et,St,kt,xt,Tt,Ot,At,Ft,jt,$t=Object.freeze({__proto__:null,adler32:function adler32(e,t=1){const r=toBytes(e);let n=65535&t,o=t>>>16&65535;for(let e=0;e<r.length;e++)n=(n+r[e])%65521,o=(o+n)%65521;return(o<<16|n)>>>0},crc32:function crc32(e,t=0){const r=toBytes(e);let n=-1^~~t;for(let e=0;e<r.length;e++)n=wt[255&(n^r[e])]^n>>>8;return(-1^n)>>>0},default:hash$1,hmac:async function hmac(e,t,r,n=void 0){if("object"==typeof crypto&&"object"==typeof crypto.subtle)return n?hmac$1(e,t,r,n):hmac$1(e,t,r);if(j||P){const o=await import("node:crypto"),i=await toBytesAsync(r),s=o.createHmac(e,bytes(t));if(s.update(i),n)return s.digest(n);{const e=s.digest();return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}}throwUnsupportedRuntimeError()},md5:async function md5(e,t=void 0){if(j||P)return nodeHash("md5",e,t);throwUnsupportedRuntimeError()},sha1:async function sha1(e,t=void 0){return"object"==typeof crypto&&"object"==typeof crypto.subtle?t?sha1$1(e,t):sha1$1(e):j||P?nodeHash("sha1",e,t):void throwUnsupportedRuntimeError()},sha256:sha256,sha512:async function sha512(e,t=void 0){return"object"==typeof crypto&&"object"==typeof crypto.subtle?t?sha512$1(e,t):sha512$1(e):j||P?nodeHash("sha512",e,t):void throwUnsupportedRuntimeError()}});function setReadonly(e,t,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!1,value:r})}function getReadonly(e,t){var r;return null===(r=Object.getOwnPropertyDescriptor(e,t))||void 0===r?void 0:r.value}function fixStringTag(e){setReadonly(e.prototype,Symbol.toStringTag,e.name)}"function"==typeof MessageEvent&&"workerd"!==runtime().identity||(globalThis.MessageEvent=class MessageEvent extends Event{constructor(e,t=void 0){var r,n,o;super(e,t),this.data=void 0,this.lastEventId="",this.origin="",this.ports=[],this.source=null,t&&(this.data=t.data,this.lastEventId=null!==(r=t.lastEventId)&&void 0!==r?r:"",this.origin=null!==(n=t.origin)&&void 0!==n?n:"",this.ports=null!==(o=t.ports)&&void 0!==o?o:[])}initMessageEvent(e,t=!1,r=!1,n=null,o="",i="",s=null,a=[]){this.initEvent(e,null!=t&&t,null!=r&&r),Object.assign(this,{data:n,origin:o,lastEventId:i,source:s,ports:a})}});const Pt=new TextEncoder,Ct=new TextDecoder,Dt=new Set,Rt=Symbol.for("closed"),Lt=Symbol.for("request"),It=Symbol.for("response"),Nt=Symbol.for("writer"),Bt=Symbol.for("lastEventId"),Ut=Symbol.for("reconnectionTime"),Wt=Symbol.for("retry"),Mt=Symbol.for("timer"),_t=Symbol.for("controller"),zt=Symbol.for("onopen"),Ht=Symbol.for("onerror"),qt=Symbol.for("onmessage");class EventEndpoint extends EventTarget{constructor(e,...t){var r,n,o,i,s;super();const a="socket"in e&&"socket"in t[0];let l;if(a){const o=e;this[Bt]=String(null!==(r=o.headers["last-event-id"])&&void 0!==r?r:""),l=null!==(n=t[1])&&void 0!==n?n:{}}else this[Bt]=null!==(o=e.headers.get("Last-Event-ID"))&&void 0!==o?o:"",l=null!==(i=t[0])&&void 0!==i?i:{};this[Ut]=null!==(s=l.reconnectionTime)&&void 0!==s?s:0,this[Rt]=!!this[Bt]&&Dt.has(this[Bt]);const c={status:this.closed?204:200,statusText:this.closed?"No Content":"OK",headers:{"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive","Transfer-Encoding":"chunked","X-Accel-Buffering":"no"}},u=this;if(a){this[It]=null;const e=t[0],r=new WritableStream({write(t){e.write(t)},close(){e.closed||e.end(),u[Rt]=!0,u.dispatchEvent(createCloseEvent("close",{wasClean:!0}))},abort(t){e.closed||e.destroy(t)}});this[Nt]=r.getWriter(),e.once("close",(()=>{this[Nt].close().catch((()=>{}))})).once("error",(e=>{this[Nt].abort(e).catch((()=>{}))}));for(const[t,r]of Object.entries(c.headers))e.setHeader(t,r);e.writeHead(c.status,c.statusText),e.write(Pt.encode(":ok\n\n"))}else{const{writable:e,readable:t}=new TransformStream,r=t.getReader(),n=new ReadableStream({async start(e){e.enqueue(Pt.encode(":ok\n\n"))},async pull(e){for(;;)try{const{done:t,value:n}=await r.read();if(t){try{e.close()}catch(e){}u[Rt]=!0,u.dispatchEvent(createCloseEvent("close",{wasClean:!0}));break}e.enqueue(n)}catch(t){try{e.error(t)}catch(e){}u[Rt]=!0,u.dispatchEvent(createCloseEvent("close",{reason:t instanceof Error?t.message:String(t),wasClean:!1}));break}},async cancel(e){await r.cancel(e)}});this[Nt]=e.getWriter(),this[It]=new Response(this.closed?null:n,c)}this.closed&&this.close()}get lastEventId(){return this[Bt]}get closed(){return this[Rt]}get response(){return this[It]}addEventListener(e,t,r=void 0){return super.addEventListener(e,t,r)}removeEventListener(e,t,r=void 0){return super.removeEventListener(e,t,r)}dispatchEvent(e){return e instanceof MessageEvent?("message"===e.type?this.send(e.data,e.lastEventId).catch((()=>{})):this.sendEvent(e.type,e.data,e.lastEventId).catch((()=>{})),!e.cancelable||!e.defaultPrevented):super.dispatchEvent(e)}buildMessage(e,t={}){let r="";return t.id&&(this[Bt]=t.id,r+=`id: ${t.id}\n`),t.event&&(r+=`event: ${t.event}\n`),this[Ut]&&(r+=`retry: ${this[Ut]}\n`),r+=e.split(/\r\n|\n/).map((e=>`data: ${e}\n`)).join(""),r+="\n",Pt.encode(r)}async send(e,t=void 0){await this[Nt].write(this.buildMessage(e,{id:t}))}async sendEvent(e,t,r=void 0){await this[Nt].write(this.buildMessage(t,{id:r,event:e}))}close(e=!1){this[Nt].close().catch((()=>{})).finally((()=>{this[Rt]=!0,this.lastEventId&&(Dt.has(this.lastEventId)?Dt.delete(this.lastEventId):e&&Dt.add(this.lastEventId))}))}}async function readAndProcessResponse(e,t){const r=e.body.getReader();let n="";try{for(;;){const{done:e,value:o}=await r.read();if(e){t.onEnd();break}n+=Ct.decode(o);const i=n.split(/\r\n\r\n|\n\n/);if(1!==i.length){n=i.pop();for(const e of i){const r=e.split(/\r\n|\n/);let n="",o="message",i=!1;for(const e of r)if(e.startsWith("data:")||"data"===e){let t=e.slice(5);" "===t[0]&&(t=t.slice(1)),n?n+="\n"+t:n=t,i=!0}else if(e.startsWith("event:")||"event"===e)o=e.slice(6).trim(),i=!0;else if(e.startsWith("id:")||"id"===e)t.onId(e.slice(3).trim()),i=!0;else if(e.startsWith("retry:")){const r=parseInt(e.slice(6).trim());!isNaN(r)&&r>=0&&(t.onRetry(r),i=!0)}i&&t.onData(n,o||"message")}}}}catch(e){t.onError(e)}}fixStringTag(EventEndpoint);class EventSource extends EventTarget{get url(){var e;return null!==(e=getReadonly(this,"url"))&&void 0!==e?e:""}get withCredentials(){var e;return null!==(e=getReadonly(this,"withCredentials"))&&void 0!==e&&e}get readyState(){var e;return null!==(e=getReadonly(this,"readyState"))&&void 0!==e?e:this.CONNECTING}get onopen(){var e;return null!==(e=this[zt])&&void 0!==e?e:null}set onopen(e){this[zt]=e}get onmessage(){var e;return null!==(e=this[qt])&&void 0!==e?e:null}set onmessage(e){this[qt]=e}get onerror(){var e;return null!==(e=this[Ht])&&void 0!==e?e:null}set onerror(e){this[Ht]=e}constructor(e,t={}){var r;super(),this[vt]=new AbortController,this[gt]=null,this[bt]="",this[Et]=0,this[St]=0,this[kt]=null,this[xt]=null,this[Tt]=null,this[Ot]=null,this.CONNECTING=EventSource.CONNECTING,this.OPEN=EventSource.OPEN,this.CLOSED=EventSource.CLOSED,setReadonly(this,"url",e="object"==typeof e?e.href:new URL(e,"object"==typeof location?location.href:void 0).href),setReadonly(this,"withCredentials",null!==(r=t.withCredentials)&&void 0!==r&&r),setReadonly(this,"readyState",this.CONNECTING),setReadonly(this,"CONNECTING",EventSource.CONNECTING),setReadonly(this,"OPEN",EventSource.OPEN),setReadonly(this,"CLOSED",EventSource.CLOSED),this.connect().catch((()=>{}))}async connect(){var e,t,r,n,o,i,s;if(this.readyState===this.CLOSED)return;setReadonly(this,"readyState",this.CONNECTING);const a={Accept:"text/event-stream"};this[Bt]&&(a["Last-Event-ID"]=this[Bt]),this[Lt]=new Request(this.url,{headers:a,credentials:this.withCredentials?"include":"same-origin",cache:"no-store",signal:this[_t].signal});const l=await Te(fetch(this[Lt]));if(!l.ok){const t=createErrorEvent("error",{error:l.error});return this.dispatchEvent(t),null===(e=this.onerror)||void 0===e||e.call(this,t),void this.tryReconnect()}const c=l.value;if("error"===c.type){const e=createErrorEvent("error",{error:new NetworkError(`Failed to fetch '${this.url}'`)});return this.dispatchEvent(e),null===(t=this.onerror)||void 0===t||t.call(this,e),void this.tryReconnect()}if(204===c.status)return void setReadonly(this,"readyState",this.CLOSED);if(200!==c.status){setReadonly(this,"readyState",this.CLOSED);const e=createErrorEvent("error",{error:new TypeError(`The server responded with status ${c.status}.`)});return this.dispatchEvent(e),void(null===(r=this.onerror)||void 0===r||r.call(this,e))}if(!(null===(n=c.headers.get("Content-Type"))||void 0===n?void 0:n.startsWith("text/event-stream"))){setReadonly(this,"readyState",this.CLOSED);const e=createErrorEvent("error",{error:new TypeError("The response is not an event stream.")});return this.dispatchEvent(e),void(null===(o=this.onerror)||void 0===o||o.call(this,e))}if(!c.body){setReadonly(this,"readyState",this.CLOSED);const e=createErrorEvent("error",{error:new TypeError("The response does not have a body.")});return this.dispatchEvent(e),void(null===(i=this.onerror)||void 0===i||i.call(this,e))}setReadonly(this,"readyState",this.OPEN),this[Wt]=0;const u=new Event("open");this.dispatchEvent(u),null===(s=this.onopen)||void 0===s||s.call(this,u);const d=new URL(c.url||this.url).origin;await readAndProcessResponse(c,{onId:e=>{this[Bt]=e},onRetry:e=>{this[Ut]=e},onData:(e,t)=>{var r;const n=new MessageEvent(t,{lastEventId:this[Bt],data:e,origin:d});this.dispatchEvent(n),null===(r=this.onmessage)||void 0===r||r.call(this,n)},onError:e=>{var t;if(this.readyState!==this.CLOSED){const r=createErrorEvent("error",{error:e});this.dispatchEvent(r),null===(t=this.onerror)||void 0===t||t.call(this,r),this.tryReconnect()}},onEnd:()=>{var e;if(this.readyState!==this.CLOSED){const t=createErrorEvent("error",{error:new Error("The connection is interrupted.")});this.dispatchEvent(t),null===(e=this.onerror)||void 0===e||e.call(this,t),this.tryReconnect()}}})}tryReconnect(){setReadonly(this,"readyState",this.CONNECTING),this[Mt]&&clearTimeout(this[Mt]),this[Mt]=setTimeout((()=>{this.connect().catch((()=>{}))}),this[Ut]||1e3*Math.min(30,Math.pow(2,this[Wt]++)))}close(){this[Mt]&&(clearTimeout(this[Mt]),this[Mt]=null),setReadonly(this,"readyState",this.CLOSED),this[_t].abort()}addEventListener(e,t,r=void 0){return super.addEventListener(e,t,r)}removeEventListener(e,t,r=void 0){return super.removeEventListener(e,t,r)}[(vt=_t,gt=Lt,bt=Bt,Et=Ut,St=Wt,kt=Mt,xt=zt,Tt=qt,Ot=Ht,K)](){const e=this;return j?"EventSource "+Deno.inspect({readyState:e.readyState,url:e.url,withCredentials:e.withCredentials,onopen:e.onopen,onmessage:e.onmessage,onerror:e.onerror},{colors:!0}):new class EventSource{constructor(){this.readyState=e.readyState,this.url=e.url,this.withCredentials=e.withCredentials,this.onopen=e.onopen,this.onmessage=e.onmessage,this.onerror=e.onerror}}}}EventSource.CONNECTING=0,EventSource.OPEN=1,EventSource.CLOSED=2,fixStringTag(EventSource);class EventConsumer extends EventTarget{constructor(e){var t;if(super(),this[At]="",this[Ft]=0,this[jt]=!1,!e.body)throw new TypeError("The response does not have a body.");if(e.bodyUsed)throw new TypeError("The response body has already been used.");if(e.body.locked)throw new TypeError("The response body is locked.");if(!(null===(t=e.headers.get("Content-Type"))||void 0===t?void 0:t.startsWith("text/event-stream")))throw new TypeError("The response is not an event stream.");const r=e.url?new URL(e.url).origin:"";readAndProcessResponse(e,{onId:e=>{this[Bt]=e},onRetry:e=>{this[Ut]=e},onData:(e,t)=>{this.dispatchEvent(new MessageEvent(t,{lastEventId:this[Bt],data:e,origin:r}))},onError:e=>{this[Rt]=!0,this.dispatchEvent(createErrorEvent("error",{error:e})),this.dispatchEvent(createCloseEvent("close",{reason:e instanceof Error?e.message:String(e),wasClean:!1}))},onEnd:()=>{this[Rt]=!0,this.dispatchEvent(createCloseEvent("close",{wasClean:!0}))}}).catch((()=>{}))}get lastEventId(){return this[Bt]}get retry(){return this[Ut]}get closed(){return this[Rt]}addEventListener(e,t,r=void 0){return super.addEventListener(e,t,r)}removeEventListener(e,t,r=void 0){return super.removeEventListener(e,t,r)}}At=Bt,Ft=Ut,jt=Rt,fixStringTag(EventConsumer);var Kt,Vt,Gt,Jt=Object.freeze({__proto__:null,EventConsumer:EventConsumer,EventEndpoint:EventEndpoint,EventSource:EventSource});function constructNetAddress(e){return Object.assign(e,{family:e.hostname.includes(":")?"IPv6":"IPv4"}),Object.defineProperty(e,"address",{enumerable:!1,get(){return this.hostname}}),e}const Qt=Symbol.for("hostname"),Yt=Symbol.for("port"),Xt=Symbol.for("http"),Zt=Symbol.for("controller");class HttpServer{constructor(e,t){var r,n,o;this[Kt]="0.0.0.0",this[Vt]=0,this[Gt]=null,this.type=null!==(r=t.type)&&void 0!==r?r:"classic";const{fetch:i,ws:s,headers:a,secure:l}=t,c=null!==(n=t.onError)&&void 0!==n?n:e=>(console.error(e),new Response("Internal Server Error",{status:500,statusText:"Internal Server Error"})),defaultOnListen=({hostname:e,port:t})=>{const r="0.0.0.0"===e?"localhost":e,n=l?"https":"http";console.log(`Server listening on ${n}://${r}:${t}`)},u="classic"===this.type&&null!==(o=t.onListen)&&void 0!==o?o:defaultOnListen;if(this[Xt]=e().then((({http:e,hostname:t,port:r,controller:n})=>(this[Qt]=t,this[Yt]=r,this[Zt]=n,(e||$)&&u({hostname:t,port:r}),e))),j)"classic"===this.type?delete this.fetch:this.fetch=(e,t)=>{const{getTimers:r,time:n,timeEnd:o}=createTimingFunctions(),l=createRequestContext(e,{ws:s,remoteAddress:t?constructNetAddress({hostname:t.remoteAddr.hostname,port:t.remoteAddr.port}):null,time:n,timeEnd:o}),u=withHeaders(i,a),d=withHeaders(c,a);return u(e,l).then((e=>patchTimingMetrics(e,r()))).catch((t=>d(t,e,l)))};else if($)"classic"===this.type?delete this.fetch:(this.fetch=(e,t)=>{s.bunBind(t);const{getTimers:r,time:n,timeEnd:o}=createTimingFunctions(),l=t.requestIP(e),u=createRequestContext(e,{ws:s,remoteAddress:l?constructNetAddress({hostname:l.address,port:l.port}):null,time:n,timeEnd:o}),d=withHeaders(i,a),f=withHeaders(c,a);return d(e,u).then((e=>patchTimingMetrics(e,r()))).catch((t=>f(t,e,u)))},Object.assign(this,{websocket:s.bunListener}));else if(C)"classic"===this.type?delete this.fetch:this.fetch=(e,t)=>{const r=withHeaders(i,a),n=withHeaders(c,a);return r(e,t).catch((r=>n(r,e,t)))};else if("function"==typeof addEventListener)if("classic"===this.type){let e;"workerd"===runtime().identity&&(e={},Object.keys(globalThis).forEach((t=>{/^[A-Z][A-Z0-9_]*$/.test(t)&&(e[t]=globalThis[t])})),env(e)),listenFetchEvent({ws:s,fetch:i,onError:c,headers:a,bindings:e})}else this.fetch=(e,t,r)=>{var n;t&&"object"==typeof t&&!Array.isArray(t)&&env(t);const o=e.headers.get("cf-connecting-ip"),{getTimers:l,time:u,timeEnd:d}=createTimingFunctions(),f=createRequestContext(e,{ws:s,remoteAddress:o?constructNetAddress({hostname:o,port:0}):null,time:u,timeEnd:d,waitUntil:null===(n=r.waitUntil)||void 0===n?void 0:n.bind(r),bindings:t}),p=withHeaders(i,a),h=withHeaders(c,a);return p(e,f).then((e=>patchTimingMetrics(e,l()))).catch((t=>h(t,e,f)))}}get hostname(){return this[Qt]||""}get port(){return this[Yt]||($&&"module"===this.type?3e3:0)}get ready(){return this[Xt].then((()=>this))}async close(e=!1){const t=await this[Xt];if(t)if("function"==typeof t.stop){const r=t;r.stop(e),e||await until((()=>!r.pendingRequests&&!r.pendingWebSockets))}else if("function"==typeof t.shutdown){const r=t;e&&this[Zt]?this[Zt].abort():r.shutdown(),await r.finished}else if("function"==typeof t.close){const r=t;await new Promise(((t,n)=>{r.close((e=>e?n(e):t())),e&&"closeAllConnections"in r&&r.closeAllConnections()}))}}ref(){this[Xt].then((e=>{var t;null===(t=null==e?void 0:e.ref)||void 0===t||t.call(e)}))}unref(){this[Xt].then((e=>{var t;null===(t=null==e?void 0:e.unref)||void 0===t||t.call(e)}))}}function sanitizeTimers(e){const t=e.get("total"),r=new Map([...e].filter((([e,t])=>!!t.timeEnd&&"total"!==e)));return(null==t?void 0:t.timeEnd)&&r.set("total",t),r}function createTimingFunctions(){const e=new Map;return{timers:e,getTimers:(t=!1)=>t?sanitizeTimers(e):e,time:(t,r)=>{e.has(t)?console.warn(`Timer '${t}' already exists`):e.set(t,{timeStart:Date.now(),description:r})},timeEnd:t=>{const r=e.get(t);r?r.timeEnd=Date.now():console.warn(`Timer '${t}' does not exist`)}}}function createRequestContext(e,t){const{ws:r,remoteAddress:n=null,...o}=t,i={remoteAddress:n,upgradeEventEndpoint:()=>{const t=new EventEndpoint(e);return{endpoint:t,response:t.response}},upgradeWebSocket:()=>r.upgrade(e),...o};return Object.defineProperty(i,"createEventEndpoint",{enumerable:!0,value:()=>{const t=new EventEndpoint(e);return{events:t,response:t.response}}}),i}function patchTimingMetrics(e,t){const r=[...sanitizeTimers(t)].map((([e,t])=>{let r=`${e};dur=${t.timeEnd-t.timeStart}`;return t.description?r+=`;desc="${t.description}"`:"total"===e&&(r+=';desc="Total"'),r})).join(", ");if(r)try{e.headers.set("Server-Timing",r)}catch(e){}return e}function withHeaders(e,t=void 0){if(void 0===t){const{identity:e,version:r}=runtime();let n={node:"Node.js",deno:"Deno",bun:"Bun",workerd:"Cloudflare Workers",fastly:"Fastly Compute"}[e]||"Unknown";r&&(n+=`/${r}`),t={Server:n}}return async(...r)=>{const n=await e(...r);if(101===n.status)return n;try{const patch=(e,t)=>{n.headers.has(e)||n.headers.set(e,t)};t instanceof Headers?t.forEach(((e,t)=>patch(t,e))):Array.isArray(t)?t.forEach((([e,t])=>patch(e,t))):null!==t&&Object.entries(t).forEach((([e,t])=>patch(e,t)))}catch(e){}return n}}function listenFetchEvent(e){const{ws:t,fetch:r,headers:n,onError:o,bindings:i}=e;addEventListener("fetch",(e=>{var s,a,l;const{request:c}=e,u=null!==(s=c.headers.get("cf-connecting-ip"))&&void 0!==s?s:null===(a=e.client)||void 0===a?void 0:a.address,{getTimers:d,time:f,timeEnd:p}=createTimingFunctions(),h=createRequestContext(c,{ws:t,remoteAddress:u?constructNetAddress({hostname:u,port:0}):null,time:f,timeEnd:p,waitUntil:null===(l=e.waitUntil)||void 0===l?void 0:l.bind(e),bindings:i}),m=withHeaders(r,n),y=withHeaders(o,n),w=m(c,h).then((e=>patchTimingMetrics(e,d()))).catch((e=>y(e,c,h)));e.respondWith(w)}))}function withWeb(e){return async(t,r)=>{var n,o;const i=constructNetAddress({hostname:t.socket.remoteAddress,port:t.socket.remotePort}),s=function toWebRequest(e){var t,r;const n=e.socket.encrypted||"https"===e.headers[":scheme"]?"https":"http",o=null!==(t=e.headers[":authority"])&&void 0!==t?t:e.headers.host,i=new URL(null!==(r=e.url)&&void 0!==r?r:"/",`${n}://${o}`),s=new Headers(Object.fromEntries(Object.entries(e.headers).filter((([e])=>"string"==typeof e&&!e.startsWith(":")))));e.headers[":authority"]&&s.set("Host",e.headers[":authority"]);const a=new AbortController,l={method:e.method,headers:s,signal:a.signal},c=s.get("Cache-Control"),u=s.get("Sec-Fetch-Mode"),d=s.get("Referer");l.cache="no-cache"===c?"no-cache":"no-store"===c?"no-store":"only-if-cached"===c&&"same-origin"===u?"only-if-cached":"default";l.mode="no-cors"===u?"no-cors":"same-origin"===u?"same-origin":"cors";d&&(l.referrer=d);"GET"!==e.method&&"HEAD"!==e.method&&"OPTIONS"!==e.method&&(l.body=new ReadableStream({type:"bytes",start(t){e.on("data",(r=>{const n=new Uint8Array(r.buffer,r.byteOffset,r.byteLength),o=getByobRequest(t);if(o){const e=o.view,r=e.byteLength;n.byteLength<=r?(e.set(n),o.respond(n.byteLength)):(e.set(n.subarray(0,r)),o.respond(r),t.enqueue(n.subarray(r)))}else t.enqueue(n);"number"==typeof t.desiredSize&&t.desiredSize<=0&&e.pause()})).once("error",(e=>{t.error(e)})).once("end",(()=>{var e;t.close(),null===(e=getByobRequest(t))||void 0===e||e.respond(0)}))},pull(){e.resume()}},{highWaterMark:e.readableHighWaterMark}),l.duplex="half");e.once("close",(()=>{e.errored&&(e.errored.message.includes("aborted")?a.abort(new DOMException("The request has been cancelled.","AbortError")):a.abort(e.errored))}));const f=new Request(i,l);e.headers[":authority"]||Object.assign(f,{[Symbol.for("incomingMessage")]:e});return f}(t),a=await e(s,{remoteAddress:i});if(r.req||Object.assign(r,{req:t}),a&&!r.headersSent){if(101===a.status)return;const e=null!==(o=null===(n=s.headers.get("Accept-Encoding"))||void 0===n?void 0:n.includes("gzip"))&&void 0!==o&&o;await async function toNodeResponse(e,t,r=!1){var n,o,i;const{status:s,statusText:a,headers:l}=e,c=e.body?Number(null!==(n=l.get("Content-Length"))&&void 0!==n?n:0):0,u=null===(o=l.get("Content-Type"))||void 0===o?void 0:o.split(";")[0];let d=e.body;for(const[e,r]of l)t.setHeader(capitalize(e,!0),r);if(d&&r&&"function"==typeof CompressionStream&&(c>20||!l.has("Content-Length"))&&!l.has("Content-Encoding")&&!l.has("Content-Range")&&!(null===(i=l.get("Cache-Control"))||void 0===i?void 0:i.includes("no-transform"))&&u&&function isCompressible(e){return"text/event-stream"!==e&&er.test(e)}(u)){d=d.pipeThrough(new CompressionStream("gzip")),t.removeHeader("Content-Length"),t.setHeader("Content-Encoding","gzip"),t.setHeader("Vary","Accept-Encoding");const e=l.get("ETag");e&&!e.startsWith("W/")&&t.setHeader("ETag",`W/${e}`)}"2.0"===t.req.httpVersion?t.writeHead(s):t.writeHead(s,a);if(d){const e=d.getReader();for(t.once("close",(()=>{t.errored?e.cancel(t.errored):e.cancel()}));;)try{const{done:r,value:n}=await e.read();if(r){n?t.end(n):t.end();break}await new Promise((e=>{t.write(n)?e():t.once("drain",e)}))}catch(e){t.destroyed||t.destroy(e instanceof Error?e:new Error(String(e)));break}}else t.end()}(a,r,e)}}}function getByobRequest(e){var t;return"byobRequest"in e&&(null===(t=e.byobRequest)||void 0===t?void 0:t.view)?e.byobRequest:null}Kt=Qt,Vt=Yt,Gt=Zt;const er=/^text\/|^application\/(.+\+)?(json|yaml|toml|xml|javascript|dart|tar|fontobject|opentype)$|^font\/(otf|ttf)$|^image\/((x-ms-)?bmp|svg\+xml|(vnd\.microsoft\.|x-)icon)|vnd\.adobe\.photoshop/;function parseCookie(e){const[t,...r]=e.split(";").map((e=>e.trim()));if(!t||!t.includes("="))throw new SyntaxError("Invalid Set-Cookie header");const[n,o]=t.split("="),i={name:n,value:o};for(const e of r)if(e){const[t,r=""]=e.split("=");"Domain"===t?i.domain=r:"Expires"===t?i.expires=new Date(r).valueOf():"Max-Age"===t?i.maxAge=parseInt(r):"HttpOnly"===t?i.httpOnly=!0:"Secure"===t?i.secure=!0:"Path"===t?i.path=r||"/":"SameSite"===t&&r?i.sameSite=r.toLowerCase():"Partitioned"===t&&(i.partitioned=!0)}return i}function stringifyCookie(e){let t=`${e.name}=${e.value}`;return e.domain&&(t+=`; Domain=${e.domain}`),e.path&&(t+=`; Path=${e.path}`),e.expires&&(t+=`; Expires=${new Date(e.expires).toUTCString()}`),e.maxAge&&(t+=`; Max-Age=${e.maxAge}`),e.httpOnly&&(t+="; HttpOnly"),e.secure&&(t+="; Secure"),e.sameSite&&(t+=`; SameSite=${capitalize(e.sameSite)}`),e.partitioned&&(t+="; Partitioned"),t}function parseCookies(e){return e?e.split(/;\s*/g).reduce(((e,t)=>{const[r,n]=t.split("=");return r&&void 0!==n&&e.push({name:r,value:n}),e}),[]):[]}function stringifyCookies(e){return e.map((({name:e,value:t})=>`${e}=${t}`)).join("; ")}function getCookies(e){var t;return"ok"in e&&"status"in e?e.headers.getSetCookie().map((e=>parseCookie(e))):parseCookies(null!==(t=e.headers.get("Cookie"))&&void 0!==t?t:"")}function parseAccepts(e){return e.split(",").map((e=>{const[t,r]=e.split(";q=");return{type:t.trim(),weight:r?parseFloat(r):1}})).sort(((e,t)=>t.weight-e.weight))}function parseContentDisposition(e){const t=e.indexOf(";"),r=-1===t?e.trim():e.slice(0,t).trim();if(e=-1===t?"":e.slice(t+1).trim(),"inline"===r)return{type:r};if("attachment"===r)return{type:r,filename:parseContentDispositionFilename(e)};if("form-data"===r){const t=e.match(/name="([^"]+)"/);if(!t)throw new SyntaxError("Invalid Content-Disposition header: missing 'name' parameter");return{type:r,name:t[1],filename:parseContentDispositionFilename(e)}}throw new SyntaxError("Invalid Content-Disposition header: unknown type")}function parseContentDispositionFilename(e){const t=e.match(/filename\*?=(?:UTF-8''|")?([^";]+)/);return t?decodeURIComponent(t[1]):void 0}function parseRange(e){if(!e.includes("="))throw new SyntaxError("Invalid Range header");const[t,r]=e.split("=").map((e=>e.trim())),n={unit:t,ranges:[]};for(const e of r.split(",")){if(!e||!e.includes("-"))continue;const[t,r]=e.split("-").map((e=>e.trim()));(t||r)&&(t?r?n.ranges.push({start:parseInt(t),end:parseInt(r)}):n.ranges.push({start:parseInt(t)}):n.suffix=parseInt(r))}if(!n.ranges.length&&!n.suffix||n.ranges.some((e=>e.start<0||e.end&&e.end<=e.start)))throw new SyntaxError("Invalid Range header");return n}function ifMatch(e,t){if(!e||t.startsWith("W/"))return!1;if("*"===e.trim())return!0;return e.split(/\s*,\s*/).includes(t)}function ifNoneMatch(e,t){if(!e)return!0;if("*"===e.trim())return!1;return!e.split(/\s*,\s*/).map((e=>e.startsWith("W/")?stripEnd(stripStart(e.slice(2),'"'),'"'):e)).includes(t)}function parseBasicAuth(e){const t=e.split(" "),r=t[0].toLowerCase(),n=t.slice(1).join(" ");if(r&&n){if("basic"!==r)throw new TypeError("Authorization scheme is not 'Basic'");{const[e,t]=text(bytes(n,"base64")).split(":");return{username:e,password:t}}}throw new SyntaxError("Invalid Authorization header")}const tr=["GET","HEAD","POST","PUT","DELETE","CONNECT","OPTIONS","TRACE","PATCH"];function throwInvalidMessageError(){throw new SyntaxError("Invalid message")}function parseMessage(e){const t=e.indexOf("\r\n\r\n");-1===t&&throwInvalidMessageError();const r=new Headers,n=e.slice(0,t).split("\r\n");for(let e=0;e<n.length;e++){const t=n[e],o=e+1,i=t.indexOf(":");if(-1===i)throw new SyntaxError("Invalid token in line "+o);const s=t.slice(0,i),a=t.slice(i+1).trim();try{r.append(s,a)}catch(e){throw new SyntaxError(`Invalid header name '${s}' in line ${o}`)}}let o=e.slice(t+4);if("chunked"===r.get("Transfer-Encoding")){const e=new TextDecoder,t=new TextEncoder,r=t.encode("\r\n"),n=[];let i=t.encode(o);for(;i.length;){const t=indexOfSlice(i,r);if(-1===t)throw new SyntaxError("Invalid chunked body");const o=parseInt(e.decode(i.subarray(0,t)),16);if(!Number.isInteger(o)||o<0)throw new SyntaxError("Invalid chunk length");if(0===o)break;const s=t+2,a=s+o,l=i.subarray(s,a);if(l.length!==o)throw new SyntaxError("Invalid chunk");n.push(l),i=i.subarray(a+2)}o=concat$2(...n)}return{headers:r,body:o}}const rr=Symbol.for("impl");class Socket{constructor(e){this[rr]=e}get closed(){return this[rr].closed}close(){return this[rr].close()}ref(){return this[rr].ref()}unref(){return this[rr].unref()}[Symbol.dispose](){return this.close()}}class SocketStream extends Socket{constructor(e){super(e),this[rr]=e}get readable(){return this[rr].readable}get writable(){return this[rr].writable}}class TcpSocketStream extends SocketStream{constructor(e){super(e),this[rr]=e}get localAddress(){return this[rr].localAddress}get remoteAddress(){return this[rr].remoteAddress}setKeepAlive(e=void 0){return this[rr].setKeepAlive(e)}setNoDelay(e=void 0){return this[rr].setNoDelay(e)}}class UnixSocketStream extends SocketStream{}class UdpSocket extends Socket{constructor(e){super(e),this[rr]=e}get localAddress(){return this[rr].localAddress}receive(){return this[rr].receive()}send(e,t){return this[rr].send(e,t)}connect(e){return this[rr].connect(e)}joinMulticast(e,t=void 0){return this[rr].joinMulticast(e,t)}leaveMulticast(e,t=void 0){return this[rr].leaveMulticast(e,t)}setBroadcast(e){return this[rr].setBroadcast(e)}setMulticastLoopback(e){return this[rr].setMulticastLoopback(e)}setMulticastTTL(e){return this[rr].setMulticastTTL(e)}setTTL(e){return this[rr].setTTL(e)}async*[Symbol.asyncIterator](){for(;;)try{const e=await this.receive();yield e}catch(e){break}}}class UdpSocketStream extends Socket{constructor(e){super(e),this[rr]=e}get localAddress(){return this[rr].localAddress}get remoteAddress(){return this[rr].remoteAddress}get readable(){return this[rr].readable}get writable(){return this[rr].writable}}async function getInternetIp(){const e=await fetch("https://checkip.amazonaws.com");if(e.ok){const t=(await e.text()).match(/\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/);if(t)return t[0];throw new Error("Failed to parse IP address from response")}throw new Error(`Failed to fetch IP address: ${e.status} ${e.statusText}`)}async function randomPort$1(e=void 0,t=void 0){if(t||(t="0.0.0.0"),j)try{const r=Deno.listen({hostname:t,port:null!=e?e:0}),{port:n}=r.addr;return r.close(),Promise.resolve(n)}catch(t){if(e)return randomPort$1(0);throw t}else if($)try{const r=Bun.listen({hostname:t,port:null!=e?e:0,socket:{data:()=>{}}}),{port:n}=r;return r.stop(!0),Promise.resolve(n)}catch(t){if(e)return randomPort$1(0);throw t}else{if(C){const{createServer:r,connect:n}=await import("node:net");if(e){const r=await new Promise(((r,o)=>{const i=n(e,"0.0.0.0"===t?"localhost":t);i.once("connect",(()=>{i.end(),r(!0)})).once("error",(e=>{"ECONNREFUSED"===e.code?r(!1):o(e)}))}));return r?randomPort$1(0):e}{const e=r();e.listen({port:0,exclusive:!0});const t=e.address().port;return new Promise(((r,n)=>{e.close((e=>e?n(e):r(t)))}))}}throwUnsupportedRuntimeError()}}async function nodeToSocket(e){const t=asyncTask(),r=asyncTask();let n=null,o=null;const closeStreams=()=>{try{e.destroyed||e.destroy()}catch(e){}try{null==n||n.close()}catch(e){}try{null==o||o.error(new TypeError("The stream is closed."))}catch(e){}},i=new ReadableStream({start(e){n=e},cancel(e){e?r.reject(e):r.resolve(),closeStreams()}}),s=new WritableStream({start(e){o=e},write:t=>new Promise(((r,n)=>{e.write(t,(e=>{e?n(e):r()}))})),close:()=>new Promise((t=>{e.end(t)}))});return e.once("connect",(()=>{t.resolve()})).on("data",(e=>{n.enqueue(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))})).once("error",(e=>{try{n.error(e)}catch(e){}try{o.error(e)}catch(e){}r.reject(e),t.reject(e)})).once("close",(e=>{e||(closeStreams(),r.resolve())})),await t,{readable:i,writable:s,closed:r,close:()=>{e.destroy()},ref:()=>{e.ref()},unref:()=>{e.unref()}}}function denoToSocket(e){const t=asyncTask();let r=!1,n=null,o=null;const closeStreams=()=>{try{e.close()}catch(e){}try{null==n||n.close()}catch(e){}try{null==o||o.error(new TypeError("The stream is closed."))}catch(e){}};return{readable:new ReadableStream({start(e){n=e},async pull(n){try{for(;;){const r=new Uint8Array(4096),o=await e.read(r);if(null===o){closeStreams(),t.resolve();break}n.enqueue(r.subarray(0,o))}}catch(i){try{e.close()}catch(e){}try{n.error(i)}catch(e){}try{null==o||o.error(i)}catch(e){}r?t.resolve():t.reject(i)}},cancel(e){e?t.reject(e):t.resolve(),closeStreams()}}),writable:new WritableStream({start(e){o=e},async write(t){await e.write(t)},close:()=>e.closeWrite()}),closed:t,close:()=>{r=!0,closeStreams()},ref:e.ref.bind(e),unref:e.unref.bind(e)}}async function udpSocket(e={}){var t;if(j||P){const{createSocket:r}=await import("node:dgram"),n=r((null===(t=e.hostname)||void 0===t?void 0:t.includes(":"))?"udp6":"udp4");let o=!1,i=!1;const s=asyncTask(),a=chan(1/0);await new Promise((t=>{n.bind(e.port,e.hostname,t)})),n.on("message",((e,t)=>{a.send([new Uint8Array(e.buffer,e.byteOffset,e.byteLength),{hostname:t.address,port:t.port}]).catch((()=>{}))})).once("error",(e=>{a.close(e),s.reject(e)})).once("close",(()=>{i=!0,a.close(),s.resolve()}));const l=n.address(),c={localAddress:{hostname:l.address,port:l.port},closed:s,close:()=>{n.close()},ref:n.ref.bind(n),unref:n.unref.bind(n)},checkState=()=>{if(o)throw new TypeError("The socket is connected.");if(i)throw new TypeError("The socket is closed.")};return new UdpSocket({...c,joinMulticast:n.addMembership.bind(n),leaveMulticast:n.dropMembership.bind(n),setBroadcast:n.setBroadcast.bind(n),setMulticastLoopback:n.setMulticastLoopback.bind(n),setMulticastTTL:n.setMulticastTTL.bind(n),setTTL:n.setTTL.bind(n),receive:async()=>{checkState();const e=await a.recv();if(e)return e;throw new TypeError("The socket is closed.")},send:async(e,t)=>(checkState(),new Promise(((r,o)=>{n.send(e,t.port,t.hostname,((e,t)=>{e?o(e):r(t)}))}))),connect:e=>new Promise((t=>{o=!0,n.connect(e.port,e.hostname,(()=>{const e=n.address(),r=n.remoteAddress();let o=null,l=null;const closeStreams=()=>{a.close();try{n.close()}catch(e){}try{null==o||o.close()}catch(e){}try{null==l||l.error(new TypeError("The stream is closed."))}catch(e){}};t(new UdpSocketStream({...c,localAddress:{hostname:e.address,port:e.port},remoteAddress:{hostname:r.address,port:r.port},readable:new ReadableStream({start(e){o=e},async pull(e){try{for(;;){const t=await a.recv();if(void 0===t){closeStreams(),s.resolve();break}e.enqueue(t[0])}}catch(t){a.close(t);try{n.close()}catch(e){}try{e.error(t)}catch(e){}try{null==l||l.error(t)}catch(e){}i?s.resolve():s.reject(t)}},cancel(e){e?s.reject(e):s.resolve(),closeStreams()}}),writable:new WritableStream({start(e){l=e},write:e=>new Promise(((t,r)=>{n.send(e,(e=>{e?r(e):t()}))}))})}))}))}))})}throwUnsupportedRuntimeError()}var nr,or=Object.freeze({__proto__:null,connect:function connect(e){return"udp"===e.transport?async function connectUdp(e){return(await udpSocket()).connect(e)}(e):"unix"===e.transport||"path"in e?async function connectUnix(e){const{path:t}=e;if(C){const{createConnection:e}=await import("node:net"),r=e({path:t}),n=await nodeToSocket(r);return new UnixSocketStream(n)}if(j){const e=await Deno.connect({transport:"unix",path:t});return new UnixSocketStream(denoToSocket(e))}if($){const e=asyncTask(),r=asyncTask();let n=null,o=null;const closeStreams=()=>{try{a.terminate()}catch(e){}try{null==n||n.close()}catch(e){}try{null==o||o.error(new TypeError("The stream is closed."))}catch(e){}},i=new ReadableStream({start(e){n=e},cancel(e){e?r.reject(e):r.resolve(),closeStreams()}}),s=new WritableStream({start(e){o=e},write(e){a.write(e)},close(){a.shutdown()}}),a=await Bun.connect({unix:t,socket:{binaryType:"uint8array",open(){e.resolve()},data(e,t){n.enqueue(t)},error(e,t){try{n.error(t)}catch(e){}try{o.error(t)}catch(e){}r.reject(t)},close(){closeStreams(),r.resolve()}}});return await e,new UnixSocketStream({readable:i,writable:s,closed:r,close:closeStreams,ref:()=>a.ref(),unref:()=>a.unref()})}throwUnsupportedRuntimeError()}(e):async function connectTcp(e){var t;const{tls:r=!1,...n}=e;if(C){const{createConnection:o}=await import("node:net"),{connect:i}=await import("node:tls"),s=r?i({...n,rejectUnauthorized:!1}):o({host:e.hostname,port:e.port,localPort:0}),a=await nodeToSocket(s);return new TcpSocketStream({localAddress:{hostname:s.localAddress||"localhost",port:null!==(t=s.localPort)&&void 0!==t?t:0},remoteAddress:{hostname:s.remoteAddress,port:s.remotePort},...a,setKeepAlive:s.setKeepAlive.bind(s),setNoDelay:s.setNoDelay.bind(s)})}if(j){const e=r?await Deno.connectTls(n):await Deno.connect(n),{localAddr:t,remoteAddr:o}=e;return new TcpSocketStream({localAddress:{hostname:t.hostname,port:t.port},remoteAddress:{hostname:o.hostname,port:o.port},...denoToSocket(e),setKeepAlive:t=>{"setKeepAlive"in e&&e.setKeepAlive(t)},setNoDelay:t=>{"setNoDelay"in e&&e.setNoDelay(t)}})}if($){const t=asyncTask(),o=asyncTask();let i=null,s=null;const closeStreams=()=>{try{c.terminate()}catch(e){}try{null==i||i.close()}catch(e){}try{null==s||s.error(new TypeError("The stream is closed."))}catch(e){}},a=new ReadableStream({start(e){i=e},cancel(e){e?o.reject(e):o.resolve(),closeStreams()}}),l=new WritableStream({start(e){s=e},write(e){c.write(e)},close(){s.error(new TypeError("The stream is closed.")),c.shutdown()}}),c=await Bun.connect({...n,tls:r,socket:{binaryType:"uint8array",open(){t.resolve()},data(e,t){i.enqueue(t)},error(e,t){try{i.error(t)}catch(e){}try{s.error(t)}catch(e){}o.reject(t)},close(){closeStreams(),o.resolve()}}});return await t,new TcpSocketStream({localAddress:{hostname:"localhost",port:c.localPort},remoteAddress:{hostname:c.remoteAddress,port:e.port},readable:a,writable:l,closed:o,close:closeStreams,ref:()=>c.ref(),unref:()=>c.unref(),setKeepAlive:e=>{"setKeepAlive"in c&&c.setKeepAlive(e)},setNoDelay:e=>{"setNoDelay"in c&&c.setNoDelay(e)}})}throwUnsupportedRuntimeError()}(e)},getInternetIp:getInternetIp,getMyIp:async function getMyIp(){if(P){const{createSocket:e}=await import("node:dgram"),t=e("udp4");return new Promise((e=>{t.connect(53,"8.8.8.8",(()=>{const r=t.address();t.close(),e(r.address)}))}))}if(j){const e=await Deno.connect({hostname:"8.8.8.8",port:53}),t=e.localAddr;return e.close(),t.hostname}if("function"==typeof fetch)try{return await getInternetIp()}catch(e){}throwUnsupportedRuntimeError()},randomPort:randomPort$1,udpSocket:udpSocket});const ir=Symbol.for("source"),sr=Symbol.for("socket");class WebSocketConnection extends EventTarget{constructor(e){super(),this[nr]=null,this[ir]=e,this[ir].then((e=>{this[sr]=e}))}get ready(){return this[ir].then((()=>this))}get readyState(){var e,t;return null!==(t=null===(e=this[sr])||void 0===e?void 0:e.readyState)&&void 0!==t?t:0}get socket(){if(!this[sr])throw new Error("WebSocket connection is not ready.");return this[sr]}send(e){this.socket.send(e)}close(e,t){this.socket.close(e,t)}addEventListener(e,t,r=void 0){return super.addEventListener(e,t,r)}removeEventListener(e,t,r=void 0){return super.removeEventListener(e,t,r)}async*[(nr=sr,Symbol.asyncIterator)](){const e=chan(1/0),handleMessage=t=>{e.send(t.data)},handleClose=t=>{t.wasClean&&e.close()},handleError=t=>{e.close(fromErrorEvent(t))};this.addEventListener("message",handleMessage),this.addEventListener("close",handleClose),this.addEventListener("error",handleError);try{for await(const t of e)yield t}finally{this.removeEventListener("message",handleMessage),this.removeEventListener("close",handleClose),this.removeEventListener("error",handleError)}}}const ar=globalThis.WebSocket,lr=Symbol.for("ws");function initWebSocketStream(e,t){t.binaryType="arraybuffer",setReadonly(e,"url",t.url),setReadonly(e,"opened",new Promise(((e,r)=>{t.addEventListener("open",(()=>{e({extensions:t.extensions,protocol:t.protocol,readable:new ReadableStream({start(e){t.addEventListener("message",(({data:r})=>{"string"==typeof r?e.enqueue(r):r instanceof ArrayBuffer?e.enqueue(new Uint8Array(r)):r instanceof Uint8Array?e.enqueue(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)):t.close(1003,"Unsupported message type")})),t.addEventListener("close",(()=>{try{e.close()}catch(e){}}))},cancel(){t.close()}}),writable:new WritableStream({write(e){t.send(e)}})})})),t.addEventListener("error",(()=>{r(new NetworkError("Failed to establish WebSocket connection."))}))}))),setReadonly(e,"closed",new Promise((e=>{t.addEventListener("close",(t=>{e({closeCode:t.code,reason:t.reason})}))})))}class WebSocketStream{get url(){return getReadonly(this,"url")}get opened(){return getReadonly(this,"opened")}get closed(){return getReadonly(this,"closed")}constructor(e,t={}){if("function"!=typeof globalThis.WebSocket)throw new I("WebSocket is not supported in this environment.");const{protocols:r,signal:n}=t,o=this[lr]=new globalThis.WebSocket(e,r);initWebSocketStream(this,o),null==n||n.addEventListener("abort",(()=>o.close()))}close(e={}){var t;const{closeCode:r,reason:n}=e;null===(t=this[lr])||void 0===t||t.close(r,n)}}var cr,ur,dr,fr;"function"==typeof globalThis.WebSocketStream&&(Object.setPrototypeOf(WebSocketStream,globalThis.WebSocketStream),Object.setPrototypeOf(WebSocketStream.prototype,globalThis.WebSocketStream.prototype));const pr=Symbol.for("errored"),hr=Symbol.for("handler"),mr=Symbol.for("clients"),yr=Symbol.for("httpServer"),wr=Symbol.for("wsServer"),vr=Symbol.for("connTasks"),gr=new I("Node.js support is not implemented outside Node.js runtime.");class WebSocketServer{constructor(...e){var t,r,n;this[cr]=new Map,this[ur]=void 0,this[dr]=null,this[fr]=new Map,2===e.length?(this.idleTimeout=(null===(t=e[0])||void 0===t?void 0:t.idleTimeout)||30,this.perMessageDeflate=null!==(n=null===(r=e[0])||void 0===r?void 0:r.perMessageDeflate)&&void 0!==n&&n,this[hr]=e[1]):(this.idleTimeout=30,this.perMessageDeflate=!1,this[hr]=e[0])}upgrade(e){const t="socket"in e?e.headers.upgrade:e.headers.get("Upgrade");if(!t||"websocket"!==t)throw new TypeError("Expected Upgrade: websocket");const{identity:r}=runtime();if("deno"===r){if("socket"in e)throw gr;return this.upgradeInDeno(e)}if("bun"===r){if("socket"in e)throw gr;return this.upgradeInBun(e)}if("node"===r){const t="socket"in e;if(!t&&Reflect.has(e,Symbol.for("incomingMessage"))&&(e=Reflect.get(e,Symbol.for("incomingMessage"))),!("socket"in e))throw new TypeError("Expected an instance of http.IncomingMessage.");return this.upgradeInNode(e,t)}throwUnsupportedRuntimeError()}upgradeInDeno(e){const t=this[hr],r=this[mr],{socket:n,response:o}=Deno.upgradeWebSocket(e,{idleTimeout:this.idleTimeout}),i=new WebSocketConnection(new Promise((t=>{n.binaryType="arraybuffer",n.onmessage=e=>{"string"==typeof e.data?i.dispatchEvent(new MessageEvent("message",{data:e.data})):i.dispatchEvent(new MessageEvent("message",{data:new Uint8Array(e.data)}))},n.onclose=t=>{t.wasClean||i.dispatchEvent(createErrorEvent("error",{error:new Error(`WebSocket connection closed: ${t.reason} (${t.code})`)})),r.delete(e),i.dispatchEvent(createCloseEvent("close",{code:t.code,reason:t.reason,wasClean:t.wasClean}))},1===n.readyState?t(n):n.onopen=()=>{t(n)}})));return i.ready.then((()=>{r.set(e,i),null==t||t.call(this,i),i.dispatchEvent(new Event("open"))})),{socket:i,response:o}}upgradeInBun(e){const t=this[hr],r=this[mr],n=this[yr];if(!n)throw new TypeError("WebSocket server is not bound to a Bun server instance.");const o=asyncTask();this[vr].set(e,o);if(!n.upgrade(e,{data:{request:e}}))throw new Error("Failed to upgrade to WebSocket.");const i=new WebSocketConnection(o);return i.ready.then((()=>{r.set(e,i),null==t||t.call(this,i),i.dispatchEvent(new Event("open"))})),{socket:i,response:new Response(null,{status:101,statusText:"Switching Protocols",headers:new Headers({Upgrade:"websocket",Connection:"Upgrade"})})}}upgradeInNode(e,t){const r=this[hr],n=this[mr];this[wr]||(this[wr]=import("ws").then((({WebSocketServer:e})=>new e({noServer:!0,perMessageDeflate:this.perMessageDeflate}))));const o=this[wr].then((t=>new Promise((r=>{const{socket:o}=e;try{o.setTimeout(0),o.eventNames().forEach((e=>{o.removeAllListeners(e)})),o.readableFlowing=null}catch(e){}t.handleUpgrade(e,o,Buffer.alloc(0),(t=>{t.binaryType="arraybuffer",t.on("message",((e,t)=>{let r;if("string"==typeof(e=Array.isArray(e)?concat$2(...e):e))r=new MessageEvent("message",{data:e});else if(t)r=new MessageEvent("message",{data:new Uint8Array(e)});else{const t=e instanceof ArrayBuffer?new Uint8Array(e):e;r=new MessageEvent("message",{data:text(t)})}i.dispatchEvent(r)})),t.on("error",(e=>{Object.assign(t,{[pr]:!0}),i.dispatchEvent(createErrorEvent("error",{error:e}))})),t.on("close",((r,o)=>{var s;n.delete(e),i.dispatchEvent(createCloseEvent("close",{code:r,reason:null!==(s=null==o?void 0:o.toString("utf8"))&&void 0!==s?s:"",wasClean:!1!==Reflect.get(t,pr)}))})),r(t)}))})))),i=new WebSocketConnection(o);if(i.ready.then((()=>{n.set(e,i),null==r||r.call(this,i),i.dispatchEvent(new Event("open"))})),t||"function"!=typeof Response)return{socket:i};{const e=new Response(null,{status:200,statusText:"Switching Protocols",headers:new Headers({Upgrade:"websocket",Connection:"Upgrade"})});return Object.defineProperty(e,"status",{configurable:!0,value:101}),{socket:i,response:e}}}bunBind(e){this[yr]=e}get bunListener(){const e=this[mr],t=this[vr];return{idleTimeout:this.idleTimeout,perMessageDeflate:this.perMessageDeflate,open:async e=>{const{request:r}=e.data,n=t.get(r);n&&(t.delete(r),n.resolve(e))},message:(t,r)=>{const{request:n}=t.data,o=e.get(n);o&&("string"==typeof r?o.dispatchEvent(new MessageEvent("message",{data:r})):o.dispatchEvent(new MessageEvent("message",{data:new Uint8Array(r)})))},error:(t,r)=>{Object.assign(t,{[pr]:!0});const{request:n}=t.data,o=e.get(n);o&&o.dispatchEvent(createErrorEvent("error",{error:r}))},close:(t,r,n)=>{const{request:o}=t.data,i=e.get(o);i&&(e.delete(o),i.dispatchEvent(createCloseEvent("close",{code:r,reason:n,wasClean:!0!==Reflect.get(t,pr)})))}}}get clients(){return this[mr].values()}}cr=mr,ur=yr,dr=wr,fr=vr;var br,Er,Sr=Object.freeze({__proto__:null,WebSocket:ar,WebSocketServer:WebSocketServer,WebSocketStream:WebSocketStream,toWebSocketStream:function toWebSocketStream(e){const t=Object.create(WebSocketStream.prototype);return e instanceof WebSocketConnection?(t[lr]=e,setReadonly(t,"url",""),setReadonly(t,"opened",e.ready.then((()=>({extensions:"",protocol:"",readable:new ReadableStream({start(t){e.addEventListener("message",(({data:e})=>{t.enqueue(e)})),e.addEventListener("close",(()=>{try{t.close()}catch(e){}}))},cancel(){e.close()}}),writable:new WritableStream({write(t){e.send(t)}})})))),setReadonly(t,"closed",new Promise((t=>{e.addEventListener("close",(e=>{t({closeCode:e.code,reason:e.reason})}))})))):initWebSocketStream(t,e),t}});async function etag(e){var t;if("string"==typeof e||e instanceof Uint8Array){if(!e.length)return"0-47DEQpj8HBSa+/TImW+5JCeuQeR";"string"==typeof e&&(e=bytes(e));const t=await sha256(e,"base64");return`${e.length.toString(16)}-${t.slice(0,27)}`}const r=null!==(t=e.mtime)&&void 0!==t?t:new Date,n=await sha256(r.toISOString(),"base64");return`${e.size.toString(16)}-${n.slice(0,27)}`}const kr=randomPort$1;function serve(e){var t;const r=(j||$||C)&&e.type||"classic",n=new WebSocketServer(e.ws),{fetch:o,key:i,cert:s,onListen:a,headers:l}=e,c=null!==(t=e.onError)&&void 0!==t?t:e=>(console.error(e),new Response("Internal Server Error",{status:500,statusText:"Internal Server Error"}));return new HttpServer((async()=>{let t=e.hostname||"0.0.0.0",a=e.port,u=null,d=null;if(j)if("classic"===r){null!=a||(a=await kr(8e3,t)),u=new AbortController;const e=asyncTask(),r=d=Deno.serve({hostname:t,port:a,key:i,cert:s,signal:u.signal,onListen:()=>e.resolve()},((e,t)=>{const{getTimers:r,time:i,timeEnd:s}=createTimingFunctions(),a=createRequestContext(e,{ws:n,remoteAddress:constructNetAddress({hostname:t.remoteAddr.hostname,port:t.remoteAddr.port}),time:i,timeEnd:s}),u=withHeaders(o,l),d=withHeaders(c,l);return u(e,a).then((e=>patchTimingMetrics(e,r()))).catch((t=>d(t,e,a)))}));await e,t=r.addr.hostname,a=r.addr.port}else t="",a=0;else if($)if("classic"===r){const e=i&&s?{key:i,cert:s}:void 0;null!=a||(a=await kr(8e3,t));const r=d=Bun.serve({hostname:t,port:a,tls:e,fetch:(e,t)=>{const{getTimers:r,time:i,timeEnd:s}=createTimingFunctions(),a=t.requestIP(e),u=createRequestContext(e,{ws:n,remoteAddress:a?constructNetAddress({hostname:a.address,port:a.port}):null,time:i,timeEnd:s}),d=withHeaders(o,l),f=withHeaders(c,l);return d(e,u).then((e=>patchTimingMetrics(e,r()))).catch((t=>f(t,e,u)))},websocket:n.bunListener});n.bunBind(d),t=r.hostname,a=r.port}else t="0.0.0.0",a=3e3;else if(C)if("classic"===r){const e=withWeb(((e,t)=>{const{getTimers:r,time:i,timeEnd:s}=createTimingFunctions(),a=createRequestContext(e,{ws:n,...t,time:i,timeEnd:s}),u=withHeaders(o,l),d=withHeaders(c,l);return u(e,a).then((e=>patchTimingMetrics(e,r()))).catch((t=>d(t,e,a)))}));if(i&&s){const{createSecureServer:t}=await import("node:http2");d=t({key:i,cert:s,allowHTTP1:!0},e)}else{const{createServer:t}=await import("node:http");d=t(e)}const r=d;null!=a||(a=await kr(8e3,t)),await new Promise((e=>{t&&"0.0.0.0"!==t?r.listen(a,t,e):r.listen(a,e)}));const u=r.address();t||(t=u.address),a=u.port}else t="",a=0;else"function"==typeof addEventListener?(t="",a=0,"classic"===r&&listenFetchEvent({ws:n,fetch:o,onError:c,headers:l})):throwUnsupportedRuntimeError();return{http:d,hostname:t,port:a,controller:u}}),{type:r,fetch:o,onError:c,onListen:a,ws:n,headers:l,secure:!!i&&!!s})}async function serveStatic(e,t={}){var r,n,o,i,s,a;const l=null!==(r=t.headers)&&void 0!==r?r:{},c=null!==(n=t.fsDir)&&void 0!==n?n:".",u=t.urlPrefix?join(t.urlPrefix):"",d=new URL(e.url),f=decodeURIComponent(d.pathname);if(u&&!startsWith(f,u))return new Response("Not Found",{status:404,statusText:"Not Found",headers:l});const p=join(c,stripStart(f.slice(u.length),"/"));let h;try{h=await stat(p)}catch(e){return"NotFoundError"===(null===(o=as$1(e,Error))||void 0===o?void 0:o.name)?new Response("Not Found",{status:404,statusText:"Not Found",headers:l}):"NotAllowedError"===(null===(i=as$1(e,Error))||void 0===i?void 0:i.name)?new Response("Forbidden",{status:403,statusText:"Forbidden",headers:l}):new Response("Internal Server Error",{status:500,statusText:"Internal Server Error",headers:l})}if("directory"===h.kind){if(e.url.endsWith("/")){if(await exists(join(p,"index.html")))return serveStatic(new Request(join(e.url,"index.html"),e),t);if(await exists(join(p,"index.htm")))return serveStatic(new Request(join(e.url,"index.htm"),e),t);if(t.listDir){return async function renderDirectoryPage(e,t,r={}){const n=[...orderBy(t.filter((e=>"directory"===e.kind)),(e=>e.name)).map((e=>e.name+"/")),...orderBy(t.filter((e=>"file"===e.kind)),(e=>e.name)).map((e=>e.name))];"/"!==e&&n.unshift("../");const o=n.map((t=>{let r=join(e,t);return t.endsWith("/")&&"/"!==r&&(r+="/"),dedent`
            <li>
                <a href="${r}">${t}</a>
            </li>
            `}));return new Response(dedent`
                <!DOCTYPE HTML>
                <html lang="en">
                <head>
                    <meta charset="utf-8">
                    <title>Directory listing for ${e}</title>
                    <style>
                    body {
                        font-family: system-ui;
                    }
                    </style>
                </head>
                <body>
                    <h1>Directory listing for ${e}</h1>
                    <hr>
                    <ul>
                        ${o.join("")}
                    </ul>
                </body>
                </html>
                `,{status:200,statusText:"OK",headers:{...r,"Content-Type":"text/html; charset=utf-8"}})}(f,await readAsArray(readDir(p)),l)}return new Response("Forbidden",{status:403,statusText:"Forbidden",headers:l})}return Response.redirect(e.url+"/",301)}if("file"!==h.kind)return new Response("Forbidden",{status:403,statusText:"Forbidden",headers:l});const m=e.headers.get("Range");let y;if(m&&h.size)try{y=parseRange(m)}catch(e){return new Response("Invalid Range header",{status:416,statusText:"Range Not Satisfiable",headers:l})}const w=null!==(s=h.mtime)&&void 0!==s?s:new Date,v=await etag(h),g=new Headers({...l,"Accept-Ranges":"bytes","Last-Modified":w.toUTCString(),Etag:v}),b=e.headers.get("If-Modified-Since"),E=e.headers.get("If-None-Match"),S=e.headers.get("If-Match");let k=!0;if(b){const e=new Date(b);k=Math.floor(w.valueOf()/1e3)>Math.floor(e.valueOf()/1e3)}else E&&(k=ifNoneMatch(E,v));if(!k)return new Response(null,{status:304,statusText:"Not Modified",headers:g});if(S&&y&&!ifMatch(S,v))return new Response("Precondition Failed",{status:412,statusText:"Precondition Failed",headers:g});if(/^text\/|^application\/(json|yaml|toml|xml|javascript)$/.test(h.type)?g.set("Content-Type",h.type+"; charset=utf-8"):g.set("Content-Type",h.type||"application/octet-stream"),h.atime&&g.set("Date",h.atime.toUTCString()),t.maxAge&&g.set("Cache-Control",`public, max-age=${t.maxAge}`),y){const{ranges:e,suffix:t}=y;let r,n;e.length?(({start:r}=e[0]),n=Math.min(null!==(a=e[0].end)&&void 0!==a?a:h.size-1,h.size-1)):(r=Math.max(h.size-t,0),n=h.size-1);const o=(await readFile(p)).subarray(r,n+1);return g.set("Content-Range",`bytes ${r}-${n}/${h.size}`),g.set("Content-Length",String(n-r+1)),new Response(o,{status:206,statusText:"Partial Content",headers:g})}return h.size?(g.set("Content-Length",String(h.size)),new Response(createReadableStream(p),{status:200,statusText:"OK",headers:g})):(g.set("Content-Length","0"),new Response("",{status:200,statusText:"OK",headers:g}))}async function startServer(e){const t=parseArgs(e,{alias:{p:"port"}}),r=Number.isFinite(t.port)?t.port:void 0,n=t.parallel;let o,i={},s=String(t[0]||".");const a=extname(s);if(/^\.m?(js|ts)x?/.test(a)){s=resolve(s);const e=await import(s);if("object"!=typeof e.default||"function"!=typeof e.default.fetch)throw new Error("The entry file must have an `export default { fetch }` statement");i=e.default,o=i.fetch}o||(o=e=>serveStatic(e,{fsDir:s,listDir:!0})),C||$?import("node:os").then((async({availableParallelism:e})=>{const{default:t}=await import("node:cluster");if(t.isPrimary&&n){const o="number"==typeof n?n:e(),s=r||await kr(8e3),a=i.hostname||"localhost",l=!!i.key&&!!i.cert,c=new Array(o).fill(null),forkWorker=e=>{const r=t.fork({HTTP_PORT:String(s)});c[e]={worker:r,ready:!1},r.on("message",(t=>{if("ready"===t&&(c[e].ready=!0,c.every((e=>null==e?void 0:e.ready)))){const e=`${l?"https":"http"}://${a}:${s}`;console.log(`Server listening on ${e} with ${o} workers`)}})),r.once("exit",(t=>{c[e]=null,t&&forkWorker(e)}))};for(let e=0;e<o;e++)forkWorker(e)}else t.isWorker&&process.env.HTTP_PORT?serve({...i,fetch:o,port:Number(process.env.HTTP_PORT),type:"classic",onListen:e=>{var t,r;null===(t=i.onListen)||void 0===t||t.call(i,e),null===(r=process.send)||void 0===r||r.call(process,"ready")}}):serve({...i,fetch:o,port:r,type:"classic"})})):serve({...i,fetch:o,port:r,type:"classic"})}if((j||$||C)&&isMain({url:"undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:t&&"SCRIPT"===t.tagName.toUpperCase()&&t.src||new URL("jsext.js",document.baseURI).href})&&function isThisMain(e){var t,r;const n=null!==(r=null===(t=e.filename)||void 0===t?void 0:t.replace(/\\/g,"/"))&&void 0!==r?r:e.url;return/\/jsext(\/(esm|cjs)|[\/@\^]*(\d+\.\d+\.\d+|latest))?\/http(\.(ts|js))?$/.test(n)}({url:"undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:t&&"SCRIPT"===t.tagName.toUpperCase()&&t.src||new URL("jsext.js",document.baseURI).href}))startServer(ft);else if(C&&process.execArgv.some((e=>e.endsWith("@ayonli/jsext/http")))){const e=parseArgs(process.execArgv,{alias:{r:"require"},lists:["require","import"]}),t=process.argv.slice(1);t.length&&((null===(br=e.require)||void 0===br?void 0:br.includes("@ayonli/jsext/http"))||(null===(Er=e.import)||void 0===Er?void 0:Er.includes("@ayonli/jsext/http")))&&startServer(t)}var xr=Object.freeze({__proto__:null,HTTP_METHODS:tr,HTTP_STATUS:{200:"OK",201:"Created",202:"Accepted",204:"No Content",206:"Partial Content",301:"Moved Permanently",302:"Found",304:"Not Modified",400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",408:"Request Timeout",409:"Conflict",410:"Gone",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"},etag:etag,getCookie:function getCookie(e,t){var r;return null!==(r=getCookies(e).find((e=>e.name===t)))&&void 0!==r?r:null},getCookies:getCookies,getFilename:function getFilename(e){var t;const r=e instanceof Headers?e.get("Content-Disposition"):e.headers.get("Content-Disposition");if(!r)return null;const n=parseContentDisposition(r);return"attachment"===n.type&&null!==(t=n.filename)&&void 0!==t?t:null},ifMatch:ifMatch,ifNoneMatch:ifNoneMatch,parseAccepts:parseAccepts,parseBasicAuth:parseBasicAuth,parseContentDisposition:parseContentDisposition,parseContentType:function parseContentType(e){const[t,...r]=e.split(";").map((e=>e.trim()));if(!(null==t?void 0:t.includes("/")))throw new SyntaxError("Invalid Content-Type header");const n={type:t};for(const e of r)if(e){const[t,r]=e.split("=");"charset"===t?n.charset=null!=r?r:"":"boundary"===t&&(n.boundary=null!=r?r:"")}return n},parseCookie:parseCookie,parseCookies:parseCookies,parseRange:parseRange,parseRequest:function parseRequest(e){var t;let r=e.indexOf("\r\n");-1===r&&throwInvalidMessageError();const[n,o,i]=e.slice(0,r).split(/\s+/);if(n&&tr.includes(n)&&o&&o.startsWith("/")&&(null==i?void 0:i.startsWith("HTTP/"))){if("HTTP/1.1"!==i)throw new TypeError("Unsupported HTTP version")}else throwInvalidMessageError();const{headers:s,body:a}=parseMessage(e.slice(r+2));let l=a;if("GET"===n||"HEAD"===n){if(l)throw new SyntaxError("Request with GET/HEAD method cannot have body.");l=null}const c=null!==(t=s.get("Host"))&&void 0!==t?t:"";return new Request("http://"+c+o,{method:n,headers:s,body:l})},parseResponse:function parseResponse(e){let t=e.indexOf("\r\n");-1===t&&throwInvalidMessageError();const[r,n,...o]=e.slice(0,t).split(/\s+/),i=o.join(" ");let s;(null==r?void 0:r.startsWith("HTTP/"))&&n&&Number.isInteger(s=Number(n))||throwInvalidMessageError();const{headers:a,body:l}=parseMessage(e.slice(t+2));let c=l;if(204===s||304===s){if(c)throw new SyntaxError("Response with 204 or 304 status cannot have body.");c=null}return new Response(c,{status:s,statusText:i,headers:a})},parseUserAgent:parseUserAgent,randomPort:kr,serve:serve,serveStatic:serveStatic,setCookie:function setCookie(e,t){if(e instanceof Headers)e.append("Set-Cookie",stringifyCookie(t));else if(e instanceof Response)e.headers.append("Set-Cookie",stringifyCookie(t));else{const r=getCookies(e),n=r.findIndex((({name:e})=>e===t.name));-1===n?r.push(t):r[n]=t,e.headers.set("Cookie",stringifyCookies(r))}},setFilename:function setFilename(e,t){const r=`attachment; filename="${t=encodeURIComponent(t)}"; filename*=UTF-8''${t}`;e instanceof Headers?e.set("Content-Disposition",r):e.headers.set("Content-Disposition",r)},stringifyCookie:stringifyCookie,stringifyCookies:stringifyCookies,stringifyRequest:async function stringifyRequest(e){const{host:t,pathname:r}=new URL(e.url);let n=`${e.method} ${r} HTTP/1.1\r\n`,o=e.body?await e.text():"";t&&!e.headers.has("Host")&&(n+=`Host: ${t}\r\n`);for(const[t,r]of e.headers)n+=`${capitalize(t,!0)}: ${r}\r\n`;return o&&!e.headers.has("Content-Length")&&(n+=`Content-Length: ${bytes(o).length}\r\n`),n+="\r\n"+o,n},stringifyResponse:async function stringifyResponse(e){const t=e.statusText;let r=`HTTP/1.1 ${e.status}${t?" "+t:""}\r\n`,n=e.body?await e.text():"";for(const[t,n]of e.headers)r+=`${capitalize(t,!0)}: ${n}\r\n`;return n&&!e.headers.has("Content-Length")&&(r+=`Content-Length: ${bytes(n).length}\r\n`),r+="\r\n"+n,r},suggestResponseType:function suggestResponseType(e){var t;const r=e.headers.get("Accept"),n=r?null===(t=parseAccepts(r).sort(((e,t)=>t.weight-e.weight))[0])||void 0===t?void 0:t.type:null,o=!n||"*/*"===n,i=e.headers.get("Content-Type"),s=e.headers.get("Sec-Fetch-Dest")||e.destination,a="XMLHttpRequest"===e.headers.get("X-Requested-With");if("HEAD"===e.method||"OPTIONS"===e.method)return"none";if((null==n?void 0:n.includes("text/event-stream"))||(null==n?void 0:n.includes("application/octet-stream"))||(null==n?void 0:n.includes("multipart/form-data"))||/(image|audio|video)\//.test(null!=n?n:"")||["font","image","audio","video","object","embed"].includes(s))return"stream";if((null==n?void 0:n.includes("/json"))||o&&((null==i?void 0:i.includes("json"))||a)||"manifest"===s)return"json";if((null==n?void 0:n.includes("/xml"))||o&&(null==i?void 0:i.includes("xml"))||"xslt"===s)return"xml";if((null==n?void 0:n.includes("/html"))||"document"===s)return"html";{const{pathname:t}=new URL(e.url);return"/api"===t||t.startsWith("/api/")||/\.json?$/i.test(t)?"json":/\.xml$/i.test(t)?"xml":/\.html?$/i.test(t)?"html":"text"}},verifyBasicAuth:async function verifyBasicAuth(e,t){const r=e.headers.get("Authorization");if(null==r?void 0:r.startsWith("Basic "))try{const e=parseBasicAuth(r);if(await t(e))return}catch(e){}const{host:n}=new URL(e.url);return new Response("Unauthorized",{status:401,statusText:"Unauthorized",headers:{"WWW-Authenticate":`Basic realm="${n}"`}})}}),Tr={Queue:Queue,Mutex:Mutex,Channel:Channel,...oe,...Je,archive:ct,array:v,async:J,bytes:{...omit(c,["default"]),bytes:bytes},class:w,cli:mt,collections:Y,dialog:yt,encoding:o,error:M,event:B,filetype:Se,fs:Fe,hash:{...omit($t,["default"]),hash:hash$1},http:xr,json:Z,math:s,module:De,net:or,number:y,object:k,path:be,reader:ke,result:Oe,runtime:{...omit(V,["default"]),runtime:runtime},sse:Jt,string:m,ws:Sr};function useColorTheme(){if("function"==typeof window.matchMedia){const e=window.matchMedia("(prefers-color-scheme: dark)");return{theme:e.matches?"dark":"light",onChange:t=>{e.addEventListener("change",(()=>{t(e.matches?"dark":"light")}))}}}return{theme:"light",onChange:e=>{}}}function i18n(e){let t="en";return"object"==typeof navigator&&"string"==typeof navigator.language&&(t=navigator.language.split("-")[0]),e[t]||e.en}const Or=new WeakMap,Ar="#fff",Fr="#222",jr="#000",$r="#fff";function Dialog(e,...t){const{onCancel:r,onOk:n}=e,o=t.some((e=>e.querySelector("input"))),i=document.createElement("dialog"),{theme:s,onChange:a}=useColorTheme();i.style.fontFamily="Inter,sans-serif",i.style.color="light"===s?jr:$r,i.style.fontSize="13px",i.style.width="450px",i.style.boxSizing="border-box",i.style.border="1px solid #ccc",i.style.borderRadius="13px",i.style.padding="1rem",i.style.backgroundColor="light"===s?Ar:Fr,i.style.outline="none",o||(i.inert=!0),a((e=>{i.style.color="light"===e?jr:$r,i.style.backgroundColor="light"===e?Ar:Fr}));const close=()=>{i.returnValue&&"Cancel"!==i.returnValue?"OK"===i.returnValue&&(null==n||n(i)):null==r||r(i);try{document.body.removeChild(i)}catch(e){if("NotFoundError"!==e.name)throw e}};return"function"==typeof i.close?i.addEventListener("close",close):Or.set(i,close),i.addEventListener("keypress",(e=>{"Enter"===e.key&&closeDialog(i,"OK")})),t.forEach((e=>{i.appendChild(e)})),requestAnimationFrame((()=>{"function"==typeof i.showModal?i.showModal():"function"==typeof i.show?i.show():i.open=!0,o||(i.inert=!1,requestAnimationFrame((()=>{i.focus()})))})),i}function closeDialog(e,t){requestAnimationFrame((()=>{if("function"==typeof e.close)e.close(t);else{e.open=!1,e.returnValue=t;try{e.dispatchEvent(new Event("close"))}catch(t){const r=Or.get(e);r&&(r(),Or.delete(e))}}}))}const Pr="#fff",Cr="#222",Dr="#f4f4f4",Rr="#333",Lr={ar:"إلغاء",be:"Адмяніць",bg:"Отказ",bn:"বাতিল",bs:"Otkaži",cs:"Storno",da:"Annuller",de:"Abbrechen",el:"Ακύρωση",en:"Cancel",es:"Cancelar",et:"Tühista",eu:"Ezeztatu",fa:"لغو",fi:"Peruuta",fr:"Annuler",hi:"रद्द करें",hu:"Mégsem",hy:"Չեղարկել",id:"Batal",is:"Hætta við",it:"Annulla",iw:"ביטול",ja:"キャンセル",ko:"취소",lb:"Ofbriechen",lo:"ຍົກເລີກ",lv:"Atcelt",lt:"Atšaukti",mk:"Откажи",ml:"റദ്ദാക്കുക",mi:"Whakakore",mn:"Цуцлах",my:"ပယ်ဖျက်",ne:"रद्द गर्नुहोस्",nl:"Annuleren",no:"Avbryt",pl:"Anuluj",pt:"Cancelar",ro:"Anulare",ru:"Отмена",sa:"रद्द",sk:"Zrušiť",sl:"Prekliči",so:"Kaari",sq:"Anulo",sv:"Avbryt",th:"ยกเลิก",tl:"Kanselahin",tr:"İptal",ug:"بىكارلاش",uk:"Скасувати",vi:"Hủy",zh:"取消"};function getCancelText(){return i18n(Lr)}function CancelButton(){const e=document.createElement("button"),{theme:t,onChange:r}=useColorTheme();return e.textContent=getCancelText(),e.style.minWidth="80px",e.style.height="32px",e.style.boxSizing="border-box",e.style.border="1px solid #8ebceb",e.style.borderRadius="1.5rem",e.style.color="#006bd6",e.style.backgroundColor="light"===t?Pr:Cr,e.style.userSelect="none",e.style.fontSize="1em",e.style.fontWeight="500",e.addEventListener("mouseover",(()=>{const{theme:t}=useColorTheme();e.style.backgroundColor="light"===t?Dr:Rr})),e.addEventListener("mouseout",(()=>{const{theme:t}=useColorTheme();e.style.backgroundColor="light"===t?Pr:Cr})),e.addEventListener("click",(e=>{var t;closeDialog(null===(t=e.target)||void 0===t?void 0:t.closest("dialog"),"Cancel")})),r((t=>{e.style.backgroundColor="light"===t?Pr:Cr})),e}function Footer(...e){const t=document.createElement("footer");return t.style.display="flex",t.style.justifyContent="flex-end",t.style.alignItems="center",t.style.gap="0.5em",e.forEach((e=>{t.appendChild(e)})),t}const Ir="#fff",Nr="#222",Br="#000",Ur="#fff";const Wr={ar:"موافق",be:"Добра",bg:"ОК",bn:"ঠিক আছে",bs:"U redu",cs:"OK",da:"OK",de:"OK",el:"ΟΚ",en:"OK",es:"Aceptar",et:"OK",eu:"Ados",fa:"باشه",fi:"OK",fr:"OK",hi:"ठीक",hu:"OK",hy:"Լավ",id:"OK",is:"Í lagi",it:"OK",iw:"אישור",ja:"OK",ko:"확인",lb:"OK",lo:"ຕົກລົງ",lv:"Labi",lt:"Gerai",mk:"Добро",ml:"ശരി",mi:"OK",mn:"Зөв",my:"အိုး",ne:"ठिक",nl:"OK",no:"OK",pl:"OK",pt:"OK",ro:"OK",ru:"OK",sa:"ठीक",sk:"OK",sl:"V redu",so:"OK",sq:"OK",sv:"OK",th:"ตกลง",tl:"OK",tr:"Tamam",ug:"جەزملە",uk:"OK",vi:"OK",zh:"确定"};function getOkText(){return i18n(Wr)}function OkButton(){const e=document.createElement("button");return e.textContent=getOkText(),e.style.minWidth="80px",e.style.height="32px",e.style.boxSizing="border-box",e.style.borderStyle="none",e.style.borderRadius="1.5rem",e.style.color="#fff",e.style.backgroundColor="#006bd6",e.style.userSelect="none",e.style.fontSize="1em",e.style.fontWeight="500",e.addEventListener("mouseover",(()=>{e.style.backgroundColor="#0174e6"})),e.addEventListener("mouseout",(()=>{e.style.backgroundColor="#006bd6"})),e.addEventListener("click",(e=>{var t;closeDialog(null===(t=e.target)||void 0===t?void 0:t.closest("dialog"),"OK")})),e}const Mr="#333",_r="#ccc";function Text(e){const t=document.createElement("p");return t.innerHTML=e.replace(/ /g,"&nbsp;").replace(/\n/g,"<br />"),t.style.margin="0 0 1rem",t.style.fontSize="1em",t.style.width="100%",t.style.overflowX="auto",t}function htmlAcceptToFileFilters$1(e){const t=[];for(const r of e.split(/\s*,\s*/))if(r.endsWith("/*"))t.push(r);else{const e=t[t.length-1];e&&"string"!=typeof e?e.push(r):t.push([r])}return t.map((e=>{if(Array.isArray(e))return e.map((e=>{const t=getExtensions(e);if(t.length){return{description:"",accept:{[getMIME(e)||e]:t}}}}));if("*/*"===e)return{description:"All Files",accept:{"*/*":["*"]}};{const t=getExtensions(e);if(t.length){if("video/*"===e)return{description:"Video Files",accept:{[e]:t}};if("audio/*"===e)return{description:"Audio Files",accept:{[e]:t}};if("image/*"===e)return{description:"Image Files",accept:{[e]:t}};if("text/*"===e)return{description:"Text Files",accept:{[e]:t}};return{description:"",accept:{[getMIME(e)||e]:t}}}return}})).flat().filter((e=>!!e))}async function pickFile$1(e={}){const{type:t}=e;try{if(e.forSave)return await globalThis.showSaveFilePicker({types:t?htmlAcceptToFileFilters$1(t):[],suggestedName:e.defaultName});{const[e]=await globalThis.showOpenFilePicker({types:t?htmlAcceptToFileFilters$1(t):[]});return null!=e?e:null}}catch(e){if("AbortError"===e.name)return null;throw e}}async function pickFiles$1(e={}){const{type:t}=e;try{return await globalThis.showOpenFilePicker({types:t?htmlAcceptToFileFilters$1(t):[],multiple:!0})}catch(e){if("AbortError"===e.name)return[];throw e}}async function pickDirectory$1(){try{return await globalThis.showDirectoryPicker()}catch(e){if("AbortError"===e.name)return null;throw e}}async function openFile$1(e={}){var t;if("function"==typeof globalThis.showOpenFilePicker){const t=await pickFile$1(e);return t?await t.getFile().then(fixFileType):null}const r=document.createElement("input");return r.type="file",r.accept=null!==(t=e.type)&&void 0!==t?t:"",await new Promise((e=>{r.onchange=()=>{var t;const n=null===(t=r.files)||void 0===t?void 0:t[0];e(n?fixFileType(n):null)},r.oncancel=()=>{e(null)},"function"==typeof r.showPicker?r.showPicker():r.click()}))}async function openFiles$1(e={}){if("function"==typeof globalThis.showOpenFilePicker){const t=await pickFiles$1(e),r=[];for(const e of t){const t=await e.getFile();r.push(fixFileType(t))}return r}const t=document.createElement("input");return t.type="file",t.multiple=!0,t.accept=e.type||"",await new Promise((e=>{t.onchange=()=>{const r=t.files;e(r?[...r].map(fixFileType):[])},t.oncancel=()=>{e([])},"function"==typeof t.showPicker?t.showPicker():t.click()}))}async function openDirectory$1(){if("function"==typeof globalThis.showDirectoryPicker){const e=await pickDirectory$1(),t=[];if(!e)return t;for await(const r of readDir$1(e,{recursive:!0}))if("file"===r.kind){const e=await r.handle.getFile();Object.defineProperty(e,"webkitRelativePath",{configurable:!0,enumerable:!0,writable:!1,value:r.relativePath.replace(/\\/g,"/")}),t.push(fixFileType(e))}return t}{const e=document.createElement("input");return e.type="file",e.webkitdirectory=!0,await new Promise((t=>{e.onchange=()=>{const r=e.files;t(r?[...r].map(fixFileType):[])},e.oncancel=()=>{t([])},"function"==typeof e.showPicker?e.showPicker():e.click()}))}}async function saveFile$1(e,t={}){const r=document.createElement("a");if(e instanceof ReadableStream){const n=t.type||"application/octet-stream";r.href=await readAsObjectURL(e,n),r.download=t.name||"Unnamed"+(getExtensions(n)[0]||"")}else if(e instanceof File)r.href=URL.createObjectURL(e),r.download=t.name||e.name||"Unnamed"+(getExtensions(e.type)[0]||"");else if(e instanceof Blob)r.href=URL.createObjectURL(e),r.download=t.name||"Unnamed"+(getExtensions(e.type)[0]||"");else{const n=t.type||"application/octet-stream",o=new Blob([e],{type:n});r.href=URL.createObjectURL(o),r.download=t.name||"Unnamed"+(getExtensions(n)[0]||"")}r.click()}async function downloadFile$1(e,t={}){const r="object"==typeof e?e.href:e,n=t.name||basename(r),o=document.createElement("a");o.href=r,o.download=n,o.click()}var zr=Object.freeze({__proto__:null,downloadFile:downloadFile$1,openDirectory:openDirectory$1,openFile:openFile$1,openFiles:openFiles$1,pickDirectory:pickDirectory$1,pickFile:pickFile$1,pickFiles:pickFiles$1,saveFile:saveFile$1});var Hr=Object.freeze({__proto__:null,alert:async function alert$2(e,t={}){await new Promise((r=>{const resolve=()=>{s&&clearTimeout(s),r()},n=OkButton(),o=Dialog({onCancel:()=>resolve(),onOk:()=>resolve()},Text(e),Footer(n));let i=(null==t?void 0:t.timeout)?Math.max(1,Math.round(t.timeout/1e3)):0;const s=i?setInterval((()=>{n.textContent=`${getOkText()} (${--i})`,0===i&&closeDialog(o,"OK")}),1e3):void 0;i&&(n.textContent=`${getOkText()} (${i})`),document.body.appendChild(o)}))},confirm:async function confirm$2(e,t={}){return new Promise((r=>{const resolve=e=>{s&&clearInterval(s),r(e)},n=CancelButton(),o=Dialog({onCancel:()=>resolve(!1),onOk:()=>resolve(!0)},Text(e),Footer(n,OkButton()));let i=(null==t?void 0:t.timeout)?Math.max(1,Math.round(t.timeout/1e3)):0;const s=i?setInterval((()=>{n.textContent=`${getCancelText()} (${--i})`,0===i&&closeDialog(o,"Cancel")}),1e3):void 0;i&&(n.textContent=`${getCancelText()} (${i})`),document.body.appendChild(o)}))},downloadFile:downloadFile$1,openDirectory:openDirectory$1,openFile:openFile$1,openFiles:openFiles$1,pickDirectory:pickDirectory$1,pickFile:pickFile$1,pickFiles:pickFiles$1,progress:async function progress$2(e,t,r=void 0){const n=new AbortController,o=n.signal;let i=null;const s=Text(e),{element:a,setValue:l}=function Progress(){const e=document.createElement("div"),t=document.createElement("progress"),r=document.createElement("span"),{theme:n,onChange:o}=useColorTheme();return e.style.width="100%",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.style.gap="0.5em",t.max=100,t.style.width="100%",r.style.color="light"===n?Mr:_r,r.style.fontSize="1em",o((e=>{r.style.color="light"===e?Mr:_r})),e.appendChild(t),e.appendChild(r),{element:e,setValue:e=>{t.value=e,r.textContent=`${e}%`}}}(),c=Dialog({onCancel:async()=>{try{if(r){const e=await r();i=null!=e?{value:e}:{value:null}}else i={value:null};n.abort()}catch(e){n.abort(e)}}},s);c.appendChild(Footer(a,CancelButton())),document.body.appendChild(c);const u=Promise.race([t((e=>{o.aborted||(e.message&&(s.innerHTML=e.message.replace(/ /g,"&nbsp;").replace(/\n/g,"<br />")),void 0!==e.percent&&l(e.percent))}),o),new Promise(((e,t)=>{o.addEventListener("abort",(()=>{i?e(i.value):t(o.reason)}))}))]);try{return await u}finally{o.aborted||closeDialog(c,"OK")}},prompt:async function prompt$2(e,t={}){const{type:r,defaultValue:n}=t;return new Promise((o=>{const i=function Input(e){var t,r;const n=document.createElement("div"),o=document.createElement("input"),{theme:i,onChange:s}=useColorTheme();return n.style.display="flex",n.style.margin="0 0 1rem",o.autofocus=!0,o.style.width="100%",o.style.height="32px",o.style.boxSizing="border-box",o.style.border="1px solid #ccc",o.style.borderRadius="1.5rem",o.style.padding="0 1rem",o.style.fontSize="1em",o.style.color="light"===i?Br:Ur,o.style.backgroundColor="light"===i?Ir:Nr,o.type=null!==(t=e.type)&&void 0!==t?t:"text",o.value=null!==(r=e.value)&&void 0!==r?r:"",s((e=>{o.style.color="light"===e?Br:Ur,o.style.backgroundColor="light"===e?Ir:Nr})),n.appendChild(o),n}({type:r,value:n}),s=CancelButton(),a=OkButton(),l=Dialog({onCancel:()=>resolve(null),onOk:e=>{const t=e.querySelector("input");resolve(t.value)}},Text(e),i,Footer(s,a)),c=isValid(n);let u=(null==t?void 0:t.timeout)?Math.max(1,Math.round(t.timeout/1e3)):0,d=u?setInterval((()=>{c?(a.textContent=`${getOkText()} (${--u})`,0===u&&closeDialog(l,"OK")):(s.textContent=`${getCancelText()} (${--u})`,0===u&&closeDialog(l,"Cancel"))}),1e3):void 0;const resolve=e=>{d&&clearInterval(d),o(e)};if(d){const e=i.querySelector("input");null==e||e.addEventListener("input",(()=>{clearInterval(d),d=void 0,c?a.textContent=getOkText():s.textContent=getCancelText()}))}u&&(c?a.textContent=`${getOkText()} (${u})`:s.textContent=`${getCancelText()} (${u})`),document.body.appendChild(l)}))},saveFile:saveFile$1});const{CTRL_C:qr,ESC:Kr,LF:Vr}=it,{CLR:Gr}=lt,Jr=["      ","=     ","==    ","===   "," ===  ","  === ","   ===","    ==","     =","      "];async function handleTerminalProgress(e,t,r){const{signal:n,abort:o,listenForAbort:i}=r;let s,a=e,l=0;const renderSimpleBar=(e=void 0)=>{null!=e||(e=l++);const t=Jr[e];writeStdoutSync(Gr),writeStdoutSync(bytes(`${a} [${t}]`)),l===Jr.length&&(l=0)};renderSimpleBar();const c=setInterval(renderSimpleBar,200),u="object"==typeof Deno?null:e=>{(equals$3(e,Kr)||equals$3(e,qr))&&(null==o||o())},d="object"==typeof Deno?Deno.stdin.readable.getReader():null;u?process.stdin.on("data",u):d&&(async()=>{for(;;)try{const{done:e,value:t}=await d.read();if(e||equals$3(t,Kr)||equals$3(t,qr)){n.aborted||o();break}}catch(e){n.aborted||o();break}d.releaseLock()})();const f=Promise.race([t((e=>{n.aborted||(e.message&&(a=e.message),void 0!==e.percent&&(s=e.percent),void 0!==s?((e=>{const{width:t}=getWindowSize(),r=e+"%",n=t-stringWidth(a)-r.length-5,o="".padStart(Math.floor(n*e/100),"#"),i="".padStart(n-o.length,"-");writeStdoutSync(Gr),writeStdoutSync(bytes(`${a} [${o}${i}] ${r}`))})(s),clearInterval(c)):e.message&&renderSimpleBar(l))}),n),i()]);try{return await f}finally{writeStdoutSync(Vr),clearInterval(c),u?process.stdin.off("data",u):d&&d.releaseLock()}}async function progress(e,t,r=void 0){const n=new AbortController,o=n.signal;let i=null;const abort=async()=>{try{if(r){const e=await r();i=null!=e?{value:e}:{value:null}}else i={value:null};n.abort()}catch(e){n.abort(e)}},listenForAbort=()=>new Promise(((e,t)=>{o.addEventListener("abort",(()=>{i?e(i.value):t(o.reason)}))}));return await lockStdin((()=>handleTerminalProgress(e,t,{signal:o,abort:abort,listenForAbort:listenForAbort})))}var Qr=Object.freeze({__proto__:null,default:progress});function htmlAcceptToFileFilters(e){const t=[];for(const r of e.split(/\s*,\s*/))if(r.endsWith("/*"))t.push(r);else{const e=t[t.length-1];e&&"string"!=typeof e?e.push(r):t.push([r])}return t.map((e=>{if(Array.isArray(e))return e.map((e=>getExtensions(e).map((e=>`*${e}`)))).flat().join(" ");if("*/*"===e)return"All Files | *";{const t=getExtensions(e).map((e=>`*${e}`)).join(" ");return t?"video/*"===e?"Video Files | "+t:"audio/*"===e?"Audio Files | "+t:"image/*"===e?"Image Files | "+t:"text/*"===e?"Text Files | "+t:t:void 0}})).filter(Boolean)}function escape(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function htmlAcceptToAppleType(e){return e.split(/\s*,\s*/).map(getUTI).filter(Boolean).map((e=>`"${e}"`)).join(", ")}function createAppleScript$3(e,t="",r={}){const{type:n,forSave:o,defaultName:i}=r;if("file"===e){if(o)return dedent`
                tell application (path to frontmost application as text)
                    set myFile to choose file name${t?` with prompt "${escape(t)}"`:""}\
                        ${i?` default name "${escape(i)}"`:""}
                    POSIX path of myFile
                end
                `;{const e=n?htmlAcceptToAppleType(n):"";return dedent`
                tell application (path to frontmost application as text)
                    set myFile to choose file${t?` with prompt "${escape(t)}"`:""}\
                        ${e?` of type {${e}}`:""} invisibles false
                    POSIX path of myFile
                end
                `}}if("files"===e){const e=n?htmlAcceptToAppleType(n):"";return dedent`
            tell application (path to frontmost application as text)
                set myFiles to choose file${t?` with prompt "${escape(t)}"`:""}\
                    ${e?` of type {${e}}`:""} invisibles false\
                    multiple selections allowed true
                set theList to {}
                repeat with aItem in myFiles
                    set end of theList to POSIX path of aItem
                end repeat
                set my text item delimiters to "\\n"
                return theList as text
            end
            `}return dedent`
            tell application (path to frontmost application as text)
                set myFolder to choose folder${t?` with prompt "${escape(t)}"`:""}\
                    invisibles false
                POSIX path of myFolder
            end
            `}function htmlAcceptToFileFilter(e){const t=[];for(const r of e.split(/\s*,\s*/))if(r.endsWith("/*"))t.push(r);else{const e=t[t.length-1];e&&"string"!=typeof e?e.push(r):t.push([r])}return t.map((e=>{if(Array.isArray(e)){const t=e.map((e=>getExtensions(e).map((e=>`*${e}`)))).flat().join(";");return t+"|"+t}if("*/*"===e)return"All Files|*";{const t=getExtensions(e).map((e=>`*${e}`)).join(";");return t?"video/*"===e?"Video Files|"+t:"audio/*"===e?"Audio Files|"+t:"image/*"===e?"Image Files|"+t:"text/*"===e?"Text Files|"+t:t:void 0}})).filter(Boolean).join("|")}function createPowerShellScript$3(e,t="",r={}){const{type:n,forSave:o,defaultName:i}=r;if("file"===e){if(o){let e=n?htmlAcceptToFileFilter(n):"";if(!e&&i){const t=extname(i);t&&(e=htmlAcceptToFileFilter(t))}return dedent`
                Add-Type -AssemblyName System.Windows.Forms
                $saveFileDialog = [System.Windows.Forms.SaveFileDialog]::new()
                $saveFileDialog.Title = "${escape(t)}"
                $saveFileDialog.FileName = "${i?escape(i):""}"
                $saveFileDialog.Filter = "${e}"
                if ($saveFileDialog.ShowDialog() -eq 'OK') {
                    $saveFileDialog.FileName
                }
                `}{const e=n?htmlAcceptToFileFilter(n):"";return dedent`
                Add-Type -AssemblyName System.Windows.Forms
                $openFileDialog = [System.Windows.Forms.OpenFileDialog]::new()
                $openFileDialog.Title = "${escape(t)}"
                $openFileDialog.Filter = "${e}"
                $openFileDialog.Multiselect = $false
                $openFileDialog.ShowDialog() | Out-Null
                $openFileDialog.FileName
                `}}if("files"===e){const e=n?htmlAcceptToFileFilter(n):"";return dedent`
            Add-Type -AssemblyName System.Windows.Forms
            $openFileDialog = [System.Windows.Forms.OpenFileDialog]::new()
            $openFileDialog.Title = "${escape(t)}"
            $openFileDialog.Filter = "${e}"
            $openFileDialog.Multiselect = $true
            $openFileDialog.ShowDialog() | Out-Null
            $openFileDialog.FileNames -join "\n"
            `}return dedent`
            Add-Type -AssemblyName System.Windows.Forms
            $folderBrowserDialog = [System.Windows.Forms.FolderBrowserDialog]::new()
            $folderBrowserDialog.Description = "${escape(t)}"
            $folderBrowserDialog.ShowDialog() | Out-Null
            $folderBrowserDialog.SelectedPath
            `}function refinePath(e){return isWSL()?"/mnt/"+e.replace(/\\/g,"/").replace(/^([a-z]):/i,((e,t)=>t.toLowerCase())):e}function throwUnsupportedPlatformError(){throw new I("Unsupported platform")}async function pickFile(e={}){const t=platform();return"darwin"===t?await async function macPickFile(e="",t={}){const{code:r,stdout:n,stderr:o}=await run("osascript",["-e",createAppleScript$3("file",e,t)]);if(r){if(o.includes("User canceled"))return null;throw new Error(o.trim())}return n.trim()||null}(e.title,{type:e.type,forSave:null==e?void 0:e.forSave,defaultName:null==e?void 0:e.defaultName}):"windows"===t||isWSL()?await async function windowsPickFile(e="",t={}){const{code:r,stdout:n,stderr:o}=await powershell(createPowerShellScript$3("file",e,t));if(r)throw new Error(o);{const e=n.trim();return e?refinePath(e):null}}(e.title,{type:e.type,forSave:null==e?void 0:e.forSave,defaultName:null==e?void 0:e.defaultName}):"linux"===t||await which("zenity")?await async function linuxPickFile(e="",t={}){const{type:r,forSave:n,defaultName:o}=t,i=["--file-selection"];if(e&&i.push("--title",e),r&&htmlAcceptToFileFilters(r).forEach((e=>{i.push("--file-filter",e)})),n&&(i.push("--save","--confirm-overwrite"),o&&(i.push("--filename",o),!r))){const e=extname(o);e&&htmlAcceptToFileFilters(e).forEach((e=>{i.push("--file-filter",e)}))}const{code:s,stdout:a,stderr:l}=await run("zenity",i);if(s){if(1===s)return null;throw new Error(l.trim())}return a.trim()||null}(e.title,{type:e.type,forSave:null==e?void 0:e.forSave,defaultName:null==e?void 0:e.defaultName}):void throwUnsupportedPlatformError()}async function pickFiles(e={}){const t=platform();return"darwin"===t?await async function macPickFiles(e="",t=""){const{code:r,stdout:n,stderr:o}=await run("osascript",["-e",createAppleScript$3("files",e,{type:t})]);if(r){if(o.includes("User canceled"))return[];throw new Error(o.trim())}return n.trim()?lines(n.trim()):[]}(e.title,e.type):"windows"===t||isWSL()?await async function windowsPickFiles(e="",t=""){const{code:r,stdout:n,stderr:o}=await powershell(createPowerShellScript$3("files",e,{type:t}));if(r)throw new Error(o);return n.trim()?lines(n.trim()).map(refinePath):[]}(e.title,e.type):"linux"===t||await which("zenity")?await async function linuxPickFiles(e="",t=""){const r=["--file-selection","--multiple","--separator","\n"];e&&r.push("--title",e),t&&htmlAcceptToFileFilters(t).forEach((e=>{r.push("--file-filter",e)}));const{code:n,stdout:o,stderr:i}=await run("zenity",r);if(n){if(1===n)return[];throw new Error(i.trim())}return o.trim()?lines(o.trim()):[]}(e.title,e.type):void throwUnsupportedPlatformError()}async function pickDirectory(e={}){const t=platform();return"darwin"===t?await async function macPickFolder(e=""){const{code:t,stdout:r,stderr:n}=await run("osascript",["-e",createAppleScript$3("folder",e)]);if(t){if(n.includes("User canceled"))return null;throw new Error(n.trim())}return r.trim()||null}(e.title):"windows"===t||isWSL()?await async function windowsPickFolder(e=""){const{code:t,stdout:r,stderr:n}=await powershell(createPowerShellScript$3("folder",e));if(t)throw new Error(n);{const e=r.trim();return e?refinePath(e):null}}(e.title):"linux"===t||await which("zenity")?await async function linuxPickFolder(e=""){const t=["--file-selection","--directory"];e&&t.push("--title",e);const{code:r,stdout:n,stderr:o}=await run("zenity",t);if(r){if(1===r)return null;throw new Error(o.trim())}return n.trim()||null}(e.title):void throwUnsupportedPlatformError()}var Yr=Object.freeze({__proto__:null,downloadFile:async function downloadFile(e,t={}){var r;const n="object"==typeof e?e.href:e,o=t.name||basename(n),i=await pickFile({title:t.title,type:t.type,forSave:!0,defaultName:o});if(!i)return;const s=asyncTask();let a,l,c=null!==(r=t.signal)&&void 0!==r?r:null;if(t.showProgress){const e=new AbortController;c=e.signal,a=progress("Downloading...",(async e=>(l=e,await s)),(()=>{throw e.abort(),new L("Download canceled",{name:"AbortError"})}))}else a=s;const u=await fetch(n,{signal:c});if(!u.ok)throw new Error(`Failed to download: ${n}`);const d=parseInt(u.headers.get("Content-Length")||"0",10);let f=u.body;if(t.onProgress||t.showProgress){const{onProgress:e}=t;let r=0;const n=new TransformStream({transform(t,n){if(n.enqueue(t),r+=t.byteLength,e)try{null==e||e(createProgressEvent("progress",{lengthComputable:!!d,loaded:r,total:null!=d?d:0}))}catch(e){}l&&d&&l({percent:r/d})}});f=f.pipeThrough(n)}writeFile(i,f,{signal:c}).then((()=>{s.resolve()})).catch((e=>{s.reject(e)})),await a},openDirectory:async function openDirectory(e={}){const t=await pickDirectory(e);if(t){const e=[];for await(const r of readDir(t,{recursive:!0}))if("file"===r.kind){const n=join(t,r.relativePath),o=await readFileAsFile(n);Object.defineProperty(o,"webkitRelativePath",{configurable:!0,enumerable:!0,writable:!1,value:r.relativePath.replace(/\\/g,"/")}),e.push(fixFileType(o))}return e}return[]},openFile:async function openFile(e){let t=await pickFile(e);return t?await readFileAsFile(t):null},openFiles:async function openFiles(e={}){const t=await pickFiles(e);return await Promise.all(t.map((e=>readFileAsFile(e))))},pickDirectory:pickDirectory,pickFile:pickFile,pickFiles:pickFiles,saveFile:async function saveFile(e,t={}){var r;const{title:n}=t;let o;o="function"==typeof Blob&&e instanceof Blob?await pickFile({title:n,type:t.type||e.type,forSave:!0,defaultName:t.name||(null===(r=as$1(e,File))||void 0===r?void 0:r.name)}):await pickFile({title:n,type:t.type,forSave:!0,defaultName:t.name}),o&&await writeFile(o,e,pick(t,["signal"]))}});const{BS:Xr,CTRL_A:Zr,CTRL_C:en,CTRL_E:tn,CR:rn,DEL:nn,ESC:on,LF:sn}=it,{UP:an,DOWN:ln,LEFT:cn,RIGHT:un}=st,{CLR_RIGHT:dn}=lt;function getMasks(e,t){return new Array(t).fill(e).join("")}async function question(e,t={}){const{defaultValue:r="",mask:n}=t,o=[];let i=0;if(await writeStdout(bytes(e)),r){const e=chars(r);o.push(...e),i+=e.length,void 0===n?await writeStdout(bytes(r)):n&&await writeStdout(bytes(getMasks(n,e.length)))}for(;;){const e=await readStdin();if(e.length&&!equals$3(e,an)&&!equals$3(e,ln))if(equals$3(e,cn)){if(i>0){const e=o[--i];void 0===n?await moveLeftBy(e):n&&await moveLeftBy(n)}}else if(equals$3(e,un)){if(i<o.length){const e=o[i++];void 0===n?await moveRightBy(e):n&&await moveRightBy(n)}}else if(equals$3(e,Zr)){const e=o.slice(0,i);e.length&&(i=0,void 0===n?await moveLeftBy(e.join("")):n&&await moveLeftBy(getMasks(n,e.length)))}else if(equals$3(e,tn)){const e=o.slice(i);e.length&&(i=o.length,void 0===n?await moveRightBy(e.join("")):n&&await moveRightBy(getMasks(n,e.length)))}else{if(equals$3(e,on)||equals$3(e,en))return await writeStdout(sn),null;if(equals$3(e,rn)||equals$3(e,sn))return await writeStdout(sn),o.join("");if(equals$3(e,Xr)||equals$3(e,nn)){if(i>0){i--;const[e]=o.splice(i,1),t=o.slice(i);if(void 0===n){if(await moveLeftBy(e),await writeStdout(dn),t.length){const e=t.join("");await writeStdout(bytes(e)),await moveLeftBy(e)}}else if(n&&(await moveLeftBy(n),await writeStdout(dn),t.length)){const e=getMasks(n,t.length);await writeStdout(bytes(e)),await moveLeftBy(e)}}}else if(isTypingInput(e)){const t=chars(String(e));if(i===o.length)o.push(...t),i+=t.length,void 0===n?await writeStdout(e):n&&await writeStdout(bytes(getMasks(n,t.length)));else if(o.splice(i,0,...t),i+=t.length,void 0===n){const t=o.slice(i).join("");await writeStdout(concat$2(e,bytes(t))),await moveLeftBy(t)}else if(n){const e=getMasks(n,t.length),r=getMasks(n,o.slice(i).length);await writeStdout(bytes(e+r)),await moveLeftBy(r)}}}}}function createAppleScript$2(e){return dedent`
        tell application (path to frontmost application as text)
            display dialog "${escape(e)}" with title "Alert" buttons {"OK"} default button "OK"
        end
        `}var fn=Object.freeze({__proto__:null,default:async function alert(e,t={}){if((null==t?void 0:t.gui)&&"darwin"===platform()){const{code:t,stderr:r}=await run("osascript",["-e",createAppleScript$2(e)]);if(t)throw new Error(r)}else if((null==t?void 0:t.gui)&&("windows"===platform()||isWSL())){const{code:t,stderr:r}=await powershell(function createPowerShellScript$2(e){return dedent`
        Add-Type -AssemblyName PresentationFramework
        [System.Windows.MessageBox]::Show("${escape(e)}", "Alert")
        `}(e));if(t)throw new Error(r)}else if((null==t?void 0:t.gui)&&("linux"===platform()||await which("zenity"))){const t=["--info","--title","Alert","--width","365"];e&&t.push("--text",e);const{code:r,stderr:n}=await run("zenity",t);if(r&&1!==r)throw new Error(n)}else await lockStdin((()=>question(e+" [Enter] ")))}});function createAppleScript$1(e){return dedent`
        tell application (path to frontmost application as text)
            display dialog "${escape(e)}" with title "Confirm"\
                buttons {"Cancel", "OK"} default button "OK"
        end
        `}var pn=Object.freeze({__proto__:null,default:async function confirm(e,t={}){if((null==t?void 0:t.gui)&&"darwin"===platform()){const{code:t,stderr:r}=await run("osascript",["-e",createAppleScript$1(e)]);if(t){if(r.includes("User canceled"))return!1;throw new Error(r)}return!0}if((null==t?void 0:t.gui)&&("windows"===platform()||isWSL())){const{code:t,stdout:r,stderr:n}=await powershell(function createPowerShellScript$1(e){return dedent`
        Add-Type -AssemblyName PresentationFramework
        [System.Windows.MessageBox]::Show("${escape(e)}", "Confirm", "YesNo")
        `}(e));if(t)throw new Error(n);return"Yes"===r.trim()}if((null==t?void 0:t.gui)&&("linux"===platform()||await which("zenity"))){const t=["--question","--title","Confirm","--width","365"];e&&t.push("--text",e);const{code:r,stderr:n}=await run("zenity",t);if(r){if(1===r)return!1;throw new Error(n)}return!0}{const t=await lockStdin((()=>question(e+" [Y/n] "))),r=null==t?void 0:t.toLowerCase().trim();return""===r||"y"===r||"yes"===r}}});function createAppleScript(e,t="",r=!1){return dedent`
        tell application (path to frontmost application as text)
            set response to display dialog "${escape(e)}" with title "Prompt"\
                default answer "${escape(t)}"${r?" hidden answer true":""}
            return text returned of response
        end
        `}var hn=Object.freeze({__proto__:null,default:async function prompt(e,t={}){if((null==t?void 0:t.gui)&&"darwin"===platform()){const{code:r,stdout:n,stderr:o}=await run("osascript",["-e",createAppleScript(e,t.defaultValue,"password"===t.type)]);if(r){if(o.includes("User canceled"))return null;throw new Error(o)}return n.trim()}if((null==t?void 0:t.gui)&&("windows"===platform()||isWSL())){const{code:r,stdout:n,stderr:o}=await powershell(function createPowerShellScript(e,t="",r=!1){return dedent`
        Add-Type -AssemblyName System.Windows.Forms
        $form = New-Object System.Windows.Forms.Form
        $form.Text = 'Prompt'
        $form.Size = New-Object System.Drawing.Size(450,175)
        $form.StartPosition = 'CenterScreen'
        $form.FormBorderStyle = 'FixedDialog'
        $form.Font = New-Object System.Drawing.Font('Aria', 10)
        $form.AutoScaleMode = 'Dpi'
        $form.MaximizeBox = $false
        $form.MinimizeBox = $false
        
        $label = New-Object System.Windows.Forms.Label
        $label.Location = New-Object System.Drawing.Point(17,20)
        $label.Size = New-Object System.Drawing.Size(400,30)
        $label.Text = "${escape(e)}"
        $form.Controls.Add($label)
        
        $textBox = New-Object System.Windows.Forms.TextBox
        $textBox.Location = New-Object System.Drawing.Point(17,50)
        $textBox.Size = New-Object System.Drawing.Size(400,30)
        $textBox.UseSystemPasswordChar = ${r?"$true":"$false"}
        $textBox.Text = "${escape(t)}"
        $form.Controls.Add($textBox)
        
        $cancelButton = New-Object System.Windows.Forms.Button
        $cancelButton.Location = New-Object System.Drawing.Point(232,90)
        $cancelButton.Size = New-Object System.Drawing.Size(87,27)
        $cancelButton.Text = 'Cancel'
        $cancelButton.DialogResult = [System.Windows.Forms.DialogResult]::Cancel
        $cancelButton.FlatStyle = 'System'
        $form.Controls.Add($cancelButton)
        
        $okButton = New-Object System.Windows.Forms.Button
        $okButton.Location = New-Object System.Drawing.Point(330,90)
        $okButton.Size = New-Object System.Drawing.Size(87,27)
        $okButton.Text = 'OK'
        $okButton.DialogResult = [System.Windows.Forms.DialogResult]::OK
        $okButton.FlatStyle = 'System'
        $form.Controls.Add($okButton)
        
        $form.AcceptButton = $okButton
        $form.CancelButton = $cancelButton
        $form.Add_Shown({$textBox.Select()})
        
        $result = $form.ShowDialog()
        
        if ($result -eq [System.Windows.Forms.DialogResult]::OK)
        {
            $textBox.Text
        }
        elseif ($result -eq [System.Windows.Forms.DialogResult]::Cancel)
        {
            throw 'User canceled'
        }
        `}(e,t.defaultValue,"password"===t.type));if(r){if(o.includes("User canceled"))return null;throw new Error(o)}return n.trim()}if((null==t?void 0:t.gui)&&("linux"===platform()||await which("zenity"))){const r=["--entry","--title","Prompt","--width","450"];e&&r.push("--text",e),t.defaultValue&&r.push("--entry-text",t.defaultValue),"password"===t.type&&r.push("--hide-text");const{code:n,stdout:o,stderr:i}=await run("zenity",r);if(n){if(1===n)return null;throw new Error(i)}return o.trim()}return await lockStdin((()=>question(e+" ",t)))}});return Tr}));
//# sourceMappingURL=jsext.js.map
